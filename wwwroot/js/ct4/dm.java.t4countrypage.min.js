function getNoOfPacksFeaturedItin(n){const t=`${SiteName}/Api/GetNoOfPacksFeaturedItin/${parseInt(n)}`;fetch(t,{method:"GET",headers:{contentType:"application/json;charset=utf-8"}}).then(n=>n.ok?n.json():n.text().then(n=>{throw new Error(n);})).then(n=>{if(n[0]!=0){const t=document.querySelectorAll(".btnHide");t.forEach(n=>{n.classList.remove("btnHide")});document.querySelector(".noPacks").innerHTML=n[0].noOfPacks}}).catch(n=>{console.error("Error fetching data of getNoOfPacksFeaturedItin :",n.message)})}function onClickFAQInfo(n){const i=n.id.replace("faq","faqInfo"),t=$("#"+i);t.is(":visible")==!1?(t.show(300),$("#"+n.id).addClass("active")):(t.hide(300),$("#"+n.id).removeClass("active"))}function winlocation(n){window.location=n}function toggleClassMoreDetails(n){$("body").toggleClass("modal-pack-info-open");$("#fti-"+n+"-modal").toggleClass("is-hidden")}function otherMoreDetails(n,t){switch(t){case 2:goTo=-1}if(goTo==-1)return!1;$(".secPackInfo").each(function(){var i=$(this).attr("id"),t=i.match(isNumber);t==n?$(this).is(":visible")?($(this).slideUp(),$('p[id="down'+t+'"]').slideUp(),$('p[id="p'+t+'"]').find("span").css({transform:"rotate(45deg)",margin:"5px 10px"})):($(this).slideDown(),$('p[id="down'+t+'"]').slideDown(),$('p[id="p'+t+'"]').find("span").css({transform:"rotate(-135deg)",margin:"7px 10px"})):($(this).slideUp(),$('p[id="down'+t+'"]').slideUp(),$('p[id="p'+t+'"]').find("span").css({transform:"rotate(45deg)",margin:"5px 10px"}))});t===1?relPackCallt4(n):""}function relPackCallt4(n){var t="",r="",u="dvCom"+n,f="dvpkInf"+n,e="dvRel"+n;$.ajax({type:"GET",url:SiteName+"/Api/Packages/getDataRelPacks/"+n,contentType:"application/json; charset=utf-8",dataType:"text",success:function(o){if(msg=o,msg!=""){for(t='<div class="txt_grayLight11" style="padding:5px 3px;">Related Package<\/div><div style="padding:2px 2px;" align="left">',r='<div class="txt_11" style="padding:3px 3px 5px 3px;"><b>For more choices, combine cities found in this itinerary:<\/b><\/div><div style="padding:2px 2px;" align="left">',strPrts=msg.split("@"),i=0;i<=strPrts.length-1;i++)echP=strPrts[i].split("|"),t=t+'<span style="float:left; margin-right:5px; margin-bottom:3px;">',t=t+'<a href="'+SiteName+"/"+echP[0].replace(/\s/g,"_").toLowerCase()+'/vacations" style="margin-right:10px">',t=t+'<span class="txt_grayLight11">',t=t+"<u>"+echP[0]+"<\/u>",t=t+"<\/span><\/a><\/span>",echP[2]!=5&&(r=r+'<span style="float:left; margin-right:5px; margin-bottom:3px;"><a style="cursor:pointer;" class="falsecheckdop" id="falsedop'+echP[3]+'" >'+echP[0]+"<\/a>",r=r+'<input type="checkbox" name="dop'+echP[3]+'" id="dop'+echP[3]+'" style="display:none" value="'+echP[3]+"|"+echP[0]+'"/>',r=r+"<\/span>");t=t+'<br style="clear:both"/><\/div>';r=r+'<br style="clear:both"/><\/div>';$("#"+e+"").html(t);$("#"+u+"").html(r);$("#dvWait"+n+"").hide();$("#dvWait"+n+"").html("");$("#"+f+"").slideDown();activeCckBx("frm"+n)}},error:function(t){alert(t.responseText+" = error");$("#dvWait"+n+"").html(t.responseText)}})}function activeCckBx(n){$("#"+n+" input:checkbox").each(function(){this.checked?$("#false"+this.id+"").addClass("falsecheckeddop"):$("#false"+this.id+"").removeClass("falsecheckeddop")});var t;$("#"+n+" .falsecheckdop").click(function(){return this.id.indexOf("falsedot")>-1?t=this.id.replace("falsedot",""):this.id.indexOf("false")>-1?t=this.id.replace("false",""):"",$(this).hasClass("falsecheckeddop")?($(this).removeClass("falsecheckeddop"),$("#"+t+"").removeAttr("checked")):($(this).addClass("falsecheckeddop"),$("#"+t+"").attr("checked",!0)),$(this.hash).trigger("click"),!1})}function changePic(n,t,i,r){let u="https://pictures.tripmasters.com"+r.toLowerCase();r==="none"&&(u=t);$(".img-modal__list li img").removeClass();$("#"+n).addClass("selected");currentPic=n;$("#dvFstPic").html(`<img src="${u}" id="${n.replace("O","B")}" alt="${r}" title=${i}" />`);$("#dvPicNa").html(i);const f=$('.img-modal__list img[id*="picture"]');for(let t=0;t<f.length;t++)if(f[t].id===n){$("#totalCurrent").html(`${t+1}`);break}}function nextPicture(){const n=$('.img-modal__list img[id*="picture"]');for(let t=0;t<n.length;t++)if(n[t].id===currentPic){const i=t+1<n.length?t+1:0;changePic(n[i].id,n[i].src,n[i].title,n[i].alt);break}}function prevPicture(){const n=$('.img-modal__list img[id*="picture"]');for(let t=0;t<n.length;t++)if(n[t].id===currentPic){const i=t-1<0?n.length-1:t-1;changePic(n[i].id,n[i].src,n[i].title,n[i].alt);break}}function popUpImagesNav(){thumPic="";thumMap="";hvMap=0;var n=0,r=0,t="picNSel";for(i=0;i<Number(picTotal);i++)t=i==0?"picSel":"picNSel",objPics[i].imG_ImageType=="P0"?(n++,thumPic=thumPic+'<img id="Kipic'+n+'" class="'+t+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/>'):(objPics[i].imG_ImageType=="M0"||objPics[i].imG_ImageType=="M1")&&(r++,thumMap=thumMap+'<img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="Mipic'+r+'" class="'+t+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL+'" title="'+objPics[i].imG_Title+'"/>',hvMap=1);newPicTot=n;$("#dvThuPic").html("Photos<br/>"+thumPic);hvMap==1?($("#dvThMp").show(),$("#dvThuMap").html("Map<br/>"+thumMap)):($("#dvThMp").hide(),$("#dvTabMap").hide());$("img.picSel").click(function(){changePic(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){changePic(this.id,this.src,this.title,this.alt)})}function moreMediaClose(){$("#dvmediaPopUp").addClass("is-hidden");$("body").removeClass("modal-open")}function buildPics(){$("#dvmediaPopUp").removeClass("is-hidden");$("body").addClass("modal-open");$.ajax({type:"GET",url:SiteName+"/Api/Packages/PicsForPacks/"+bestPackID,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){const t=n,f=t.length;let i="",r=0;for(let n=0;n<f;n++)t[n].imG_ImageType==="P0"?(r++,i=i+`<li>
                                 <img id="picture-${r}" src="https://pictures.tripmasters.com${t[n].imG_Path_URL.toLowerCase()}" alt="${t[n].imG_500Path_URL}" title="${t[n].imG_Title}" onerror="this.src = 'https://pictures.tripmasters.com/siteassets/d/no-image.jpg'"/>
                               </li>`):(t[n].imG_ImageType==="M0"||t[n].imG_ImageType==="M1")&&(r++,i=`<li>
                        <img id="picture-${r}" src="https://pictures.tripmasters.com${t[n].imG_Path_URL.toLowerCase()}" alt="${t[n].imG_500Path_URL}" title="${t[n].imG_Title}" onerror="this.src = 'https://pictures.tripmasters.com/siteassets/d/no-image.jpg'"/>
                      </li>`+i);$("#dvThuPic").html(i);$("#total").html(`/${f}`);$(".img-modal__list li img").click(function(){changePic(this.id,this.src,this.title,this.alt)});const u=document.querySelector(".img-modal__list li img");changePic(u.id,u.src,u.title,u.alt)},error:function(n){console.error(n.responseText)}})}function openWinCMS(n,t){return centerWindow(t),!1}function findPackst4(n){var h,t,o,s,r,c,u,f,e;for($("#"+n+" #allID").val()!=""&&$("#"+n+" #allID").val(""),$("#"+n+" #allNA").val()!=""&&$("#"+n+" #allNA").val(""),h=n,t=$("#"+h+"").serialize(),t=t.substring(0,t.indexOf("&__RequestVerificationToken")),c="",e=0,t=t.replace(/\+/g," "),t=t.replace(/\%7C/g,"|"),o=t.split("&"),i=0;i<o.length;i++)s=o[i].split("="),s[1]!=""&&(e=e+1,r=s[1].split("|"),e>1?(u=u+","+r[0],f=f+"_-_"+r[1].replace(/\s/g,"-")):(u=r[0],f=r[1].replace(/\s/g,"-")));if(u==undefined){alert("Please check at least one box. Thanks!");return}$("#allID").val(u);$("#allNA").val(f);window.location.href=SiteName+"/"+f.toLowerCase()+"/find-packages"}function getPlacesOnCountry(n){$("#cities_modal").removeClass("is-hidden");$("body").addClass("modal-open");var t={};t.url=SiteName+"/Api/CountryPlaces";t.type="POST";t.contentType="application/json";t.data=JSON.stringify(n);t.dataType="json";t.success=function(n){let t="";n.map(function(n){t+=`<li>
                          <a href="/europe/${n.CityName.replaceAll(" ","_").toLowerCase()}/vacations">${n.CityName}</a>
                      </li>`});$(".cities__modal-list").html(t)};t.error=function(n){alert(n.responseText)};$.ajax(t)}function closeAllCities(){$("#cities_modal").addClass("is-hidden");$("body").removeClass("modal-open")}async function getTop1Feedback(n){const t=`${SiteName}/Api/Packages/Top1FeedbackByPackId/${n}`;try{const n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8"}});if(n.status===204)return;if(!n.ok){const t=await n.text();throw new Error(t);}const i=await n.json();if(!i)return;const r=renderFeedback(i);$("#bestPackagesTopFeedback").html(r);$(".best-packages__reviews").show()}catch(i){console.error("API Top1FeedbackByPackId: Request failed",i.message)}}async function getTop3Feedbacks(n){const t=`${SiteName}/Api/Top3FeedbackByCounId/${n}`;try{const n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8"}});if(n.status===204)return;if(!n.ok){const t=await n.text();throw new Error(t);}const i=await n.json();if(!i)return;let r="";i.forEach(function(n){r+=`<li class="customer-reviews__item">${renderFeedback(n)}</li>`});$("#dReview").html(r)}catch(i){console.error("API Top1FeedbackByPackId: Request failed",i.message)}}function renderFeedback(n){const t=new Date(n.dep_date).toLocaleDateString("en-US");return`
	    <div>
            <div class="customer-reviews__wrapper">
                <span class="customer-reviews__stars" style="--rating: ${n.pcc_overallscore}"></span>
                <div class="customer-reviews__score">${n.pcc_overallscore} out of 5</div>
            </div>
            <p class="customer-reviews__text">${n.pcC_Comment}</p>
	    </div>
        <span class="customer-reviews__date">Traveled on: ${t}</span>   
    `}var pics="",aPic="",thumPic="",OthumPic="",TthumPic="",thumMap="",OthumMap="",picSize=200,shwMaps="",maskH,maskW,isNumber=/[0-9]+/g,placeID,placeNA,citiesAll=[],goTo;let currentPic=0,arrCities=[];$(document).ready(function(){maskH=$(document).height();maskW=$(window).width();placeID=$("#placeID").val();placeNA=$("#placeNA").val();bestPackID=$("#imgItemID").val();getTop1Feedback(bestPackID);$(".browseButton, .buildButton, .eachHigh, .dvCustomIt, .dvSuggCustomIt").click(function(){winlocation(this.getAttribute("data-go-to"))});$('button[id*="faq-"]').click(function(){onClickFAQInfo(this)});$("#moreButtonT4").click(function(){$("#toHide").is(":visible")===!1?($("#toHide").slideDown(),$("#toHide").removeClass("toHide"),$("#toHide").attr("style","display: flex"),$("#moreButtonT4").html("Show Less")):($("#toHide").slideUp(),$("#toHide").addClass("toHide"),$("#moreButtonT4").html("Show More"))});$(".dveachOtherMore").click(function(){var n=this.getAttribute("data-id");otherMoreDetails(n,1)});$(".dvotherClose span").click(function(){var n=this.id;otherMoreDetails(n,0)});$(".img-modal__close, .img-modal__title").click(moreMediaClose);$("#seeAllImg").click(function(){buildPics()});$("#imgForw").click(nextPicture);$("#imgBack").click(prevPicture);$("#seeAllCities").click(function(){getPlacesOnCountry(placeID)});$(".modal__close").click(closeAllCities);const n=document.querySelector(".suggested__buttons"),t=new IntersectionObserver((n,t)=>{n.forEach(n=>{n.isIntersecting&&(getNoOfPacksFeaturedItin(placeID),t.unobserve(n.target))})},{root:null,rootMargin:"0px",threshold:.1});t.observe(n)});goTo=0,function(){document.addEventListener("DOMContentLoaded",function(){function t(t,i){t.forEach(t=>{t.isIntersecting&&!n&&(n=!0,getTop3Feedbacks(placeID),i.unobserve(t.target))})}let n=!1;const i=new IntersectionObserver(t,{root:null,threshold:.1}),r=document.querySelector("#customerReviews");i.observe(r)})}();