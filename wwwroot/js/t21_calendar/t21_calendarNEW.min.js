function updateFlight(n){const t=n.value;t==="False"?($("#AirParam").slideUp(),$("#dateLabel").text("Check-in Date on your first city"),$("#dateWrapper").removeClass("active"),$("#addFlight").val("False")):t==="True"&&($("#AirParam").slideDown(),$("#dateLabel").text("Arrival date on your first city"),$("#dateWrapper").addClass("active"),$("#addFlight").val("True"),getHomeTownAirport())}function readCookVal(){var s,h,l,a,v,y,n,f,e,t,p,o,u,w;if(backNull=getItemF("localStorageTMEDT21"),backNull!=null)if(backCook=JSON.parse(getItemF("localStorageTMEDT21")),backCook.Pkgid!=packagesID)removeItemF("localStorageTMEDT21");else{if(s=backCook.addFlight,s==="True"&&($("#updateFlightToTrue").prop("checked",!0),$("#AirParam").slideDown(),$("#dateLabel").text("Arrival date on your first city"),$("#dateWrapper").addClass("active"),$("#addFlight").val("True")),h=backCook.Cabin,$('#Cabin option[value="'+h+'"]').attr("selected","selected"),l=Number(backCook.hwMnyCtyfrm)+1,a=backCook.InDate1,$("#InDate1").val(a),v=backCook.sDepCity,$("#sDepCity").attr("value",v),y=backCook.iDepCity,$("#iDepCity").val(y),n=backCook.Rooms,$("#Rooms").val(n),$("#iRoom").val(n),rom=n,f=backCook.iRoomsAndPax,$('#iRoomsAndPax option[value="'+f+'"]').attr("selected","selected"),f.indexOf("Other")>-1&&showDivRoom(n),e=backCook.iAdults,$("#iAdults").val(e),$('#AiAdults option[value="'+e+'"]').attr("selected","selected"),t=backCook.iChildren,$("#iChildren option[value='"+t+"']").attr("selected","selected"),t>0)for(c=1;c<=t;c++)$("#dvR1child"+c+"").show(),p=backCook["iChild"+c],$("#iChild"+c+"").val(p);if(n>1)for(r=2;r<=n;r++)if(o=backCook["Room"+r+"_iAdults"],$("#Room"+r+"_iAdults").val(o),$("#ARoom"+r+'_iAdults option[value="'+o+'"]').attr("selected","selected"),u=backCook["Room"+r+"_iChildren"],$("#Room"+r+"_iChildren option[value='"+u+"']").attr("selected","selected"),u>0)for(c=1;c<=u;c++)$("#dvR"+r+"child"+c+"").show(),w=backCook["Room"+r+"iChild"+c],$("#Room"+r+"_iChild"+c+"").val(w);for(i=1;i<=l;i++)NtsStay=backCook["StayNite"+i],$("#StayNite"+i+" option[value='"+NtsStay+"']").attr("selected","selected");removeItemF("localStorageTMEDT21")}}function newDest(){$.ajax({type:"Get",url:SiteName+"/Api/Packages/depCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){citiesAll=n;doit()}});$("#sDepCity").click(function(){$("#sDepCity").select()})}function doit(){$("#sDepCity").autocomplete({autoFocus:!0,minLength:3,select:function(n,t){return $("#sDepCity").select().removeClass("calendar-error"),$("#sDepCity").val(t.item.label),$("#iDepCity").val(t.item.id),!1},open:function(){$(".ui-autocomplete").css("width","300px")},response:function(n,t){if(t.content.length===0)return alert("No valid airport found"),!1},source:$.map(citiesAll,function(n){return{value:n.plC_Title+" - "+n.plC_Code,label:n.plC_Title+" - "+n.plC_Code,id:n.plcid}})}).click(function(){$("#sDepCity").select().removeClass("calendar-error");$("#iDepCity").val("-1")}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").attr("data-value",t.value).append(i).appendTo(n)}}function stayChange(n,t){$("#"+n+"").val(t)}function selCabin(){$("#BCabin").val($("#Cabin").val())}function bbdates(n){builFixDatediv(fixDatesdiv,n);objPOS=$("#"+n+"").offset();$("#dvFixDates").show();$("#dvFixDates").offset({left:objPOS.left-0,top:objPOS.top+20})}function builFixDatediv(n,t){var f,e,s="",r="",u=n.split(","),o;for(i=0;i<u.length;i++)s!=dateFormat(u[i],"mmm")&&(s=dateFormat(u[i],"mmm"),o=0,r=i==0?'<div style="padding:3px 1px;">':r+'<\/div><div style="padding:3px 1px;">',r=r+" "+s+" "+dateFormat(u[i],"yyyy")+": "),o==0?(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+'<span id="fxDates" onclick="changeDaysLenght1('+f+","+e+')">'+dateFormat(u[i],"dd")+"<\/span>"):(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+', <span id="fxDates" onclick="changeDaysLenght1('+f+","+e+')">'+dateFormat(u[i],"dd")+"<\/span>"),o=o+1;r=r+"<\/div>";$("#dvFixDates").html(r);setTimeout(function(){$("#dvFixDates").hide()},7e3)}function changeDaysLenght1(n){$("#InDate1").val(n)}function chkValid(n,t){var i=$("#"+n+"").offset();$("#divError").html(t);$("#divError").show();t.indexOf("All infants")!=-1?$("#divError").offset({left:i.left-160,top:i.top-50}):$("#divError").offset({left:i.left-25,top:i.top-50});$("#"+n+"").val("");$("#"+n+"").focus();$("#"+n+"").select();setTimeout("$('#divError').hide()",2e3)}function xSelChildren(n,t,i,r){r.indexOf("B")>-1?$("#"+r.replace("B","")+"").val(n):$("#B"+r+"").val(n);rom>1&&(hwMCh=Number($("#AiChildren").val())+Number($("#ARoom2_iChildren").val())+Number($("#ARoom3_iChildren").val()));i==0?($("#spChAg").hide(),$("#BspChAg").hide()):i==1&&(n==0?hwMCh==0&&($("#spChAg").hide(),$("#BspChAg").hide()):($("#spChAg").show(),$("#BspChAg").show()));switch(t){case 1:for(s=1;s<=4;s++)s<n||s==n?($("#dvR1child"+s+"").show(),$("#BdvR1child"+s+"").show()):($("#dvR1child"+s+"").hide(),$("#BdvR1child"+s+"").hide(),$("#dvR1child"+s+"").val(""),$("#BdvR1child"+s+"").val("")),$("#iChild"+s+"").val(""),$("#BiChild"+s+"").val("");break;case 2:case 3:for(s=1;s<=4;s++)s<n||s==n?($("#dvR"+t+"child"+s+"").show(),$("#BdvR"+t+"child"+s+"").show()):($("#dvR"+t+"child"+s+"").hide(),$("#BdvR"+t+"child"+s+"").hide()),$("#Room"+t+"_iChild"+s+"").val(""),$("#BRoom"+t+"_iChild"+s+"").val("")}}function showDivRoom(n){for(n==0&&($("#dvPaxLabel").hide(),$("#BdvPaxLabel").hide()),i=1;i<=3;i++)i<=n?($("#dvPaxLabel").show(),$("#BdvPaxLabel").show(),$("#dvRoom"+i+"").show(),$("#BdvRoom"+i+"").show()):($("#dvRoom"+i+"").hide(),$("#BdvRoom"+i+"").hide())}function cleanValues(n){$("#spChAg").hide();$("#BspChAg").hide();var t=[];switch(n){case 0:t=[1,2,3];t.forEach(function(n){for(s=1;s<=4;s++)$("#dvR"+n+"child"+s+"").hide(),$("#BdvR"+n+"child"+s+"").hide(),$("#Room"+n+"_iChild"+s+"").val(""),$("#BRoom"+n+"_iChild"+s+"").val(""),$("#AiAdults option").removeAttr("selected"),$("#iChildren option").removeAttr("selected")});break;case 1:t=[2,3];t.forEach(function(n){for(s=1;s<=4;s++)$("#dvR"+n+"child"+s+"").hide(),$("#BdvR"+n+"child"+s+"").hide(),$("#Room"+n+"_iChild"+s+"").val(""),$("#BRoom"+n+"_iChild"+s+"").val("")});break;case 2:t=[1,3];t.forEach(function(n){for(s=1;s<=4;s++)$("#dvR"+n+"child"+s+"").hide(),$("#BdvR"+n+"child"+s+"").hide(),$("#Room"+n+"_iChild"+s+"").val(""),$("#BRoom"+n+"_iChild"+s+"").val("")});break;case 3:t=[1,2];t.forEach(function(n){for(s=1;s<=4;s++)$("#dvR"+n+"child"+s+"").hide(),$("#BdvR"+n+"child"+s+"").hide(),$("#Room"+n+"_iChild"+s+"").val(""),$("#BRoom"+n+"_iChild"+s+"").val("")})}$("select[id='iChild1']").val("");$("select[id='iChild2']").val("");$("select[id='iChild3']").val("");$("select[id='iChild4']").val("")}function changePaxByRoom(n,t){if(n==-1){var i="'"+t+"'";return messg="<ol><li>Please select a valid option!<\/li><\/ol><span><\/span>",popError(t,messg),$("#"+t+"").select(),!1}t.indexOf("B")>-1?$('#iRoomsAndPax option[value="'+n+'"]').attr("selected","selected"):$('#BiRoomsAndPax option[value="'+n+'"]').attr("selected","selected");pax="";pax2="";pax3="";ropx=n.split("|");rom=ropx[0];pax=ropx[1];pax.indexOf("-")>0&&(paxMr=pax.split("-"),pax=paxMr[0],pax2=paxMr[1],paxMr[2]!=undefined&&(pax3=paxMr[2]));switch(rom){case"1":$("#iChildren option[value=0]").attr("selected","selected");$("#BiChildren option[value=0]").attr("selected","selected");pax!="Other"?(showDivRoom(0),cleanValues(0),$("#AiAdults option[value='"+pax+"']").attr("selected","selected"),$("#ARoom2_iAdults option").removeAttr("selected"),$("#ARoom3_iAdults option").removeAttr("selected"),$("#ARoom2_iAdults option[value='0']").attr("selected","selected"),$("#ARoom3_iAdults option[value='0']").attr("selected","selected"),$("#BiAdults option[value='"+pax+"']").attr("selected","selected"),$("#BRoom2_iAdults option[value='0']").attr("selected","selected"),$("#BRoom3_iAdults option[value='0']").attr("selected","selected")):(showDivRoom(1),cleanValues(0),$("#AiAdults option[value=2]").attr("selected","selected"),$("#BiAdults option[value=2]").attr("selected","selected"),$("#ARoom2_iAdults option").removeAttr("selected"),$("#ARoom3_iAdults option").removeAttr("selected"),$("#ARoom2_iAdults option[value='0']").attr("selected","selected"),$("#ARoom3_iAdults option[value='0']").attr("selected","selected"));break;case"2":$("#iChildren option[value=0]").attr("selected","selected");$("#Room2_iChildren option[value=0]").attr("selected","selected");$("#BiChildren option[value=0]").attr("selected","selected");$("#BRoom2_iChildren option[value=0]").attr("selected","selected");pax!="Other"?(showDivRoom(0),cleanValues(0),$("#AiAdults option[value='"+pax+"']").attr("selected","selected"),$("#ARoom2_iAdults option[value='"+pax2+"']").attr("selected","selected"),$("#ARoom3_iAdults option").removeAttr("selected"),$("#ARoom3_iAdults option[value='0']").attr("selected","selected"),$("#BiAdults option[value='"+pax+"']").attr("selected","selected"),$("#BRoom2_iAdults option[value='"+pax2+"']").attr("selected","selected"),$("#BRoom3_iAdults option[value='0']").attr("selected","selected")):(showDivRoom(2),cleanValues(0),$("#AiAdults option[value=2]").attr("selected","selected"),$("#ARoom2_iAdults option[value=2]").attr("selected","selected"),$("#BiAdults option[value=2]").attr("selected","selected"),$("#BRoom2_iAdults option[value=2]").attr("selected","selected"),$("#ARoom3_iAdults option").removeAttr("selected"),$("#ARoom3_iAdults option[value='0']").attr("selected","selected"));break;case"3":$("#iChildren option[value=0]").attr("selected","selected");$("#Room2_iChildren option[value=0]").attr("selected","selected");$("#Room3_iChildren option[value=0]").attr("selected","selected");$("#BiChildren option[value=0]").attr("selected","selected");$("#BRoom2_iChildren option[value=0]").attr("selected","selected");$("#BRoom3_iChildren option[value=0]").attr("selected","selected");pax!="Other"?(showDivRoom(0),cleanValues(0),$("#AiAdults option[value='"+pax+"']").attr("selected","selected"),$("#ARoom2_iAdults option[value='"+pax2+"']").attr("selected","selected"),$("#ARoom3_iAdults option[value='"+pax3+"']").attr("selected","selected"),$("#BiAdults option[value='"+pax+"']").attr("selected","selected"),$("#BRoom2_iAdults option[value='"+pax2+"']").attr("selected","selected"),$("#BRoom3_iAdults option[value='"+pax3+"']").attr("selected","selected")):(showDivRoom(3),cleanValues(0),$("#AiAdults option[value=2]").attr("selected","selected"),$("#ARoom2_iAdults option[value=2]").attr("selected","selected"),$("#ARoom3_iAdults option[value=2]").attr("selected","selected"),$("#BiAdults option[value=2]").attr("selected","selected"),$("#BRoom2_iAdults option[value=2]").attr("selected","selected"),$("#BRoom3_iAdults option[value=2]").attr("selected","selected"))}}function submitForm(){var n,v,y,c,h,p,u,f,t,r,l,o,s,d,a,e;v=$('input[id^="addFlight"]').val();switch(v){case"True":if($("#iDepCity").val()==-1||$("#iDepCity").val()==""||$("#sDepCity").val()==="")return n="<ol><li>Please select your departure city<\/li><\/ol><span><\/span>",chkValid("sDepCity",n),$("#sDepCity").select().addClass("calendar-error"),!1;$("#iRetCity").val($("#iDepCity").val())}y=$.trim($("#InDate1").val());switch(y){case"mm/dd/yyyy":case"Select Date":case"":return n="<ol><li>Please select your departure date<\/li><\/ol><span><\/span>",chkValid("InDate1",n),!1}$("#iRoom").val(rom);$("#Rooms").val(rom);switch(rom){case"1":c=$("#AiAdults").val();h=$("#iChildren").val();$("#iAdults").val($("#AiAdults").val());$("#Room2_iAdults").val("");$("#Room3_iAdults").val("");break;case"2":c=Number($("#AiAdults").val())+Number($("#ARoom2_iAdults").val());h=Number($("#iChildren").val())+Number($("#Room2_iChildren").val());$("#iAdults").val($("#AiAdults").val());$("#Room2_iAdults").val($("#ARoom2_iAdults").val());$("#Room3_iAdults").val("");break;case"3":c=Number($("#iAdults").val())+Number($("#Room2_iAdults").val())+Number($("#Room3_iAdults").val());h=Number($("#iChildren").val())+Number($("#Room2_iChildren").val())+Number($("#Room3_iChildren").val());$("#iAdults").val($("#AiAdults").val());$("#Room2_iAdults").val($("#ARoom2_iAdults").val());$("#Room3_iAdults").val($("#ARoom3_iAdults").val())}if(p=Number(c)+Number(h),p>6)return n="<ol><li>Max guest allowed (adults + children) are 6 !<\/li><\/ol><span><\/span>",chkValid("dvRoom1",n),!1;if(h>0){var w=$("#iChildren").val(),b=$("#Room2_iChildren").val(),k=$("#Room3_iChildren").val();if(w>0&&rom>=1)for(i=1;i<=w;i++)if(u=$("#iChild"+i+"").val(),isNaN(u)||u==""||!isNaN(u)&&(u<2||u>11))return isNaN(u)||u==""?(n="<ol><li>Please enter a valid age !<\/li><\/ol><span><\/span>",t=""):u<2?(n="<ol><li>All infants (2 and under) are considered as children age 2<\/li><\/ol><span><\/span>",t=2):(n="<ol><li>Child age is 11 or less<\/li><\/ol><span><\/span>",t=11),chkValid("iChild"+i,n),isNaN(u)||u==""?$("#iChild"+i+"").val(""):$("#iChild"+i+"").val(t),$("#BiChild"+i+"").val($("#iChild"+i+"").val()),!1;if(b>0&&rom>=2)for(i=1;i<=b;i++)if(f=$("#Room2_iChild"+i+"").val(),isNaN(f)||f==""||!isNaN(f)&&(f<2||f>11))return isNaN(f)||f==""?(n="<ol><li>Please enter a valid age !<\/li><\/ol><span><\/span>",t=""):f<2?(n="<ol><li>All infants (2 and under) are considered as children age 2<\/li><\/ol><span><\/span>",t=2):(n="<ol><li>Child age is 11 or less<\/li><\/ol><span><\/span>",t=11),chkValid("Room2_iChild"+i,n),isNaN(f)||f==""?$("#Room2_iChild"+i+"").val(""):$("#Room2_iChild"+i+"").val(t),$("#BRoom2_iChild"+i+"").val($("#Room2_iChild"+i+"").val()),!1;if(k>0&&rom>=3)for(i=1;i<=k;i++)if(r=$("#Room3_iChild"+i+"").val(),isNaN(r)||r==""||!isNaN(r)&&(r<2||r>11))return isNaN(r)||r==""?(n="<ol><li>Please enter a valid age !<\/li><\/ol><span><\/span>",t=""):r<2?(n="<ol><li>All infants (2 and under) are considered as children age 2<\/li><\/ol><span><\/span>",t=2):(n="<ol><li>Child age is 11 or less<\/li><\/ol><span><\/span>",t=11),pos==1?(chkValid("Room3_iChild"+i,n),isNaN(r)||r==""?$("#Room3_iChild"+i+"").val(""):$("#Room3_iChild"+i+"").val(t),$("#BRoom3_iChild"+i+"").val($("#Room3_iChild"+i+"").val())):(chkValid("BRoom3_iChild"+i,n),isNaN(r)||r==""?$("#BRoom3_iChild"+i+"").val(""):$("#BRoom3_iChild"+i+"").val(t),$("#Room3_iChild"+i+"").val($("#BRoom3_iChild"+i+"").val())),!1}for(l=Number($("#hwMnyCty").val())+1,o="",i=0;i<=l;i++)s=$("#ecityCat"+i+"").val(),s==undefined&&(s=""),o=i==0?o+s:i==l?o+s+",":o+","+s;$("#MiniPackCat").val(o);d=$("#PackType").val();a=$("#Pkgid").val();switch(d){case"TP3":_bpURL="https://reservation.tripmasters.com/Tourpackage4/Itinerary/Create";bookProcess=_bpURL+"?"+a;break;case"MC":bookProcess="http://reservations.tripmasters.com/TVLAPI/Multicity3/MC_ComponentList.ASP?"+a}$("#frmToBook").attr("action",bookProcess);$("#frmToBook").submit();$("#utm_campaign").val()==""?$("#utm_campaign").val(""+utmValue+""):"";e="";e=JSON.stringify($("#frmToBook").serializeObject());e=JSON.parse(e);delete e.__RequestVerificationToken;e=JSON.stringify(e);setItemF("localStorageTMEDT21",e,1)}function popError(n,t){var i=$("#"+n+"").offset();$("#divError").html(t);$("#divError").show();t.indexOf("All infants")!=-1?$("#divError").offset({left:i.left-100,top:i.top-60}):$("#divError").offset({left:i.left-85,top:i.top-50});setTimeout("$('#divError').hide()",2e3)}function dateByDest(){var r=blockDates.replace("B-",""),f,o,n,e,h,u;for(r=r.trim().split("-"),f=r[0].split("*"),o=r[1].split("*"),i=0;i<=f.length-1;i++)for(var c=f[i],l=o[i],t=stringToDate(""+l+"","mm/dd/yyyy","/"),a=stringToDate(""+c+"","mm/dd/yyyy","/"),s;a<=t;)s=t.getDate(),between.push(jQuery.datepicker.formatDate("yy-mm-dd",t)),t=new Date(t.setDate(--s));if(n="",e=new Date,n=new Date(e.getTime()+6048e5),h=new Date(e.getTime()+7776e6),u=jQuery.datepicker.formatDate("yy-mm-dd",n),between.indexOf(u)!=-1){while(between.indexOf(u)!=-1)n.setDate(n.getDate()+1),u=jQuery.datepicker.formatDate("yy-mm-dd",n);h<=n&&$(".InDate1").val(jQuery.datepicker.formatDate("mm/dd/yy",n))}$("#InDate1").datepicker("destroy");$("#InDate1").datepicker({orientation:"top",defaultDate:n,changeMonth:!1,changeYear:!1,numberOfMonths:1,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:n,maxDate:"+1Y",showOtherMonths:!1,beforeShowDay:function(n){var t=jQuery.datepicker.formatDate("yy-mm-dd",n);return[between.indexOf(t)===-1]},beforeShow:function(n,t){var i=t.dpDiv;setTimeout(function(){i.position({my:"right top",at:"right bottom",collision:"flip",of:n})},1)}})}function stringToDate(n,t,i){var e=t.toLowerCase(),r=e.split(i),u=n.split(i),o=r.indexOf("mm"),s=r.indexOf("dd"),h=r.indexOf("yyyy"),f=parseInt(u[o]);return f-=1,new Date(u[h],f,u[s])}function changeCabin(n){$("#Cabin option").each(function(){this.value===n.id?this.selected="selected":""})}function changeDateDesk(n,t){$('input[id="InDate1"]').val(t)}var fixDatesdiv,citiesAll,backCook,fxDatesNET,ropx,rom,pax,pax2,pax3,paxMr,hwMCh,between;let packagesID;citiesAll=[];$(window).bind("pageshow",function(n){n.originalEvent.persisted&&($("#imgPriceIt1").show(),$("#imgLoading1").hide())});$(document).ready(function(){packagesID=$("#pakID").val();$("#imgPriceIt1").show();$("#imgLoading1").hide();fixDatesdiv=$("#fxNetDates").val();$(".paxRoomChAg").click(function(){$(this).select()});$('select[id*="iAdult"]').change(function(){$("#"+this.id.replace("A","B")+"").val(this.value)});newDest();readCookVal();fxDates=="0"&&dateByDest();fxDatesNET=$("#fxNetDates").val();fixDatesdiv=fxDatesNET;blockdates=$("#blockDates").val().split("|");$("#buttReorder").click(function(){window.location=document.URL.replace("package","packagebyo")})});rom="1";pax="2";between=[];$.fn.serializeObject=function(){var n={},t=this.serializeArray();return $.each(t,function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};