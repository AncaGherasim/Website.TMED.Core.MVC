function showRecently(){var i=Cookies.get("utPackView"),t={Id:visitID},n={};return n.url=SiteName+"/Api/RecentlyViewed",n.type="POST",n.contentType="application/json",n.data=JSON.stringify(t),n.dataType="json",n.success=function(n){pkVisited=n;var t=0;pkVisited?t=pkVisited.length:"";t>0?($(".dvRecentlyTitle").find("span").html("["+t+"]"),buildRecentlyViewed(pkVisited),t>5?$(".moreViewed").show():$(".moreViewed").hide()):($(".template-RecentlyViewed").hide(),$(".moreViewed").hide())},n.error=function(n){console.log(n)},$.ajax(n),!1}function buildRecentlyViewed(n){var r=0,i,t="";jQuery.each(n,function(){if(r++,r<6){switch(this.UTS_Site){case"TMLD":i="/europe";break;case"TMASIA":i="/asia";break;case"TMLD":i="/latin"}var n=new Date(Date.parse(this.UTS_Date)),u=new Date,f=Date.timeBetween(n,u);t=t+'<li><div class="div-ContainerFlex" ><div class="wrapper"><img src="https://pictures.tripmasters.com'+this.IMG_Path_URL.toLowerCase()+'" alt="'+this.PDL_Title+'"><div><h5><a href="'+this.UTS_URL+'">'+this.PDL_Title+'<\/a><\/h5><\/div><\/div><div class="div-UnderImg"><p class="p-under1">Viewed '+f+"<\/p>";this.feedbacks>0&&(t=t+'<p class="p-under1"><a href="'+this.UTS_URL.replace("/package","/feedback")+'">'+this.feedbacks+" Customer Reviews<\/a><\/p>");t=t+'<hr class="hr1"><a href="'+this.UTS_URL+'" class="allRecViewBtn">Customize It<\/a><\/div><\/div ><\/li >'}});$("#ulRecentlyViewed").append(t);$(".template-RecentlyViewed").slideDown()}function moreSuggestPacks(){$("#sugg2").is(":visible")===!1?($("#sugg2").slideDown("slow"),$(".moreSuggButton").removeClass("moreSuggButton").addClass("moreSuggButtonRot")):($("#sugg2").slideUp("slow"),$(".moreSuggButtonRot").removeClass("moreSuggButtonRot").addClass("moreSuggButton"))}function buildPackImg(){var r=0,n,t="Bipic",i=3,u=$("#imgItemID").val();$.ajax({type:"GET",url:SiteName+"/Api/Packages/PicsForPacks/"+u,contentType:"application/json; charset=utf-8",dataType:"json",success:function(u){var f,e;for(objPics=u,objImgs=$.grep(objPics,function(n){return n.imG_ImageType=="P0"}),picTotal=objPics.length,f=0,objPics.length<=3&&(f=objPics.length-1),objPics[f]&&(n=imageSize(objPics[f].imG_500Path_URL,objPics[f].imG_ImageType),objPics[f].imG_ImageType=="M0"&&(t="KipicMap",i=1),e='<img src="https://pictures.tripmasters.com'+objPics[f].imG_500Path_URL.toLowerCase()+'" id="'+t+i+'" alt="'+objPics[f].imG_500Path_URL.toLowerCase()+'" title="'+objPics[f].imG_Title+'" width="'+n[0]+'" height="'+n[0]+'" class="clsCursor"/>',$(".dvshowPIC").html(e),$(".dvshowPIC").show()),picTotal==3?CarrouPicsBuild(3):picTotal==4?CarrouPicsBuild(4):picTotal==5?CarrouPicsBuild(5):CarrouPicsBuild(6),m=0;m<Number(picTotal-1);m++)objPics[m].imG_ImageType=="M0"?($("#dvsmalMAP").html('<image src="https://pictures.tripmasters.com'+objPics[m].imG_500Path_URL+'" width="325" height="325" alt="'+objPics[m].imG_500Path_URL.toLowerCase()+'" title="'+objPics[m].imG_Title+'"/>'),$("#dvsmalMAP").show(),shwMaps=shwMaps+'<div align="center"><span class="Text_Arial12_LightBold">'+objPics[m].imG_Title+'<\/span><br/><br/><image src="https://pictures.tripmasters.com'+objPics[m].imG_500Path_URL+'" alt="'+objPics[m].imG_500Path_URL.toLowerCase()+'" title="'+objPics[m].imG_Title+'"/><\/div>',$("#dvShwMap").html(shwMaps),m=Number(picTotal-1)):r==1?$("#dvShwMap").html(shwMaps):$("#dvTabMap").hide()},error:function(n){$("#packPics").html(n.responseText)}});$('a[id*="prev"]').click(function(){return sliceThumb(Number(ini),Number(fin),this.id),!1});$('a[id*="next"]').click(function(){return sliceThumb(Number(ini+6),Number(fin+6),this.id),!1})}function winlocation(n){window.location=n}function openMask(){var n=$(document).height();$(".dvMask").css({height:n});$(".dvMask").fadeIn(1e3);$(".dvMask").fadeTo("slow",.9)}function popupImages(){var n=objPics[0].picBIG,t;n==undefined&&(n=objPics[0].picURL);t=objPics[0].picNA;$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" title="'+t+'" alt="'+n.toLowerCase()+'"/>');$("#dvPicNa").html(t);popUpImagesNav();var i=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.65);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(i.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(i.top+600))}function popupThisImages(n){popUpImagesNav();var t=$(".dvImgContOv").position();openMask();$(".dvmediaPopUp").css("top",t.top).show();window.scroll(0,t.top-150);n===undefined?(n=$(".dvshowPIC").find("img"),replacePicture(n.attr("id").replace("B","K"),n.attr("src"),n.attr("title"),n.attr("alt"))):replacePicture(n.id.replace("B","K"),n.src,n.title,n.alt)}function replacePicture(n,t,i,r){var u;u=r==="none"?picSRC:"https://pictures.tripmasters.com"+r;/O/.test(n)===!1?($('img.picSel[id*="Kipic"]').attr("class","picNSel"),$('img.picSel[id*="Mipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),$(".dvFstPic").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'" />'),/M/.test(n)===!0?($("#dvMV").hide(),$("#Mipic"+n.match(isNumber)+"").attr("class","picSel")):($("#dvMV").show(),$("#dvPicNa").html(i))):($('img[id*="Oipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),/Map/.test(n)===!0||u.match(img500)===!0?($(".dvshowPIC").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'" alt="'+r+'" title="'+i+'" width="290" height="290"  class="clsCursor"/>'),$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")):($(".dvshowPIC").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'"  class="clsCursor"/>'),$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")))}function moreMediaCLS(){$(".dvMask").hide().removeAttr("height");$(".dvmediaPopUp").hide()}function otherMoreDetails(n,t){$(".dvOtherInfo").each(function(){var i=$(this).attr("id"),t=i.match(isNumber);t==n?$("#"+i+"").is(":visible")==!1?($("#"+i+"").slideDown(),$("#dvArrow"+t+"").slideDown(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(270deg)")):($("#"+i+"").slideUp(),$("#dvArrow"+t+"").slideUp(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(90deg)")):($("#"+i+"").slideUp(),$("#dvArrow"+t+"").slideUp(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(90deg)"))});t===1?relPackCall(n):""}function relPackCall(n){var t="",r="",u="dvCom"+n,f="dvpkInf"+n,e="dvRel"+n;$.ajax({type:"GET",url:SiteName+"/Api/Packages/getDataRelPacks/"+n,contentType:"application/json; charset=utf-8",dataType:"text",success:function(o){if(msg=o,msg!=""){for(t='<div class="txt_grayLight11" style="padding:5px 3px;">Related Package<\/div><div style="padding:2px 2px;" align="left">',r='<div class="txt_11" style="padding:3px 3px 5px 3px;"><b>For more choices, combine cities found in this itinerary:<\/b><\/div><div style="padding:2px 2px;" align="left">',strPrts=msg.split("@"),i=0;i<=strPrts.length-1;i++)echP=strPrts[i].split("|"),t=t+'<span style="float:left; margin-right:5px; margin-bottom:3px;">',t=t+'<a href="'+SiteName+"/"+echP[0].replace(/\s/g,"_").toLowerCase()+'/vacations" style="margin-right:10px">',t=t+'<span class="txt_grayLight11">',t=t+"<u>"+echP[0]+"<\/u>",t=t+"<\/span><\/a><\/span>",echP[2]!=5&&(r=r+'<span style="float:left; margin-right:5px; margin-bottom:3px;"><a style="cursor:pointer;" class="falsecheckdop" id="falsedop'+echP[3]+'" >'+echP[0]+"<\/a>",r=r+'<input type="checkbox" name="dop'+echP[3]+'" id="dop'+echP[3]+'" style="display:none" value="'+echP[3]+"|"+echP[0]+'"/>',r=r+"<\/span>");t=t+'<br style="clear:both"/><\/div>';r=r+'<br style="clear:both"/><\/div>';$("#"+e+"").html(t);$("#"+u+"").html(r);$("#dvWait"+n+"").hide();$("#dvWait"+n+"").html("");$("#"+f+"").slideDown();activeCckBx("frm"+n)}},error:function(t){console.log("Error: "+t.responseText);$("#dvWait"+n+"").html(t.responseText)}})}function activeCckBx(n){$("#"+n+" input:checkbox").each(function(){this.checked?$("#false"+this.id+"").addClass("falsecheckeddop"):$("#false"+this.id+"").removeClass("falsecheckeddop")});var t;$("#"+n+" .falsecheckdop").click(function(){return this.id.indexOf("falsedot")>-1?t=this.id.replace("falsedot",""):this.id.indexOf("false")>-1?t=this.id.replace("false",""):"",$(this).hasClass("falsecheckeddop")?($(this).removeClass("falsecheckeddop"),$("#"+t+"").removeAttr("checked")):($(this).addClass("falsecheckeddop"),$("#"+t+"").attr("checked",!0)),$(this.hash).trigger("click"),!1})}function imageSize(n,t){return n.match(img500)!=null||t=="M0"?(picW="290px",picMtp="0px",$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")):(picW="200px",picMtp="45px",$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")),[picW,picMtp]}function CarrouPicsBuild(n){for(CoPic=0,CoMap=0,i=0;i<n;i++)picClass=i==0?"picSel":"picNSel",objPics[i].imG_ImageType=="P0"?(CoPic++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+CoPic+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(CoMap++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+CoMap+'"  class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>',hvBigMap=1),ini=0,fin=i;if(picTotal<6)var t=18*(6-picTotal);else t=0;$("#dvallTHU #prev").css({"padding-left":""+t+"px","background-position":""+t+"px 0"});$("#thumbs").html(TthumPic);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}function sliceThumb(n,t,r){var e,u,f;if(TthumPic="",r=="prev"){if(t==picTotal-1?(e=Number(t-n),n=n-6,t=Number(t-e)-1):(n=n-6,t=t-6),n<0)return alert("No more images"),!1;for(u=n,f=n,i=n;i<=t;i++)picClass="picNSel",objPics[i].imG_ImageType=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"right"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"left"},500);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}if(r=="next")if(t>picTotal-1&&(t=picTotal-1),n>=picTotal-1)alert("No more images");else{for(u=n-1,f=n-1,i=n;i<=t;i++)picClass="picNSel",objPics[i].imG_ImageType=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"left"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"right"},500);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}}function popUpImagesNav(){thumPic="";thumMap="";hvMap=0;var n=0,r=0,t="picNSel";for(i=0;i<Number(picTotal);i++)t=i==0?"picSel":"picNSel",objPics[i].imG_ImageType=="P0"?(n++,thumPic=thumPic+'<img id="Kipic'+n+'" class="'+t+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/>'):(objPics[i].imG_ImageType=="M0"||objPics[i].imG_ImageType=="M1")&&(r++,thumMap=thumMap+'<img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="Mipic'+r+'" class="'+t+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL+'" title="'+objPics[i].imG_Title+'"/>',hvMap=1);newPicTot=n;$("#dvThuPic").html("Photos<br/>"+thumPic);hvMap==1?($("#dvThMp").show(),$("#dvThuMap").html("Map<br/>"+thumMap)):($("#dvThMp").hide(),$("#dvTabMap").hide());$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}function swichImg(n){var e,f,t,u,i,r;e=newPicTot;f=$('img.picSel[id^="K"]');t=f.attr("id");t=t.replace("ipic","");t.indexOf("O")>-1&&(t=t.replace("O",""));t.indexOf("K")>-1&&(t=t.replace("K",""));n=="F"&&(t==e?alert("No more photos"):(u=Number(t)+1,r=objImgs[t].imG_500Path_URL,r==""&&(r=objImgs[u].imG_500Path_URL),i=$("#Kipic"+u+""),$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")));n=="B"&&(t==1?alert("No more photos"):(u=Number(t)-1,r=objImgs[u-1].imG_500Path_URL,r==""&&(r=objImgs[u-1].imG_500Path_URL),i=$("#Kipic"+u+""),$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")))}function moreMedia(){var n=objPics[0].picBIG,t;n==undefined&&(n=objPics[0].picURL);t=objPics[0].picNA;$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" title="'+t+'" alt="'+n.toLowerCase()+'"/>');$("#dvPicNa").html(t);popUpImagesNav();var i=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.65);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(i.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(i.top+600))}function moreMediaB(n,t,i,r){popUpImagesNav();var u=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.8);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(u.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(u.top+600));replacePicture(n.replace("B","K"),t,i,r)}function scrollToTop(){$("body,html").animate({scrollTop:0},800)}function findPacksHome(n){var h,t;$("#"+n+" input[name=allID]").val("");$("#"+n+" input[name=allNA]").val("");$("#"+n+" input[name=__RequestVerificationToken]").prop("disabled",!0);h=n;t=$("#"+h+"").serialize();$("#"+n+" input[name=__RequestVerificationToken]").prop("disabled",!1);var e,o,r,u="",f="",s=0;for(t=t.replace(/\+/g," "),t=t.replace(/\%7C/g,"|"),e=t.split("&"),i=0;i<e.length;i++)o=e[i].split("="),o[1]!=""&&(s=s+1,r=o[1].split("|"),s>1?(u=u+","+r[0],f=f+"_-_"+r[1].replace(/\s/g,"_")):(u=r[0],f=r[1].replace(/\s/g,"_")));if(u==""){alert("Please check at least one box. Thanks!");return}$("#allID").val(u);$("#allNA").val(f);window.location.href=SiteName+"/"+f.toLowerCase()+"/find-packages"}var regionCheck="TMLD",depCities=[],arrivalCities=[],latinCities=[],arrvCTY=[],myDate=new Date,BorF="BYO",docH,backCookie,visitID,chnC=0,visCook=0;$(document).ready(function(){var i=Cookies.get("utmcampaign"),n,t;$(".template-RecentlyViewed").hide();$(".moreViewed").hide();Cookies.get("ut2")!=undefined?(n=Cookies.get("ut2").split("&"),t=n[0].split("="),visitID=t[1]):_ut2Functions.push(function(){utValues=_ut2;jQuery.each(utValues,function(n,t){n=="_utvId"&&(visitID=t)})});$("#dvHeaderGap").css("margin-bottom","0px");$(".dvhGreyBG").css("margin-bottom","0px");$(".moreViewed, .buildButton, .btnRevMore").click(function(){winlocation(this.getAttribute("data-go-to"))});$(".dvshowPIC").on("click","img",function(){popupThisImages(this)});$(".moreImgButt").click(function(){popupThisImages()});$(".moreSuggButton").click(function(){moreSuggestPacks()});$("#imgForw").click(function(){swichImg("F")});$("#imgBack").click(function(){swichImg("B")});buildPackImg();$(".dvEachOtherMore").click(function(){var n=this.getAttribute("data-id");otherMoreDetails(n,1)});$(".dvOtherClose span").click(function(){var n=this.id;otherMoreDetails(n,0)})});Date.timeBetween=function(n,t){var e=n.getTime(),o=t.getTime(),i=o-e,s,r,u,f;return i=i/1e3,s=Math.floor(i%60),i=i/60,r=Math.floor(i%60),i=i/60,u=Math.floor(i%24),f=Math.floor(i/24),f>0?f===1?f+" day ago":f+" days ago":u>0?u===1?u+" hour ago":u+" hours ago":r>0?r===1?r+" minute ago":r+" minutes ago":"  just visited"};var pics="",aPic="",thumPic="",OthumPic="",TthumPic="",thumMap="",OthumMap="",picSize=200,shwMaps="",maskH,maskW,isNumber=/[0-9]+/g;$(document).ready(function(){maskH=$(document).height();maskW=$(window).width();$(".moreButton").click(function(){$(".dvEacHighhHide").is(":visible")===!1?($(this).html("Close More Highlights & Attractions "),$(".dvEacHighhHide").slideDown()):($(this).html("More Highlights & Attractions"),$(".dvEacHighhHide").slideUp())});$(".dvSuggestTitle a, .dvEachSuggest2ndCol").click(function(){var n=this.id,t=$("#divInfo"+n+"");return t.is(":visible")==!1?(t.slideDown(),$('div.dvEachSuggest2ndCol[id="'+n+'"]').css("transform","rotate(270deg)"),otherMoreDetails(n,1)):(t.slideUp(),$('div.dvEachSuggest2ndCol[id="'+n+'"]').css("transform","rotate(90deg)")),!1})});