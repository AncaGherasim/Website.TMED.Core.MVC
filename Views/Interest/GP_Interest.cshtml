@model MVC_TMED.Models.ViewModels.InterestViewModel
@using MVC_TMED.Infrastructure;
@using Microsoft.Extensions.Options
@using System.Text.RegularExpressions;
@inject IOptionsMonitor<AppSettings> _appsettings

@section Styles {
    <environment include="Development">
        <link rel="stylesheet" href="~/css/bestVacations/dt.style.bestVacations.css" />
    </environment>
    <environment exclude="Development">
        <link rel="stylesheet" href="~/css/bestVacations/dt.style.bestVacations.css" asp-append-version="true" />
    </environment>
}
@{
    <script>var SiteName = '@_appsettings.CurrentValue.ApplicationSettings.SiteName' </script>
}

@{
    Decimal overAllAvg = 0;
    Decimal defw = 120;
    Decimal w = 0;
    overAllAvg = Decimal.Round(Model.Score, 1);
    w = Decimal.Round((overAllAvg * defw) / 5, 1);
    Decimal lowP = 500;
    Decimal highP = 9000;
    List<Int64> offerPrices = new List<Int64>();
    List<String> offerUrl = new List<string>();
    string pack3Ids = "";
    var pkC = 0;

    if (Model.listFeatured.Count > 0)
    {
        foreach (var z in Model.listFeatured)
        {
            if (z.STP_Save_ != 9999)
            {
                offerPrices.Add((Int32)z.STP_Save_);
            }
            offerUrl.Add(String.Format("https://www.tripmasters.com/europe/{0}/{1}/package-{2}", Model.plcNA.Replace(" ", "_").ToLower(), z.PDL_Title.Replace(" ", "_").ToLower(), z.PDLID));
            pack3Ids = pack3Ids + z.PDLID + ", ";
        }
        if (Model.otherFeatured.Count > 0)
        {
            foreach (var o in Model.otherFeatured)
            {
                if (o.STP_Save_ != 9999)
                {
                    offerPrices.Add((Int32)o.STP_Save_);
                }
                offerUrl.Add(String.Format("https://www.tripmasters.com/europe/{0}/{1}/package-{2}", Model.plcNA.Replace(" ", "_").ToLower(), o.PDL_Title.Replace(" ", "_").ToLower(), o.PDLID));
                if (pkC == 0) { pack3Ids = pack3Ids + o.PDLID + ", "; };
                if (pkC == 1) { pack3Ids = pack3Ids + o.PDLID; };
                pkC++;
            }
        }
        if (offerPrices.Count > 0)
        {
            lowP = offerPrices.Min();
            highP = offerPrices.Max();
        }
    }
    Int32 packFeedCountCity = Model.listCustomFeed.Count;
    if (packFeedCountCity <= 0)
    {
        packFeedCountCity = 1;
    }
}

@{
    <script type="application/ld+json">
        {
        "@@context" : "https://schema.org",
        "@@type" : "Product",
        "name" : "@Model.intNA",
        "mpn":"@Model.intNA-vac",
        "sku":"@Model.intNA",
        "brand" : {
        "@@type" : "Brand",
        "name": "Tripmasters Europe",
        @Html.Raw(String.Format("\"url\" : \"https://www.tripmasters.com/europe/{0}/{1}/interest-{2}-{3}\",", @Model.plcNA.Replace(" ", "_").ToLower(), Model.intNA.Replace(" ", "_").ToLower(), @Model.intID, @Model.plcID))
        "logo" : "https://pictures.tripmasters.com/siteassets/d/tm_header_logo.png"
        },
        "image":"https://pictures.tripmasters.com/siteassets/d/tm_header_logo.png",
        "review":{
        "@@type":"Review",
        "name":"@Model.packFeedCountC",
        "author":{
        "@@type":"Organization",
        "name":"Tripmasters"
        }
        },
        "offers": {
        "@@type": "AggregateOffer",
        "priceCurrency":"USD",
        "highPrice": "@highP",
        "lowPrice": "@lowP",
        "offerCount": "4",
        "offers": [
        {
        "@@type": "Offer",
        "url": "@offerUrl[0]"
        },
        {
        "@@type": "Offer",
        "url": "@offerUrl[1]"
        },
        {
        "@@type": "Offer",
        "url": "@offerUrl[2]"
        },
        {
        "@@type": "Offer",
        "url": "@offerUrl[4]"
        }
        ]
        },
        "description" : "@Model.pageDescriptionCity",
        "additionalProperty" : "@Model.pageBannerText",
        "aggregateRating": {
        "@@type": "aggregateRating",
        "ratingValue": "@overAllAvg",
        "reviewCount": "@packFeedCountCity"
        },
        "sameAs":[
        "https://twitter.com/tripmasters",
        "https://www.facebook.com/Tripmasters",
        "https://www.pinterest.com/tripmasters/",
        "https://www.instagram.com/tripmasterstravel/",
        ]
        }
    </script>
    <script type="text/javascript">
        var SiteName = '@_appsettings.CurrentValue.ApplicationSettings.SiteName'
            dataLayer.push({
                'packagesIDs': '@pack3Ids'
            });
    </script>
}

<div id="dvMask"></div>
<div id="dvTransOptResp">
    <div id="dvOptions"></div>
</div>
@{
    string dvFea = "block";
    string dvAll = "none";
}
<div id="navDest" class="dvBg_navDestinos">
    <div id="destVal">
    </div>
    <div style="padding-right: 10px;" align="right" class="Text_11">
        <a href="/europe/_Vacations" onclick="javascript:$('#navDest').slideUp(); return false;"> close [-] </a>
    </div>
</div>
<div id="CObgshow" style="display:none; position:absolute; top:0px; left:0px; filter:alpha(opacity=65); -moz-opacity:.65; opacity:.65; background-color:#CCCCCC; z-index:1010;"></div>

<center>
    <div class="dvBGpageTitle">
        <div class="dvPageTitleWhite">@Model.pageHeaderText</div>
        <div id="dvlinkHeader">
            <img src="https://pictures.tripmasters.com/siteassets/d/nav_barDivis.jpg" width="1" height="36" border="0" align="absmiddle" style="padding-top:5px;" alt="" /> <a asp-controller="Home" asp-action="Index">Home</a>
            <img src="https://pictures.tripmasters.com/siteassets/d/nav_barDivis.jpg" width="1" height="36" border="0" align="absmiddle" style="padding-top:5px;" alt="" /> <a href="" onclick="countryDest(0); return false;">Europe<img src="https://pictures.tripmasters.com/siteassets/d/nav_Down.gif" border="0" style="margin-left:5px;" alt="" /></a>
        </div>
        <div style="clear: both">
        </div>
    </div>
    <div id="navDest" class="bg_navDestinos">
        <div id="destVal"></div>
        <div style="padding-right:10px;" align="right" class="Text_11"><a href="/europe/_Vacations" onclick="javascript:$('#navDest').slideUp(); return false;"> close [-] </a></div>
    </div>
    <div class="dvRoundBoxes" style="margin-top: 10px; width: 980px; display:none;">

        <div style="padding: 15px 15px 15px 15px" align="left">
            <div class="Text_12" style="width:600px; float:left; padding:5px"> <%'=intDES%> </div>
            <div class="BG_BrowseTrips" style="        padding: 20px 15px 5px 10px;
        width: 300px;
        height: 70px;
        float: right;
        background: url(https://pictures.tripmasters.com/siteassets/dhttps://pictures.tripmasters.com/siteassets/d/browse_icon.jpg) no-repeat center right;">
                <div class="Text_Arial14_BlueBold" style="padding:3px 0px">Browse trips others have</div>
                <div class="Text_Arial14_BlueBold" style="padding:3px 0px">taken to @Model.plcNA:&nbsp; <img src="https://pictures.tripmasters.com/siteassets/d/AreaSubscribebtn.gif" border="0" align="absmiddle" style="cursor:pointer;" onclick=@String.Format("window.location='/europe/{0}/trips_taken_by_travelers'", Model.plcNA.Replace(" ", "_").ToLower()) alt="" /></div>
            </div>
            <div style="clear:both; padding:1px;"></div>
        </div>
    </div>
    <!-- end top of page -->

    <div style="width:980px; height:auto; margin-top:10px;">
        <div style="float:left; margin-right:10px; margin-top:5px; width:200px;">
            <!-- start div left col -->
            @await Component.InvokeAsync("GP2UCLeft", new { plcNA = Model.plcNA, plcIDs = Model.plcIDs, plcID = Model.intIDs, plcTY = "", counID = 0, counNA = "", leftDisplay = Model.listCustDly.FindAll(n => n.SDP_DisplayProdKindID == 1877), boxContent = Model.boxContent, placesOnWeight = Model.placesOnWeight, pgtype = "WInt", strPlcsIDs = new System.Text.StringBuilder(""), countryCities = Model.placesOnWeight })
            <!-- end div left col -->
        </div>
    </div>

    <!-- center div -->
    <!--- actual display -->
    <div style="float:left; height:auto; width:435px; margin-right:10px;" align="left" id="dvCenter">
        <div id="featuredItin" style=@String.Format("display:{0}",dvFea)>
            <div class="orangeTitle_20" style=" padding-bottom:5px; padding-top:10px;"> Best Vacation Package</div>
            <div id="dvfeatPics" style="margin-top:10px; border-top:solid 1px #36F; padding-top:3px; cursor:pointer;" onclick=@String.Format("window:location='/{0}/package/{1}/{2}'", Model.featPack[0].CountryName.Replace(" ", "_"), Model.featPack[0].PDLID, Model.featPack[0].PDL_Title.Replace(" ", "_"))></div>
            <div id="featInfo" class="BGfeatuItin" style="margin-top:3px;" align="left">
                <div align="left" class="packTitle_15" style="padding:10px 5px;">
                    <span class="packTitle_15" style="padding:10px 5px;">
                        <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[0].CountryName.Replace(" ", "_").ToLower(), Model.featPack[0].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[0].PDLID)>@Model.featPack[0].PDL_Title</a>
                    </span>
                </div>

                @{
                    string lnGuiNo = "none";
                    if (Model.featPack[0].SPD_InternalComments.Contains("1784:."))
                    {
                        lnGuiNo = "Guided";
                    }
                    if (Model.featPack[0].SPD_InternalComments.Contains("1785:."))
                    {
                        lnGuiNo = "Partially Guided";
                    }
                    if (lnGuiNo != "none")
                    {
                        <div align="left" id=@String.Format("{0}|{1}|F", lnGuiNo, Model.featPack[0].PDLID) class="Text_12_Gray" style="cursor:pointer; width:100px; padding:0px 10px;" onMouseOver="showPopUp(this.id)" onMouseOut="hidePopUp(this.id)">
                            @lnGuiNo
                        </div>
                    }
                }
                <div>
                    <div align="left" class="Text_Arial12_Light" style="margin-top:5px; float:left; width:275px; padding:5px 0px 0px 10px;">
                        @Html.Raw(Model.featPack[0].SPD_Description)
                    </div>
                    <div class="BGpriceButtom" style="margin-top:5px; float:left; width:147px; height:110px; padding-top:20px;" align="center">
                        @if (Model.featPack[0].STP_Save_ != 9999)
                        {
                            <div>
                                <span class="Text_Arial11_Light">@Model.featPack[0].PDL_Duration nights from</span>
                                <span class="Orange-Arial12NB"><b>@Model.featPack[0].STP_Save_.ToString("C0")*</b></span>
                            </div>
                        }
                        <div style="margin:8px 0px;">
                            <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[0].CountryName.Replace(" ", "_").ToLower(), Model.featPack[0].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[0].PDLID)>
                                <img src="https://pictures.tripmasters.com/siteassets/d/BOT-Customize.gif" width="120" height="28" border="0" />
                            </a>
                        </div>
                        @if (Model.featPack[0].NoOfFeed > 0)
                        {
                            <div class="Text_Arial12_Blue">
                                <a href=@String.Format("{0}/{1}/{2}/feedback-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[0].CountryName.Replace(" ", "_").ToLower(), Model.featPack[0].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[0].PDLID)>
                                    Customer feedback (@Model.featPack[0].NoOfFeed)
                                </a>
                            </div>
                        }
                    </div>
                    <div style="clear:both"></div>
                </div>

                <div id=@String.Format("dvWait{0}", Model.featPack[0].PDLID) style="display:none; padding: 20px;" align="center"></div>
                <div id=@String.Format("pkInf{0}", Model.featPack[0].PDLID) style="padding:5px 10px 10px 10px; display:none;" align="left">
                    <div style="font-size:12px"><b>Included:</b></div>
                    <div style="padding-left:15px;font-size:12px;">
                        @{
                            string[] contFParts = Model.featPack[0].PDL_Content.Split("\r\n");
                            foreach (var fpr in contFParts)
                            {
                                @Html.Raw(String.Format("<li>{0}</li>", fpr));
                            }
                        }
                    </div>
                    <div style="clear:both"></div>
                    <hr class="DotedLine" />
                    <div class="Text_Arial11" id=@String.Format("dvRelF{0}", Model.featPack[0].PDLID) style="display:block; padding:5px 2px 5px 10px;">
                        <center>
                            <img src="https://pictures.tripmasters.com/siteassets/d/ajax-indicator.gif" width="16" height="16" alt="" />
                        </center>
                    </div>
                    <hr class="DotedLine" />
                    <form name=@String.Format("frm{0}", Model.featPack[0].PDLID) id=@String.Format("frm{0}", Model.featPack[0].PDLID) style="margin:0px" method="post">
                        <div class="Text_Arial11" id=@String.Format("dvComF{0}", Model.featPack[0].PDLID) style="display:block; padding:5px 5px;">
                            <center>
                                <img src="https://pictures.tripmasters.com/siteassets/d/ajax-indicator.gif" width="16" height="16" alt="" />
                            </center>
                        </div>
                        <div class="Text_Arial12_LightBold" style="padding:5px 3px 15px 3px;" align="center"><a style="cursor:pointer;" onclick=@String.Format("findPackst4('frm{0}'); return false", Model.featPack[0].PDLID)> >> Find similar package </a></div>
                        <input type="hidden" name="allIDsdp" id="allIDsdp" value="" />
                        <input type="hidden" name="allID" id="allID" value="" />
                        <input type="hidden" name="allNA" id="allNA" value="" />
                    </form>
                    <hr class="DotedLine" />
                </div>
                <div align="left" class="Text_12_Bright" style="padding:8px 15px; margin-right:5px;">
                    <span style="cursor:pointer" onclick=@String.Format("openDivInfFNw({0},0)", Model.featPack[0].PDLID)>
                        <img src="https://pictures.tripmasters.com/siteassets/d/Plus.jpg" name=@String.Format("pic{0}", Model.featPack[0].PDLID) width="9" height="9" align="absmiddle" id=@String.Format("pic{0}", Model.featPack[0].PDLID) alt="" />&nbsp;&nbsp;
                        <u id=@String.Format("moreTx{0}", Model.featPack[0].PDLID)>More details</u>
                    </span>
                </div>
            </div>
            <div align="center" style="margin:0px 0px 10px 0px ;">
                <img src="https://pictures.tripmasters.com/siteassets/d/Line_Blue299.gif" width="400" height="1" alt="" />
            </div>
            <div class="Text_Arial16_OrangeBold" align="left" style="margin-top:10px; padding:10px 5px 10px 5px;"> Other Vacation Packages</div>
            <div id="otherFeat">
                @{
                    Int32 lastPack = Model.featPack.Count;
                    if (lastPack > 3)
                    {
                        lastPack = 3;
                    }
                    for (Int32 fo = 1; fo <= lastPack; fo++)
                    {
                        string dvStyle = "";
                        if (fo > 1)
                        {
                            dvStyle = "<div class='BGother'>&nbsp;</div>";
                        }
                        <div class="BGotherFeatu" align="left">
                            @Html.Raw(dvStyle)
                            <div style="padding-left:12px;">
                                <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                    <img src=@String.Format("https://pictures.tripmasters.com{0}", Model.featPack[fo].IMG_Path_URL.ToLower()) width="120" height="120" border="0" />
                                </a>
                            </div>
                            <div align="left" class="Text_Arial12_LightBold" style="padding:0px 10px; margin-top:10px;">
                                <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                    @Model.featPack[fo].PDL_Title
                                </a>
                            </div>
                            @{
                                lnGuiNo = "none";
                                if (Model.featPack[fo].SPD_InternalComments.Contains("1784:."))
                                {
                                    lnGuiNo = "Guided";
                                }
                                if (Model.featPack[fo].SPD_InternalComments.Contains("1785:."))
                                {
                                    lnGuiNo = "Partially Guided";
                                }
                                if (lnGuiNo != "none")
                                {
                                    <div align="left" id=@String.Format("{0}|{1}|F", lnGuiNo, Model.featPack[fo].PDLID) class="Text_12_Gray" style="cursor:pointer; width:100px; padding:0px 10px;" onMouseOver="showPopUp(this.id)" onMouseOut="hidePopUp(this.id)">
                                        @lnGuiNo
                                    </div>
                                }
                            }
                            @if (Model.featPack[fo].STP_Save_ != 9999)
                            {
                                <div align="left" style="margin-top:10px; padding:0px 10px;">
                                    <span class="Text_Arial11_Light">@Model.featPack[fo].PDL_Duration nights from</span>
                                    <span class="Orange-Arial12NB"><b>@Model.featPack[fo].STP_Save_.ToString("C0")*</b></span>
                                </div>
                            }
                            @if (Model.featPack[fo].NoOfFeed > 0)
                            {
                                <a class="Text_Arial11_Blue" style="padding-left: 10px;" href=@String.Format("{0}/{1}/{2}/feedback-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                    Customer feedback (@Model.featPack[fo].NoOfFeed)
                                </a>
                            }
                        </div>
                    }
                    <div class="dvClear"></div>
                }
            </div>
            <div id="otherFeatMr">
                @for (Int32 fo = 1; fo <= lastPack; fo++)
                {
                    string dvStyle = "";
                    if (fo > 1)
                    {
                        dvStyle = "<div class='BGotherDwn'>&nbsp;</div>";
                    }
                    <div class="BGotherFeatuMr" align="left">
                        @Html.Raw(dvStyle)
                        <div id=@String.Format("dvMrTxt{0}", Model.featPack[fo].PDLID) align="left" class="Text_12_Bright" style="padding:0px 10px;">
                            <span style="cursor:pointer" onclick=@String.Format("openDivInfF({0},1)", Model.featPack[fo].PDLID)>
                                <img src="https://pictures.tripmasters.com/siteassets/d/Plus.jpg" name=@String.Format("pic{0}", Model.featPack[fo].PDLID) width="9" height="9" align="absmiddle" id=@String.Format("pic{0}", Model.featPack[fo].PDLID) />
                                &nbsp;&nbsp;
                                <u id=@String.Format("moreTx{0}", Model.featPack[fo].PDLID)>More details</u>
                            </span>
                        </div>
                        <div id=@String.Format("dvMrPic{0}", Model.featPack[fo].PDLID) class="BGDown" style="display:none;">&nbsp;</div>
                    </div>
                }
                <div style="clear:both"></div>
            </div>
            <div id="otherMr" style="display:none;">
                @for (Int32 fo = 1; fo <= lastPack; fo++)
                {
                    <div id=@String.Format("pkInf{0}", Model.featPack[fo].PDLID) style="padding:10px 0px 5px 0px; display:none;" align="left">
                        <div>
                            <div align="left" class="Text_Arial11" style="margin-top:5px; float:left; width:275px; padding:5px 0px 0px 5px;">
                                @Html.Raw(Model.featPack[fo].SPD_Description)
                                <div style="padding:5px 10px 10px 10px;" align="left">
                                    <div><b>Included:</b></div>
                                    <div style="padding-left:15px;">
                                        @{
                                            contFParts = Model.featPack[fo].PDL_Content.Split("\r\n");
                                            foreach (var fpr in contFParts)
                                            {
                                                @Html.Raw(String.Format("<li>{0}</li>", fpr));
                                            }
                                        }
                                    </div>
                                    <div style="clear:both"></div>
                                </div>
                            </div>
                            <div class="BGpriceButtom" style="margin-top:5px; float:left; width:147px; height:110px; padding-top:20px;" align="center">
                                @if (Model.featPack[fo].STP_Save_ != 9999)
                                {
                                    <div>
                                        <span class="Text_Arial11_Light">@Model.featPack[fo].PDL_Duration nights from</span>
                                        <span class="Orange-Arial12NB"><b>@Model.featPack[fo].STP_Save_.ToString("C0")*</b></span>
                                    </div>
                                }
                                <div style="margin:8px 0px;">
                                    <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                        <img src="https://pictures.tripmasters.com/siteassets/d/BOT-Customize.gif" width="120" height="28" border="0" />
                                    </a>
                                </div>
                                @if (Model.featPack[fo].NoOfFeed > 0)
                                {
                                    <div class="Text_Arial12_Blue">
                                        <a href=@String.Format("{0}/{1}/{2}/feedback-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                            Customer feedback (@Model.featPack[fo].NoOfFeed)
                                        </a>
                                    </div>
                                }
                            </div>
                            <div style="clear:both"></div>
                        </div>
                        <div id=@String.Format("dvajx{0}", @Model.featPack[fo].PDLID) style="display:none;">
                            <hr class="DotedLine" />
                            <form name=@String.Format("frm{0}", @Model.featPack[fo].PDLID) id=@String.Format("frm{0}", @Model.featPack[fo].PDLID) style="margin:0px" method="post">
                                <div class="Text_Arial11" id=@String.Format("dvComF{0}", @Model.featPack[fo].PDLID) style="display:block; padding:5px 5px;">
                                    <center>
                                        <img src="https://pictures.tripmasters.com/siteassets/d/ajax-indicator.gif" width="16" height="16" alt="" />
                                    </center>
                                </div>
                                <div class="Text_Arial12_LightBold" style="padding:5px 3px 15px 3px;" align="center">
                                    <a style="cursor:pointer;" onclick=@String.Format("findPacks('frm{0}'); return false", @Model.featPack[fo].PDLID)> >> Find similar package </a>
                                </div>
                                <input type="hidden" name="allIDsdp" id="allIDsdp" value="" />
                                <input type="hidden" name="allID" id="allID" value="" />
                                <input type="hidden" name="allNA" id="allNA" value="" />
                            </form>
                            <hr class="DotedLine" />
                        </div>
                        <div align="left" class="Text_12_Bright" style="padding:10px 15px;">
                            <span style="cursor:pointer" onclick=@String.Format("openDivInfF({0},2)", @Model.featPack[fo].PDLID)>
                                <img src="https://pictures.tripmasters.com/siteassets/d/minus.jpg" width="9" height="9" align="absmiddle" alt="" />&nbsp;&nbsp;<u>Close more details</u>
                            </span>
                        </div>
                    </div>
                }
            </div>

            @if (Model.featPack.Count - 1 > 3)
            {
                <div align="center" style="margin:10px 0px 10px 0px ;">
                    <img src="https://pictures.tripmasters.com/siteassets/d/Line_Blue299.gif" width="400" height="1" alt="" />
                </div>
                <h1 class="Text_Arial16_OrangeBold"> Suggested Vacation Packages</h1>
                {
                    string margT = "";
                    string bg = "";
                    Int32 bnn = 0;
                    if (Model.featPack.Count - 1 > 8)
                    {
                        bnn = 9;
                    }
                    else
                    {
                        bnn = Model.featPack.Count - 1;
                    }
                    for (Int32 fo = 4; fo <= Model.featPack.Count - 1; fo++)
                    {
                        if (fo == 4)
                        {
                            margT = "10px";
                        }
                        else
                        {
                            margT = "5px";
                        }
                        if (fo % 2 == 0)
                        {
                            bg = "#EAF2FF";
                        }
                        else
                        {
                            bg = "#white";
                        }
                        <div style=@String.Format("padding:5px;text-align:left;margin-top:{0};background-color:{1}; ", margT, bg)>
                            <div style="padding:2px 0px 2px 0px; float:left; margin-right:5px; " align="center">
                                <img src="https://pictures.tripmasters.com/siteassets/d/Plus.jpg" name=@String.Format("picF{0}", Model.featPack[fo].PDLID) width="9" height="9" align="absmiddle" id=@String.Format("picF{0}", Model.featPack[fo].PDLID) style="cursor:pointer" onclick=@String.Format("openDivInfo({0},'F','Europe','{1}')", Model.featPack[fo].PDLID, Model.featPack[fo].PDL_Title.Replace(" ", "_")) />
                            </div>
                            <div class="Text_Arial12_Blue" style="width:272px; padding:2px 0px 2px 0px; float:left;">
                                <span style="cursor:pointer" onclick=@String.Format("openDivInfo({0},'F','Europe','{1}')", Model.featPack[fo].PDLID, Model.featPack[fo].PDL_Title.Replace(" ", "_"))>
                                    @Model.featPack[fo].PDL_Title
                                </span>
                            </div>
                            @if (@Model.featPack[fo].STP_Save_ != 9999)
                            {
                                <div class="Text_10_GrayBold" style="padding:2px 0px 2px 0px; float:right; width:125px;" align="right">
                                    <span style="cursor:pointer" onclick=@String.Format("openDivInfo({0},'F','Europe','{1}')", Model.featPack[fo].PDLID, Model.featPack[fo].PDL_Title.Replace(" ", "_"))>
                                        @Model.featPack[fo].PDL_Duration nights from <b class="Orange-Arial12">@Model.featPack[fo].STP_Save_.ToString("C0")</b>
                                    </span>
                                </div>
                            }
                            else
                            {
                                <div class="Text_10_GrayBold" style="padding:2px 0px 2px 0px; float:right; width:125px;" align="right">
                                    <span id=@String.Format("mrDtls{0}", Model.featPack[fo].PDLID) style="cursor:pointer" onclick=@String.Format("openDivInfo({0},'F','Europe','{1}')", Model.featPack[fo].PDLID, Model.featPack[fo].PDL_Title.Replace(" ", "_"))>
                                        More details
                                    </span>
                                </div>
                            }
                            <div style="clear:both"></div>
                            @{
                                lnGuiNo = "none";
                                if (Model.featPack[fo].SPD_InternalComments.Contains("1784:."))
                                {
                                    lnGuiNo = "Guided";
                                }
                                if (Model.featPack[fo].SPD_InternalComments.Contains("1785:."))
                                {
                                    lnGuiNo = "Partially Guided";
                                }
                                if (lnGuiNo != "none")
                                {
                                    <div align="left" id=@String.Format("{0}|{1}|F", lnGuiNo, Model.featPack[fo].PDLID) class="Text_12_Gray" style="cursor:pointer; width:100px; padding:0px 15px;" onMouseOver="showPopUp(this.id)" onMouseOut="hidePopUp(this.id)">
                                        @lnGuiNo
                                    </div>
                                }
                            }
                        </div>
                        <div id=@String.Format("dvWaitF{0}", Model.featPack[fo].PDLID) style="padding:30px; display:none" align="center"></div>
                        <div id=@String.Format("dvInfF{0}", Model.featPack[fo].PDLID) class="Text_Arial12" style="padding:5px 5px 5px 20px; display:none" align="left">
                            <div id=@String.Format("dvTxtF{0}", Model.featPack[fo].PDLID) class="text_12" style="padding:3px 0px;">@Html.Raw(@Model.featPack[fo].SPD_Description)</div>
                            <div>
                                <div><b>Included:</b></div>
                                <div style="padding-left:15px;">
                                    @{
                                        contFParts = Model.featPack[fo].PDL_Content.Split("\r\n");
                                        foreach (var fpr in contFParts)
                                        {
                                            @Html.Raw(String.Format("<li>{0}</li>", fpr));
                                        }
                                    }
                                </div>
                            </div>
                            @if (Model.featPack[fo].NoOfFeed > 0)
                            {
                                <div class="Text_Arial11" id=@String.Format("dvFeedF{0}", Model.featPack[fo].PDLID) style="display:block; padding:5px 5px;">
                                    <a href=@String.Format("{0}/{1}/{2}/feedback-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                        Customer feedback (@Model.featPack[fo].NoOfFeed)
                                        <img src="https://pictures.tripmasters.com/siteassets/d/CustFeed_Mini.jpg" width="21" height="16" border="0" />
                                    </a>
                                </div>
                            }
                            <div id=@String.Format("butt{0}", Model.featPack[fo].PDLID) style="padding:15px 35px 5px 35px;" align="right">
                                &nbsp;&nbsp;&nbsp;&nbsp;
                                <a href=@String.Format("{0}/{1}/{2}/package-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fo].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fo].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fo].PDLID)>
                                    <img src="https://pictures.tripmasters.com/siteassets/d/BOT-Customize.gif" width="120" height="28" border="0" />
                                </a>
                            </div>
                            <hr class="DotedLine" />
                            <div class="Text_Arial11" id=@String.Format("dvRelF{0}", Model.featPack[fo].PDLID) style="display:none; padding:5px 5px;"></div>
                            <hr class="DotedLine" />
                            <form name=@String.Format("frm{0}", Model.featPack[fo].PDLID) id=@String.Format("frm{0}", Model.featPack[fo].PDLID) style="margin:0px" method="post">
                                <div class="Text_Arial11" id=@String.Format("dvComF{0}", Model.featPack[fo].PDLID) style="display:block; padding:5px 5px;"></div>
                                <div class="Text_Arial12_LightBold" style="padding:5px 3px 15px 3px;" align="center"><a style="cursor:pointer;" onclick=@String.Format("findPackst4('frm{0}'); return false", Model.featPack[fo].PDLID)> >> Find similar package </a></div>
                                <input type="hidden" name="allIDsdp" id="allIDsdp" value="" />
                                <input type="hidden" name="allID" id="allID" value="" />
                                <input type="hidden" name="allNA" id="allNA" value="" />
                            </form>
                            <div align="center" style="margin:0px 0px 0px 0px ;">
                                <img src="https://pictures.tripmasters.com/siteassets/d/Line_Blue299.gif" width="400" height="1" alt="" />
                            </div>
                        </div>
                        @if (fo == bnn)
                        {
                            if (Model.boxContent1624.Count > 0)
                            {
                                foreach (var box in Model.boxContent1624)
                                {
                                    if (box.STX_URL != "none")
                                    {
                                        if (box.STX_URL.StartsWith("/"))
                                        {
                                            box.STX_URL = box.STX_URL.Substring(1, box.STX_URL.Count() - 1);
                                        }
                                        <div style="PADDING:15px 0px 15px 0px; display:block;" align="center">
                                            <a href=@String.Format("/{0}", box.STX_URL)>
                                                <img src=@String.Format("{0}", box.STX_PictureURL.ToLower().Replace("http","https")) border="0" style="padding: 2px 0px 2px 0px" title="@box.STX_Title" alt="" />
                                            </a>
                                        </div>

                                    }
                                }
                            }
                        }
                    }
                }
            }
        </div>

        <div class="Bx_CR" style="display:none">
            <div class="Bx_BM">
                <div class="Bx_CL">
                    <div class="Bx_TM">
                        <div class="Bx_BL">
                            <div class="Bx_BR">
                                <div class="Bx_TL">
                                    <div class="Bx_TR">
                                        <div style="padding: 10px 10px 10px 10px" align="left">
                                            <div id="dvWeiPacks" style="height:auto;">
                                                @{
                                                    string[] intTitleP = Model.intNA.Split("-");
                                                    string intTitle = intTitleP[1].Trim();
                                                }
                                                <div class="Text_Arial16_BlueBold" style=" padding:6px 5px;">Most Popular @intTitle Itineraries:</div>
                                                <div align="center" style="margin-bottom:10px;">
                                                    <img src="https://pictures.tripmasters.com/siteassets/d/LineBlueCruise.jpg" width="400" height="1" />
                                                </div>
                                                <div id="dvPacksWait" align="center" class="Package_Description" style="padding:100px">
                                                    <img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><br />
                                                    <br />
                                                    loading ...
                                                </div>
                                                <div id="dvPacksW" style="padding:5px; display:none;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- right div -->
    <div style="float:left; width:325px; height:auto; margin-top:5px;" class="dvOtherRight">
        <div style="padding-bottom: 5px;">
            @await Component.InvokeAsync("UC_TM_SmallCalendar")
        </div>
        <div id="divQE_AJAXListContainer" style="DISPLAY:none" class="QE_AJAXListContainer_div"> Loading...Please wait </div>
        <div id="divPopUpContainer" style="DISPLAY:none" class="QE_PopupContainer_div"> </div>
        <div id="divCount" style="DISPLAY:none"></div>
        @if (Model.placesOnWeight.FindAll(x => x.STR_PlaceTypeID == 1 || x.STR_PlaceTypeID == 25).Count() > 0)
        {
            <div class="dvRoundBoxes1" style="margin-top:5px;">

                <div class="dvMostPopVacPack" align="left" style="margin:5px">Find Vacation Packages</div>
                <div class="dvBoxFullLightBlue1" style="padding:10px 10px;" align="left">
                    <form name="frmFindPack" id="frmFindPack" method="post" style="margin:0px">
                        <table width="99%" border="0" align="center" cellpadding="0" cellspacing="0">
                            <tr>
                                <td width="50%" valign="top">
                                    @{
                                        Int32 roundUp = 0;
                                        Double halfTotal = (double)Model.placesOnWeight.FindAll(x => x.STR_PlaceTypeID == 1 || x.STR_PlaceTypeID == 25).Count() / 2;
                                        Int32 ifDec = halfTotal.ToString().IndexOf(".");
                                        if (ifDec > 0)
                                        {
                                            roundUp = (Int32)halfTotal + 1;
                                        }
                                        else
                                        {
                                            roundUp = (Int32)halfTotal;
                                        }
                                        Int32 ctyC = 0;
                                        foreach (var cty in Model.placesOnWeight.FindAll(x => x.STR_PlaceTypeID == 1 || x.STR_PlaceTypeID == 25))
                                        {
                                            if (ctyC == roundUp)
                                            {
                                                @Html.Raw("</td><td valign='top'>");
                                            }
                                            <div style="padding:2px 2px 2px 2px; margin:4px 0px 4px 0px">
                                                <a href=@String.Format("#dot{0}", cty.STR_PlaceID) class="falsecheck" id=@String.Format("falsedot{0}", cty.STR_PlaceID)>@cty.STR_PlaceTitle</a>
                                                <input type="checkbox" name=@String.Format("dot{0}", cty.STR_PlaceID) id=@String.Format("dot{0}", cty.STR_PlaceID) style="display:none" value=@String.Format("{0}|{1}", cty.STR_PlaceID.ToString().Trim(), cty.STR_PlaceTitle.Trim()) />
                                            </div>

                                            ctyC++;
                                        }

                                    }
                                </td>
                            </tr>
                        </table>
                        <input type="hidden" name="allID" id="allID" value="" />
                        <input type="hidden" name="allNA" id="allNA" value="" />
                    </form>
                    <div align="center" style="padding:10px 5px; "><img src="https://pictures.tripmasters.com/siteassets/d/Botton_FindPacks.jpg" width="181" height="25" border="0" align="absmiddle" onclick="findPacks('frmFindPack')" alt=""></div>
                </div>
            </div>

        }

        @if (Model.listCustomFeed.Count > 0)
        {
            <div class="dvRoundBoxes" style="margin-top:10px;">

                <div style="padding:10px 10px 0px 10px; width:auto">

                    <div class="dvBGboxTitle" align="left"><span>Feedback from our travelers</span></div>


                </div>
                <div style="padding: 0px 10px 0px 10px; width:auto;" align="left">

                    <div id="TopOverAllFeeds" style=" height: 28px; padding: 0 6px 0;">
                        <div style="position: relative; margin: 0px 0px 0px -4px;">
                            <div class="emptyStars" style=@String.Format("width:{0}px;left:10px;", defw)></div>
                            <div id="dvTopStarsOverAll" class="fullStars" style=@String.Format("width:{0}px;left:10px;", w)></div>
                            <div id="dvTopStarsOverAllStr" class="darkText" style="float: left; position: absolute; left: 136px; width: 150px; top: 5px;font-size:12px; ">@overAllAvg out of 5 stars</div>
                            <div style="clear: both;"></div>
                        </div>

                    </div>
                    <p style="padding: 0 18px 5px;font-weight: 700;margin: 0 0 10px 0;border-bottom: 1px dotted #ccc; text-align:left;">@packFeedCountCity Reviews</p>
                    @{
                        string col = "";
                        Int32 tresShow = Model.listCustomFeed.Count;
                        if (Model.listCustomFeed.Count > 3)
                        {
                            tresShow = 3;
                        }
                        for (Int32 fdd = 0; fdd <= tresShow - 1; fdd++)
                        {
                            if (fdd % 2 == 0)
                            {
                                col = "#EAF2FF";
                            }
                            if (fdd % 2 == 1)
                            {
                                col = "white";
                            }

                            <div style=@String.Format("background-color:{0};padding:10px;", col) class="Text_12">
                                <div style="word-wrap: break-word;"> @Html.Raw(@MVC_TMED.Infrastructure.Utilities.FormatCustomerComment(@Model.listCustomFeed[fdd].PCC_Comment, 150)) </div>
                                <div style=" padding:5px 5px 1px 0px; ">
                                    <a href=@String.Format("{0}/{1}/{2}/feedback-{3}", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.featPack[fdd].CountryName.Replace(" ", "_").ToLower(), Model.featPack[fdd].PDL_Title.Replace(" ", "_").ToLower(), Model.featPack[fdd].PDLID)>
                                        Read more - See this traveler's itinerary
                                    </a>
                                </div>
                                <div style="padding:1px 5px 5px 0px;">Traveled on: @Model.listCustomFeed[fdd].dep_date.ToShortDateString() </div>
                            </div>

                        }
                    }

                </div>
                <div align="center" style="margin-bottom:10px"><img src="hhttps://pictures.tripmasters.com/siteassets/d/blue-ul-grad.jpg"></div>
                <div align="left" style="padding:5px 15px 20px 15px;" class="Text_12">
                    <a href=@String.Format("{0}/{1}/trips_taken_by_travelers", _appsettings.CurrentValue.ApplicationSettings.SiteName, Model.plcNA.Replace(" ", "_").ToLower())>
                        Browse feedback - @Model.plcNA
                    </a>
                </div>
            </div>



        }


        <!-- Suscribe -->
        <!-- need booking assistnce -->
        <div class="dvPopVac" style="margin-top:10px">

            <div style="padding:3px 10px 3px 10px;">
                <div class="BG_need">
                    <div class="Blue-Arial14" align="right" style="padding:10px 20px 5px 3px;">Need booking assistance?</div>
                    <div align="right" class="Text_12" style="padding:5px 15px 5px 3px;line-height:17px">
                        <b>We're glad to help:</b><br>
                        Call Us <b>7</b>  days a week<br />
                        from 8AM to Midnight ET<br />
                        <span class="Text_Arial16_navy"><b>1-800-430-0484</b></span>
                    </div>
                    <div align="right" class="Text_12" style="padding:5px 15px 5px 3px;"></div>
                </div>
            </div>
        </div>

        <!-- end -->

    </div>
    <br />
</center>
<div style="clear:both"></div>
<input name="featItin" type="hidden" id="featItin" value="@Model.featItin" />
<input name="otherFeat" type="hidden" id="otherFeat" value="@Model.otherFeat" />
<input type="hidden" name="allID" id="allID" value="" />
<input type="hidden" name="allNA" id="allNA" value="" />
<input name="inpWeiPacks" type="hidden" id="inpWeiPacks" value="" />
<input name="inpPacks" type="hidden" id="inpPacks" value="" />
<!-- end div suscriber options -->

@section Scripts
    {
    <environment include="Development">
        <script type="text/javascript" src="//static.criteo.net/js/ld/ld.js"></script>
        <script src="~/js/gpgp2/dt.java.gp2page.js" asp-append-version="true"></script>
        <script src="~/js/smallcalendar/dt.java.TM.Calendar.js" asp-append-version="true"></script>
        <script src="~/js/smallcalendar/dt.java.TM.CommonFunctions.js" asp-append-version="true"></script>
    </environment>
    <environment exclude="Development">
        <script type="text/javascript" src="//static.criteo.net/js/ld/ld.js"></script>
        <script src="~/js/gpgp2/dt.java.gp2page.min.js" asp-append-version="true"></script>
        <script src="~/js/smallcalendar/smallcalendar.min.js" asp-append-version="true"></script>
    </environment>
}
