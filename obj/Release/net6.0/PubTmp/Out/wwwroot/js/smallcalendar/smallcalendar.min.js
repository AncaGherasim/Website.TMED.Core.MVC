function dateByDest(){$("#qArrDate").datepicker("destroy");var n="";n=new Date(myDate.getTime()+6048e5);$("#qArrDate").datepicker({defaultDate:n,changeMonth:!1,changeYear:!1,numberOfMonths:1,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:n,maxDate:"+1Y",showOtherMonths:!1,beforeShow:function(){$(this).removeClass("errorClass")}})}function chcUnchk(n){$('input[id^="achk"]').each(function(){var t=this.id.replace("chk","");t!=n&&($("#"+t+"").hasClass("abRehChoChk")&&$("#"+t+"").removeClass("abRehChoChk"),this.checked&&$(this).trigger("click"),$("#"+t+"").parent().removeClass("spRehChoActiv"))})}function highlightText(n,t){for(var f=$.trim(n).toLowerCase(),i=t.get(0).firstChild,e,u,r;(e=i.data.toLowerCase().indexOf(f))>=0;)u=i.splitText(e),i=u.splitText(f.length),r=document.createElement("span"),r.className="highlight",i.parentNode.insertBefore(r,i),r.appendChild(u)}function doitDep(){$("#qLeaveNA").length>0&&($("#qLeaveNA").autocomplete({autoFocus:!0,source:depCities,minLength:3,response:function(n,t){if(t.content.length===0)return alert("No valid airport found"),!1},select:function(n,t){return $("#qLeaveNA").val(t.item.value),$("#qLeaveID").val(t.item.id),!1},close:function(n){if($("#"+n.target.id.replace("NA","ID")+"").val()=="-1"){var i=$(this).data("ui-autocomplete").menu.element[0].children[0],r=$(".ui-autocomplete"),u=r.val(),t=$(i).text();$("#"+this.id+"").val(t);$.map(depCities,function(i){$.each(i.label,function(){i.label==t&&$("#"+n.target.id.replace("NA","ID")+"").val(i.id)})})}}}).click(function(){$("#"+this.id.replace("NA","ID")+"").val("-1");$("#qLeaveNA").select().removeClass("errorClass");IsMobileDevice()?$("#qLeaveNA").val(""):$("#qLeaveNA").select()}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<a><\/a>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)},$("#qCabinTxt").autocomplete({autoFocus:!0,source:airCabin,minLength:0,select:function(n,t){return $("#qCabinTxt").val(t.item.label),$("#qCabin").val(t.item.id),$("#qWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()}),$("#goingTO, #goingFTO").autocomplete({autoFocus:!0,source:goingTojs,minLength:0,select:function(n,t){$("#goingTO, #goingFTO").val(t.item.label);$("#goingID, #goingFID").val(t.item.value);modifyDest(t.item.id);switch(t.item.id){case"TMAS":$("#aasia").trigger("click");break;case"TMLD":$("#alatin").trigger("click");break;case"TMED":$("#aeurope").trigger("click")}return $("#qWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()}))}function doitArr(){console.log("doitArr");$('input[id^="qNACity"]').each(function(){var n=""+this.id+"";$(this).autocomplete({autoFocus:!0,source:function(n,t){var i;n.term.length<4?i=new RegExp("^"+$.ui.autocomplete.escapeRegex(n.term),"i"):n.term.length>=4&&(i=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(n.term),"i"));t($.map(arrivalCities,function(n){if(i.test(n.value)||i.test(n.code))return n}))},minLength:3,response:function(t,i){if(i.content.length===0&&$("#"+n+"").val().length>=5)return $("#"+this.id.replace("NA","ID")+"").val("-1"),i.content.push({label:"No result found",value:""}),!1},select:function(n,t){$("#"+this.id+"").val(t.item.value).removeClass("errorClass");$("#"+this.id.replace("NA","ID")+"").val(t.item.id);$("#"+this.id.replace("NA","CO")+"").val(t.item.code);$("#"+this.id.replace("NA","API")+"").val(t.item.hotapi);var i=this.id.match(isNumber);return Number(i)===1&&$("#qgoingID, #xgoingID").val(t.item.dept),!1},close:function(t){var r=$("#"+t.target.id+"").val();if($("#"+n+"").val().length>=3&&$("#"+t.target.id.replace("NA","ID")+"").val()=="-1"){var u=$(this).data("ui-autocomplete").menu.element[0].children[0],f=$(".ui-autocomplete"),e=f.val(),i=$(u).text();$("#"+this.id+"").val(i.substring(0,i.indexOf("-")));i=="No result found"?($("#"+t.target.id.replace("NA","ID")+"").val("-1"),$("#"+t.target.id+"").val(r)):$.map(arrivalCities,function(n){$.each(n.label,function(){if(n.label==i){$("#"+t.target.id.replace("NA","ID")+"").val(n.id);$("#"+t.target.id.replace("NA","CO")+"").val(n.code);$("#"+t.target.id.replace("NA","API")+"").val(n.hotapi);var r=t.target.id.match(isNumber);Number(r)===1&&$("#qgoingID, #xgoingID").val(n.dept)}})})}}}).click(function(){$(this).select().removeClass("errorClass");$("#"+this.id.replace("NA","ID")+"").val("-1");IsMobileDevice()&&$(this).val("")}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightTextBYO(this.term,i),$("<li><\/li>").append(i).appendTo(n)}})}function highlightTextBYO(n,t){for(var f=$.trim(n).toLowerCase(),i=t.get(0).firstChild,e,u,r;(e=i.data.toLowerCase().indexOf(f))>=0;)u=i.splitText(e),i=u.splitText(f.length),r=document.createElement("span"),r.className="highlight",i.parentNode.insertBefore(r,i),r.appendChild(u)}function doitFArr(n){$("#qFNACity"+n+"").length>0&&($("#qFNACity"+n+"").autocomplete({autoFocus:!0,source:arrivalCities,minLength:3,response:function(n,t){if(t.content.length===0)return alert("No valid destination found to "+$("#goingFTO").val()+" \n\nPlease try again."),!1},select:function(t,i){return $("#qFNACity"+n+"").val(i.item.label),$("#qFIDCity"+n+"").val(i.item.id),!1}}).click(function(){if($("#goingFTO").val()=="")return popError("goingFTO","Please select a valid going to region !  <br> <a href=\"javascript:spanClick('goingFTO')\">OK<\/a>"),!1;IsMobileDevice()?$("#qFNACity"+n+"").val(""):$("#qFNACity"+n+"").select()}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<a><\/a>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)})}function qaddCity(n,t){var r,u,i,f,e,o;if(t>12)return alert("For best results, no more than 12 cities is allowed. Thanks."),!1;if(t<=12){i="";r=jscal==="B"?"dvbCalLineConteiner":"dvbCalSmallConteiner";u=jscal==="B"?"spRemove":"spSmallRemove";switch(BorF){case"BYO":i=document.querySelector(".template-Calendar")?"<!-- city  "+t+' -->\t\t\t<div class="mar-bot" style="display: flex;align-items: center;position: relative;" id="dvCity'+t+'">\t\t\t<div class="flex-column input5">\t\t\t<input class="form-input" name="qNACity'+t+'" type="text" id="qNACity'+t+'" value="US city or airport"/>\t\t\t<input name="qIDCity'+t+'" type="hidden" id="qIDCity'+t+'" value="-1"/>\t\t\t<input name="qCOCity'+t+'" type="hidden" id="qCOCity'+t+'" value=""/>\t\t\t<input name="qAPICity'+t+'" type="hidden" id="qAPICity'+t+'" value=""/>\t\t\t<\/div>\t\t\t<span class="btnRemove desk" id="spRemove'+t+'" onClick="qDelCty('+t+')">Remove City<\/span>            <span class="btnRemove mobile" id="spRemove'+t+'" onClick="qDelCty('+t+')">&#10006;<\/span>\t\t\t<div class="flex-column input4 input-arrow">            <select class="select-css form-input" name="qSTCity'+t+'" id="qSTCity'+t+'">            <option value="1"> 1 nights <\/option>            <option value="2"> 2 nights <\/option>            <option value="3" selected> 3 nights <\/option>            <option value="4"> 4 nights <\/option>            <option value="5"> 5 nights <\/option>            <option value="6"> 6 nights <\/option>            <option value="7"> 7 nights <\/option>            <option value="8"> 8 nights <\/option>            <option value="9"> 9 nights <\/option>            <option value="10"> 10 nights <\/option>            <option value="11"> 11 nights <\/option>            <option value="12"> 12 nights <\/option>            <option value="13"> 13 nights <\/option>            <option value="14"> 14 nights <\/option>            <\/select>\t\t\t<\/div>\t\t\t<br style="clear:both"/>\t\t\t<\/div><!-- end city '+t+" -->":"<!-- city  "+t+' -->\t\t\t<div class="'+r+'" id="dvCity'+t+'">\t\t\t<div>\t\t\t<input name="qNACity'+t+'" type="text" id="qNACity'+t+'" value="type city name here"/>\t\t\t<input name="qIDCity'+t+'" type="hidden" id="qIDCity'+t+'" value="-1"/>\t\t\t<input name="qCOCity'+t+'" type="hidden" id="qCOCity'+t+'" value=""/>\t\t\t<input name="qAPICity'+t+'" type="hidden" id="qAPICity'+t+'" value=""/>\t\t\t<\/div>\t\t\t<div >\t\t\t<span class="'+u+'" id="spRemove'+t+'" onClick="qDelCty('+t+')">Remove City<\/span>\t\t\t<\/div>\t\t\t<div >            <select class="select-css select-css-stay" name="qSTCity'+t+'" id="qSTCity'+t+'">            <option value="1"> 1 nights <\/option>            <option value="2"> 2 nights <\/option>            <option value="3" selected> 3 nights <\/option>            <option value="4"> 4 nights <\/option>            <option value="5"> 5 nights <\/option>            <option value="6"> 6 nights <\/option>            <option value="7"> 7 nights <\/option>            <option value="8"> 8 nights <\/option>            <option value="9"> 9 nights <\/option>            <option value="10"> 10 nights <\/option>            <option value="11"> 11 nights <\/option>            <option value="12"> 12 nights <\/option>            <option value="13"> 13 nights <\/option>            <option value="14"> 14 nights <\/option>            <\/select>\t\t\t<\/div>\t\t\t<br style="clear:both"/>\t\t\t<\/div><!-- end city '+t+" -->";f=$("#dvCity"+n);$(i).insertAfter(f);doitArr();break;case"FIND":e="<!-- city  "+t+' -->\t\t\t<div class="dvbCalLineConteiner" id="dvFCity'+t+'">\t\t\t<div>\t\t\t<input type="text" name="qFNACity'+t+'" id="qFNACity'+t+'" value="type city name here"/>\t\t\t<input name="qFIDCity'+t+'" type="hidden" id="qFIDCity'+t+'" value="-1"/>\t\t\t<\/div>\t\t\t<div >\t\t\t<span class="spRemove" id="spFRemove'+t+'" onClick="qDelCty('+t+')">Remove City<\/span>\t\t\t<\/div>\t\t\t<br style="clear:both"/>\t\t\t<\/div><!-- end city '+t+" -->";o=$("#dvFCity"+n);$(e).insertAfter(o);doitFArr(t)}}}function insertAfter(n,t){n.parentNode.insertBefore(t,n.nextSibling)}function countElement(n){var t,i;for(d=1;d<=12;d++)i=document.getElementById(n+d),i?t=d:d=13;return t}function qDelCty(n){var f,e,r,u,t;switch(BorF){case"BYO":for(r=n+1,u=IsMobileDevice()!=null||identifyBrowser().indexOf("Firefox")>0?countElement("dvCity"):$('div[id*="dvCity"').length,$("#dvCity"+n+"").remove(),i=r;i<=u;i++)$("#dvCity"+i+"").length>0&&(t=i-1,$("#dvCity"+i+"").attr("id","dvCity"+t+""),$("#qNACity"+i+"").attr("name","qNACity"+t+""),$("#qNACity"+i+"").attr("id","qNACity"+t+""),$("#qIDCity"+i+"").attr("name","qIDCity"+t+""),$("#qIDCity"+i+"").attr("id","qIDCity"+t+""),$("#spRemove"+i+"").attr("onClick","qDelCty("+t+");"),$("#spRemove"+i+"").attr("id","spRemove"+t+""),$("#qSTCity"+i+"Txt").attr("name","qSTCity"+t+"Txt"),$("#qSTCity"+i+"Txt").attr("id","qSTCity"+t+"Txt"),$("#qSTCity"+i+"").attr("name","qSTCity"+t+""),$("#qSTCity"+i+"").attr("id","qSTCity"+t+""),doitArr(t));break;case"FIND":for(r=n+1,u=IsMobileDevice()!=null||identifyBrowser().indexOf("Firefox")>0?countElement("dvFCity"):$('div[id*="dvFCity"').length,$("#dvFCity"+n+"").remove(),i=r;i<=u;i++)$("#dvFCity"+i+"").length>0&&(t=i-1,$("#dvFCity"+i+"").attr("id","dvFCity"+t+""),$("#qFNACity"+i+"").attr("name","qFNACity"+t+""),$("#qFNACity"+i+"").attr("id","qFNACity"+t+""),$("#qFIDCity"+i+"").attr("name","qFIDCity"+t+""),$("#qFIDCity"+i+"").attr("id","qFIDCity"+t+""),$("#spFRemove"+i+"").attr("onClick","qDelCty("+t+");"),$("#spFRemove"+i+"").attr("id","spFRemove"+t+""),doitFArr(t))}}function validateFIND(){var n;if(window.scrollTo(0,0),howManyhas=IsMobileDevice()!=null||identifyBrowser().indexOf("Firefox")>0?countElement("dvFCity"):$('div[id*="dvFCity"]').length,$("#goingFTO").val()==""){var t="goingFTO",i="'goingFTO'",r='Please select a valid going to region !  <br> <a href="javascript:spanClick('+i+')">OK<\/a>';return popError(t,r),!1}for(y=1;y<=howManyhas;y++)if(n=$("#qFIDCity"+y+"").val(),n==-1||n==""){var t="qFNACity"+y,i="'qFNACity"+y+"'",r='Please select a valid destination !  <br> <a href="javascript:spanClick('+i+')">OK<\/a>';return popError(t,r),!1}findCombination()}function popError(n,t){$("#dvErrMess").html('<img src="https://pictures.tripmasters.com/siteassets/d/Symbols-Warning-icon-32.gif" width="32" height="32" align="absmiddle" style="padding-top:5px;" /> '+t+"");var i=$("#"+n+"").offset(),r=i.left+10,u=i.top-80;$("#dvError").attr("style","position:absolute; display:none; z-index:9999; left:"+r+"px; top:"+u+"px; width:auto;");$("#dvError").fadeIn(100)}function spanClick(n){$("#dvError").hide();IsMobileDevice()&&$("#"+n+"").val("");n=="qArrDate"?$("#"+n+"").datepicker("show"):n.indexOf("going")>-1?$("#"+n+"").focus():n.indexOf("xtxtNoOfNts")>-1?$("#"+n+"").focus():$("#"+n+"").trigger("click")}function CO_showBg(){maskHeight=$(document).height();$dvMask.css({height:maskHeight});$dvMask.show();$dvOptions.html('<div class="dvCalContainer" style="width:600px; height:200px;background: #fff !important; box-shadow: inset 0 0 10px #648ad1 !important; border: 1px solid #648ad1 !important;"><div style="margin:80px 180px; "><img src="https://pictures.tripmasters.com/siteassets/d/loader.gif"><\/div><\/div>');$dvTransOptResp.dvScroolWait();$dvTransOptResp.show()}function CO_hideBg(){$dvMask.hide()}function startOver(){$dvTransOptResp.hide();$dvOptions.html();CO_hideBg()}function hiddenDiv(){$dvTransOptResp.hide();$dvOptions.html();CO_hideBg()}function findCombination(){var i,r,f,n,u,t;$('input[id^="qFNACity"]').each(function(){f=this.id.match(isNumber);n=$("#"+this.id+"").val();n.indexOf("(")>-1&&(n=n.substring(0,n.indexOf("(")-1));f==1?(i=n,r=$("#"+this.id.replace("NA","ID")+"").val()):(i+="_"+n,r+=","+$("#"+this.id.replace("NA","ID")+"").val())});u="";u=$("#goingFID").val();t="";switch(u){case"TMED":case"ED":t="europe";break;case"TMLD":case"LD":t="latin";break;case"TMAS":t="asia"}$("#allID").val(r);$("#allNA").val(i);document.FormFIND.action="http://www.tripmasters.com/"+t+"/"+i+"/find-packages";document.FormFIND.submit()}function getCookie(n){return document.cookie.length>0&&(c_start=document.cookie.indexOf(n+"="),c_start!=-1)?(c_start=c_start+n.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):null}function setCookie(n,t,i){var r=new Date;r.setTime(r.getTime()+i*864e5);document.cookie=n+"="+escape(t)+(i==null?"":";expires="+r.toGMTString())}function byoValidation(){if($("input[name='qWair']:checked").val()=="True"&&($("#qLeaveID").val()==-1||$("#qLeaveID").val()==""))return errorAlert("qLeaveNA","Select a valid city or airport"),!1;if(/\//.test($("#qArrDate").val())==!1)return errorAlert("qArrDate","Date is not valid"),!1;var n=0;$('form#formBYO input[id^="qIDCity"]').each(function(){this.value=="-1"&&$("#"+this.id.replace("ID","NA")+"").val()=="City or airport"?(errorAlert(this.id.replace("ID","NA"),"Select a valid city or airport"),n-=1):this.value=="-1"&&(errorAlert(this.id.replace("ID","NA"),$("#"+this.id.replace("ID","NA")+"").val()),n-=1);n+=1;n===$('form#formBYO input[id^="qIDCity"]').length?submitFormT4("formBYO"):""})}function submitFormT4(n){var u=document.querySelector(".template-Calendar"),r,i,t;$("#myModal").slideDown(function(){if(u)$(".dvTransportation").show();else{var n=$noMore.offset(),t=($(window).width()-$(".dvTransportation").outerWidth())/2;$(".dvTransportation").show().offset({top:n.top+40,left:t});$(window).scrollTop(n.top+20)}});r="";r=JSON.stringify($("#formBYO").serializeObject());Cookies.set("backCookieTMED",r,{expires:1});i="";i=$("#"+n+"").serialize();console.log("stringForm = ");console.log(i);t={};t.url=SiteName+"/Api/Packages/webservTransportationOption";t.type="POST";t.contentType="application/json";t.data=JSON.stringify(i);t.dataType="json";t.success=function(n){console.log("/Api/Packages/webservTransportationOption succes: ");console.log(n);cityData=n.Cities;console.log("cityData: ");console.log(cityData);buildTransportationFrom()};t.error=function(n){console.log(n)};$.ajax(t)}function length(n){return Object.keys(n).length}function buildTransportationFrom(){var n;$(".dvSpin").hide();$(".dvtranspByoCalTools").show();n=JSON.parse(Cookies.get("backCookieTMED"));console.log("cookSaved = ");console.log(n);$("#xaddFlight").val(n.qWair);n.qWair==="True"?($('span:contains("With Air")').addClass("spselect"),$('span:contains("Without")').removeClass("spselect"),$(".dvtranspAirParam").show()):"";n.qWair==="False"?($('span:contains("Without")').addClass("spselect"),$('span:contains("With Air")').removeClass("spselect"),$(".dvtranspAirParam").hide()):"";$("#xLeaveCO").val(n.qLeaveNA);$("#xtxtLeavingFrom").val(n.qLeaveNA);$("#xidLeavingFrom").val(n.qLeaveID);$("#xtxtBYArriving").val($("#qArrDate").val());$('#xCabin option[value="'+n.qCabinOpt+'"]').attr("selected","selected");$("#xgoingID").val(n.qgoingID);var i=[],t="",r=0,u=0,f=length(n)-1;$.each(n,function(n,e){n.match(/\d+/g)!=null&&(r!=n.match(/\d+/g)&&(r=Number(n.match(/\d+/g)),r>1?(i.push(t),t=""):"",t=t+n.match(isNumber)+"@"+e),/qNACity/.test(n)===!1?t=t+"@"+e:"");u++;u===f?(i.push(t),t="",buildTransportationTo(i),dvTrans=""):""})}function buildTransportationTo(n){var r,u;console.log("buildTransportationTo "+n);try{var t="",f=cityData.length;if(f===undefined){for(console.log("totCtys === undefined"),r=JSON.parse(JSON.stringify(cityData)),u=n[0].split("@"),t=t+'<div id="cityTo'+r.No+'" class="dvtranspCityList"><!-- City Name / '+this.No+" /--><div><span>"+r.No+". <b>"+decodeURIComponent(r.PlaceName)+'<\/b><\/span><input type="hidden" id="xNOCity'+r.No+'" name="xNOCity'+r.No+'" value="'+r.No+'" /><input name="xNACity'+r.No+'" type="hidden" id="xNACity'+r.No+'" value="'+decodeURIComponent(r.PlaceName)+'"/><input type="hidden" name="xIDCity'+r.No+'"  id="xIDCity'+r.No+'" value="'+r.PlaceID+'"  /><input name="xCOCitx'+r.No+'" type="hidden" id="xCOCitx'+r.No+'" value="'+u[3].trim()+'"/><input name="xAPICity'+r.No+'" type="hidden" id="xAPICity'+r.No+'" value="'+decodeURIComponent(u[4]).trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span>',t=this.No==="1"?t+"<b>"+$("#qArrDate").val()+"<\/b>":t+'<span class="sptranspRemoveCity goToStartAgain">Edit/Remove<\/span>',t=t+'<\/span><\/div><!-- Staying for --><div> <span><select name="xSTCity'+r.No+'" id="xSTCity'+r.No+'" class="select-css select-css-stayT">',i=1;i<=14;i++)t=i==u[5]?t+'<option value="'+i+'" selected>'+i+" nights<\/option>":t+'<option value="'+i+'">'+i+" nights<\/option>";t=t+'<\/select><\/span><\/div><br style="clear:both;"><\/div>';console.log("dvCities = "+t)}else console.log("totCtys != undefined"),$.each(cityData,function(){var h=findNextCity(this.PlaceToID),l,y,w,b,p,v,s,c,u;if(isNaN(Number(this.No))===!0){if(this.No==="S"){if(l=n[0].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList" style="margin:0"><!-- City Name / S /--><div><span><font size="3">&#8224;<\/font> Must arrive to <b>'+this.PlaceName+'<\/b> <\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+this.PlaceName+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+l[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+decodeURIComponent(l[4]).trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span><\/span><\/div><!-- Staying for --><div> <span><input type="hidden" id="xSTCity'+this.No+'" name="xSTCity'+this.No+'" value="0"/><\/span><\/div><div>',this.Options!==null){var u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+this.No+'">',r=this.No,o=this.Options,s="ptranspSelAct",a=1;t=t+"<!-- Transport options -->";o.Ranking===undefined?$.each(o,function(){var n,i;this.Ranking===1?(t=t+'<input name="xFIELDCityS" type="hidden" id="xFIELDCityS" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCityS" type="hidden" id="xTRANSCityS" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCityS" name="xOVNCityS" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to $$"+l[1]:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span><\/p>',a++);this.ProductType==="C"&&(n='style="display:none"',this.Ranking===1?n='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+n+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'" class="select-css"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'" class="select-css"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity select-css" data-city="'+r+'">',this.CarDropOff.DOCity.DOPlaceNo!==undefined?u=u+'<option value="'+this.CarDropOff.DOCity.DOPlaceNo+'">'+decodeURIComponent(this.CarDropOff.DOCity.DOPlaceNo)+". "+decodeURIComponent(this.CarDropOff.DOCity.DOPlaceName)+"<\/option>":(i=this.CarDropOff.DOCity,$.each(i,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')}):(o.Ranking===1&&(t=t+'<input name="xFIELDCityS" type="hidden" id="xFIELDCityS" value="'+o.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCityS" type="hidden" id="xTRANSCityS" value="'+o.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCityS" name="xOVNCityS" value="'+o.Overnight+'"/>',e=e+'<input data-type="'+o.ProductType+'" data-field="'+o.ProductFreeField1+'" data-ovrnts="'+o.Overnight+'" data-rank="'+o.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+o.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+o.Ranking+'" class="'+s+'"><span><b>'+o.ProductTypeName+"<\/b>",o.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"),o.ProductType==="C"&&(y='style="display:none"',o.Ranking===1?y='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+y+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'" class="select-css"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'" class="select-css"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity select-css" data-city="'+r+'" >',o.CarDropOff.DOCity.DOPlaceNo!==undefined?u=u+'<option value="'+o.CarDropOff.DOCity.DOPlaceNo+'">'+o.CarDropOff.DOCity.DOPlaceNo+". "+decodeURIComponent(o.CarDropOff.DOCity.DOPlaceName)+"<\/option>":(w=o.CarDropOff.DOCity,$.each(w,function(){u=u+'<option value="'+o.DOPlaceNo+'">'+o.DOPlaceNo+". "+decodeURIComponent(o.DOPlaceName)+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>'),a=1);u=u+'<p id="pTranspSel'+r+"-"+Number(a+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(a+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';t=t+e+"<\/p>"+u}t=t+'<\/div><br style="clear:both;"><\/div>'}this.No==="E"&&(b=Number(n.length-1),p=n[b].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList"><!-- City Name / E /--><div><span><font size="3">&raquo;<\/font> Must depart from <b>'+this.PlaceName+'<\/b> <\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+this.PlaceName+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+p[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+decodeURIComponent(p[4]).trim()+'"/><input type="hidden" id="xSTCity'+this.No+'" name="xSTCity'+this.No+'" value="0"/><input type="hidden" id="xOVNCity'+this.No+'" name="xOVNCity'+this.No+'" value="0"/><\/div><!-- Date / Edit-Remove --><div><span><\/span><\/div><!-- Staying for --><div> <span><\/span><\/div><br style="clear:both;"><\/div>')}else{for(v=n[Number(this.No-1)].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList"><!-- City Name / '+this.No+" /--><div><span>"+this.No+". <b>"+decodeURIComponent(this.PlaceName)+'<\/b><\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+decodeURIComponent(this.PlaceName)+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+v[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+decodeURIComponent(v[4]).trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span>',t=this.No==="1"?t+"<b>"+$("#qArrDate").val()+"<\/b>":t+'<span class="sptranspRemoveCity goToStartAgain">Edit/Remove<\/span>',t=t+'<\/span><\/div><!-- Staying for --><div> <span><select name="xSTCity'+this.No+'" id="xSTCity'+this.No+'" class="select-css select-css-stayT">',i=1;i<=14;i++)t=i==v[5]?t+'<option value="'+i+'" selected>'+i+" nights<\/option>":t+'<option value="'+i+'">'+i+" nights<\/option>";if(t=t+"<\/select><\/span><\/div><div>",s="ptranspSelAct",c=1,this.Options!==null){var r=this.No,u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+this.No+'">',k=this.Options;if(this.Options[0].Ranking!==undefined)$.each(k,function(){var i,n;this.Ranking===1?(t=t+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',c++);this.ProductType==="C"&&(i='style="display:none"',this.Ranking===1?i='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+i+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'" class="select-css"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'" class="select-css"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity select-css" data-city="'+r+'">',this.CarDropOff!==null?(n=this.CarDropOff.DOCity,$.each(n,function(){this.Ranking===1&&(DropOffEndCity=this.DOPlaceNo,DropOffStartCity=r);u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})):(n=this.CarDropOff.DOCity,this.Ranking===1&&(DropOffEndCity=n[0].DOPlaceNo,DropOffStartCity=r),$.each(n,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName.replace(/\+/g," "))+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')}),u=u+'<p id="pTranspSel'+r+"-"+Number(c+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(c+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>',t=t+e+"<\/p>"+u;else{c=1;var o=this.Options,u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+r+'">',s="ptranspSelAct";$.each(o,function(){var n,i;this.Ranking===1?(t=t+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',c++);this.ProductType==="C"&&(n='style="display:none"',this.Ranking===1?n='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+n+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'" class="select-css"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'" class="select-css"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'" class="select-css"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity select-css" data-city="'+r+'">',this.CarDropOff.DOCity.DOPlaceNo!==undefined?(u=u+'<option value="'+this.CarDropOff.DOCity.DOPlaceNo+'">'+this.CarDropOff.DOCity.DOPlaceNo+". "+decodeURIComponent(this.CarDropOff.DOCity.DOPlaceName.replace(/\+/g," "))+"<\/option>",this.Ranking===1&&(DropOffEndCity=this.CarDropOff.DOCity.DOPlaceNo,DropOffStartCity=r)):(i=this.CarDropOff.DOCity,this.Ranking===1&&(DropOffEndCity=i[0].DOPlaceNo,DropOffStartCity=r),$.each(i,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')});u=u+'<p id="pTranspSel'+r+"-"+Number(c+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(c+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';t=t+e+"<\/p>"+u}}else if(this.No<f&&h!=""){var r=this.No,s="ptranspSelAct",e="<!-- Checkboxes for trasnsport options -->";e=e+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="OWN"/>';e=e+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="W"/>';e=e+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="0"/><p class="ptranspCheck" id="pCheckBox'+r+'"><input data-type="OWN" data-field="W" data-ovrnts="0" data-rank="1" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';u='<!-- Trasport option selected label --><p id="pTranspSel'+r+'-1" class="'+s+'"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';t=t+e+u}t=t+"<\/div>";t=t+'<br style="clear:both"/>';t=t+"<\/div>"}});$("#dvWaitGlobe").html("").hide();$(".dvtranspMainContainer").show();$("#dvTranspError").hide();$(t).insertAfter(".dvtranspLabels");$(".buttontranspChange").click(function(){changeTranspOption(this)});$(".selectDropOffCity").change(function(){carSelected($(this).data("city"))});$(".checkBox").click(function(){modifyTransportation(this,this.value)});$(".goToStartAgain").click(function(){startAgain(this)});t="";checkIfCarIsFirst()}catch(e){buildTransportationError(e.message)}}function buildTransportationError(n){$(".goToStartAgain").click(function(){startAgain(this)});var i=JSON.parse(Cookies.get("backCookieTMED")),r=0,u=Object.keys(i).length,t="";jQuery.each(i,function(i,f){/qNACity/.test(i)===!0?t=t+"<li>"+f+"<\/li>":"";r+=1;r===u?(Cookies.set("backCookieTMED","",{expires:-1}),$("#sptrancities").html(t),$("#perrorCode").html(n),$(".dvWaitGlobe").hide(),$(".dvtranspMainContainer").hide(),$("#dvTranspError").show()):""})}function checkIfCarIsFirst(){$(".checkBox").each(function(){$(this).data("rank")===1?$(this).data("type")==="C"?$(this).is(":checked")?carSelected(this.id.match(isNumber)):"":"":""})}function cookieCheck(){selectRoomPax("1|2");backCookie=Cookies.get("backCookieTMED");backCookie!==undefined?(haveCook=1,buildFromCook(1),doitArr()):(haveCook=0,dateByDest(),doitArr())}function buildFromCook(n){var t=JSON.parse(Cookies.get("backCookieTMED")),i=0,u=Object.keys(t).length,r,f=$noMore.offset();n===1&&$.each(t,function(n,t){n==="qWair"?t==="False"?$("#spWout").trigger("click"):$("#spWair").trigger("click"):"";/qNACity/.test(n)===!0?(n.match(isNumber)>1?$addCty.trigger("click"):"",$("#"+n+"").val(t)):"";/qIDCity|qSTCity|qCOCity|qAPICity|qLeave|qArrDate/.test(n)===!0?$("#"+n+"").val(t):"";/qgoingID/.test(n)===!0?($("#"+n+"").val(t),r=t):"";i+=1;i===u?(Cookies.set("backCookieTMED","",{expires:-1}),dateByDest(r),$(window).scrollTop(f.top-200)):""})}function selectRoomPax(n){var t=n.split("|");$("#xiRoom").val(t[0]);$("#xRooms").val(t[0]);/Other/.test(n)===!0?(openRoom(t[0],1),$("#xiAdults").val(0)):(openRoom(t[0],0),$('#xiAdults option[value="'+t[1]+'"').attr("selected","selected"),otherCleanRoom())}function openRoom(n,t){t===0?$(".dvtranspAdultChild, #pPaxLabels").slideUp("fast"):$(".dvtranspAdultChild, #pPaxLabels").slideDown("fast");$('p[id^="pRoom"]').each(function(){this.id.match(isNumber)<=n?$(this).slideDown("slow"):($(this).slideUp("slow"),cleanRoom(this))})}function cleanRoom(n){$("#"+n.id+" select").each(function(){/_iAdults/.test(this.id)===!0?$("#"+this.id+"").val(0):/iChildren/.test("#"+this.id+"")===!0?$(this).val(0):/iChild/g.test(this.id)===!0?$("#"+this.id+"").val(-1):""})}function otherCleanRoom(){$('select[id*="iChild"]').each(function(){/iChildren/.test(this.id)===!0?$("#"+this.id+' option[value="0"]').attr("selected","selected"):"";/iChild/g.test(this.id)===!0?$("#"+this.id+' option[value="-1"]').attr("selected","selected"):""})}function changeTranspOption(n){$('p[id^="pTranspSel'+n.id+'"]').each(function(){this.className==="ptranspSelAct"?$(this).attr("class","ptranspSelNoAct"):""});$("#pCheckBox"+n.id+"").show()}function modifyTransportation(n,t){$("#xFIELDCity"+t+"").val($(n).data("field"));$("#xTRANSCity"+t+"").val($(n).data("type"));$("#xOVNCity"+t+"").val($(n).data("ovrnts"));$("#pCheckBox"+t+"").hide();$("#pTranspSel"+t+"-"+$(n).data("rank")+"").attr("class","ptranspSelAct");$(n).data("type")==="C"?($("#carOptions"+t+"").show(),carSelected(t)):($("#carOptions"+t+"").hide(),carNoSelected(t))}function carNoSelected(n){var i=$(".dvtranspCityList").length,r=n,u,f,t;for(r==="S"?(r=1,i=Number(i)-1):r=Number(r)+1,u=$("#xdropoffCity"+n+"").val(),u==="E"?$("#cityToS").length===1?(u=$(".dvtranspCityList").length-1,i=Number(i)-1):u=i:"",f=0,t=r;t<=i;t++)$("#xFIELDCity"+t+"").val($("#xradioTrans"+t+'[data-rank="1"]').data("field")),$('p[id^="pTranspSel'+t+"-1").attr("class","ptranspSelAct"),$("#xFIELDCity"+t+"").val()==="TBA"?($("#carOptions"+t+"").show(),t++):""}function carSelected(n){var i=$(".dvtranspCityList").length,u=n,r,f,t;for(u==="S"?(u=1,i=Number(i)-1):u=Number(u)+1,r=$("#xdropoffCity"+n+"").val(),r==="E"?$("#cityToS").length===1?(r=$(".dvtranspCityList").length-1,i=Number(i)-1):r=i:"",f=0,t=u;t<=i;t++)t<r?($("#xFIELDCity"+t+"").val(""),$('p[id^="pTranspSel'+t+"").attr("class","ptranspSelNoAct"),$("#carOptions"+t+"").is(":visible")===!0?$($("#carOptions"+t+"").hide()):""):"",t>=r?($("#xFIELDCity"+t+"").val($("#xradioTrans"+t+'[data-rank="1"]').data("field")),$('p[id^="pTranspSel'+t+"-1").attr("class","ptranspSelAct"),$("#xFIELDCity"+t+"").val()==="TBA"?($("#carOptions"+t+"").show(),t++):""):""}function startAgain(n){var t=n.innerHTML;switch(!0){case/Without/.test(t):$("#spWout").find("#qWair").trigger("click");break;case/With Air/.test(t):$("#spWair").find("#qWair").trigger("click")}$("#myModal").slideUp();$(".dvTransportation").hide().removeAttr("style");$(".dvMask").hide().removeAttr("height");$("div.dvtranspCityList").remove();$("div.dvtranspCityList").remove();$("#dvTranspError").hide();$(".dvtranspByoCalTools").hide();$(".dvSpin").show()}function submitPrice(){console.log("submitPrice");var n=countPax(1);if(childValidAge()){if(n>6)return alert("Max guest allowed (adults + children) are 6 !"),$(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1;if(n===!1)return $(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1;submitCompList()}else return alert("Child age is empty"),$(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1}function childValidAge(){var n=!0;return $("#pRoom1").is(":visible")===!0?($('#pRoom1 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)}),$("#pRoom2").is(":visible")===!0&&($(' #pRoom2 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)}),$("#pRoom3").is(":visible")===!0&&$('#pRoom3 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)})),n):n}function submitCompList(){var i=!1,r,t,u,n;if($("#frmTransp div[id^='cityTo']").each(function(){var t;if(!isNaN(parseInt($(this).attr("id").replace("cityTo","")))){var r=$(this).find("div input[id^='xIDCity']").val(),n=findNextCity(r),u=$(this).find("div input[id^='xNACity']").val();if(n=="")return $(this).find("div input[id^='xNACity']").val(n),startAgain(this),t=$(this).attr("id"),varIdCity="qNACity"+getNumericPart(t),$("#formBYO input[id='"+varIdCity+"']").val("Select city or airport"),$("#formBYO input[id='"+varIdCity.replace("NA","ID")+"']").val(-1),i=!0,!1;n!=u&&$(this).find("div input[id^='xNACity']").val(n)}}),i===!0){$(".btnContinue").click(function(n){submitPrice();$(this).off(n)});byoValidation();return}t=$("#frmTransp").serialize();console.log(t);u=QueryStringToJSON(t);n={};n.url=SiteName+"/Api/Packages/webservComponentList";n.type="POST";n.contentType="application/json";n.data=JSON.stringify(t);n.dataType="json";n.success=function(n){console.log("Api/Packages/webservComponentList: ");console.log(n);r=n;submitToBP(u,r)};n.error=function(n){console.log(n)};$.ajax(n)}function submitToBP(n,t){var o,e,f;console.log("submitToBP strQ = ");console.log(n);console.log("submitToBP jsR = ");console.log(t);o='<div style="background:white; width:95%; margin:0 auto"><img src="https://pictures.tripmasters.com/siteassets/m/SearchingAH.gif" style="width:100%; height:100%"/><\/div>';$(".dvMMask").append(o).show();var r=t.split("@|@"),s=$("#formToBooking"),h="xIDcity"+r[11],u="";if(console.log("strQ.xiChildren = "+n.xiChildren),r[1]==="1")for(s.find("input").each(function(){/SystemID/.test(this.id)?this.value=r[2]:"";/PackageComponentList/.test(this.id)?this.value=r[0]:"";/ByStayNite/.test(this.id)?this.value=r[3]:"";/GetNextDay/.test(this.id)?this.value=r[4]:"";/AirVendorAPI/.test(this.id)?this.value=r[5]:"";/AirP2PVendorAPI/.test(this.id)?this.value=r[6]:"";/CarVendorAPI/.test(this.id)?this.value=r[7]:"";/SSVendorAPI/.test(this.id)?this.value=r[8]:"";/TransferVendorAPI/.test(this.id)?this.value=r[9]:"";/TICVendorAPI/.test(this.id)?this.value=r[10]:"";bookingurl=r[12];/addFlight/.test(this.id)?this.value=n.xaddFlight:"";/Cabin/.test(this.id)?this.value=n.xCabin:"";/iDepCity|iRetCity/.test(this.id)?this.value=n.xidLeavingFrom:"";/StayCityS/.test(this.id)?this.value=n.xNOCityS?n.xIDCityS:n.xIDCity1:"";/StayCityS_Name/.test(this.id)?this.value=n.xNOCityS?decodeURIComponent(n.xNACityS):decodeURIComponent(n.xNACity1):"";/StayCityE/.test(this.id)?this.value=n.xNoCityE?n.xIDcityE:n["xIDCity"+r[11]]:"";/StayCityE_Name/.test(this.id)?this.value=n.xNoCityE?decodeURIComponent(n.xNAcityE):decodeURIComponent(n["xNACity"+r[11]]):"";/Rooms/.test(this.id)?(this.value=n.xRooms,$("#xRooms").val("1")):"";/iRoom/.test(this.id)?(this.value=n.xiRoom,$("#xiRooms").val("1")):"";/iRoomsAndPax/.test(this.id)?(this.value=decodeURIComponent(n.xiRoomsAndPax),$("#xcabinRoomPax").val("1 Room, 2 Travelers, Economy"),$("#xiRoomsAndPax").val("1|2")):"";/iAdults/.test(this.id)?/Room/.test(this.id)?"":(this.value=n.xiAdults,$("xiAdults").val("2")):"";/iChildren/.test(this.id)?/Room/.test(this.id)?"":(this.value=n.xiChildren,$("xiChildren").val("")):"";/iChild1/.test(this.id)?/Room/.test(this.id)?"":n.xiChild1?(this.value=n.xiChild1,$("xiChild1").val("")):"":"";/iChild2/.test(this.id)?/Room/.test(this.id)?"":n.xiChild2?(this.value=n.xiChild2,$("xiChild2").val("")):"":"";/iChild3/.test(this.id)?/Room/.test(this.id)?"":n.xiChild3?(this.value=n.xiChild3,$("xiChild3").val("")):"":"";/iChild4/.test(this.id)?/Room/.test(this.id)?"":n.xiChild4?(this.value=n.xiChild4,$("xiChild4").val("")):"":"";/Room2_iAdults/.test(this.id)?n.xRoom2_iAdults?(this.value=n.xRoom2_iAdults,$("xRoom2_iAdults").val("")):this.value="":"";/Room2_iChildren/.test(this.id)?n.xRoom2_iChildren?(this.value=n.xRoom2_iChildren,$("xRoom2_iChildren").val("")):this.value="":"";/Room2_iChild1/.test(this.id)?n.xRoom2_iChild1?(this.value=n.xRoom2_iChild1,$("xRoom2_iChild1").val("")):this.value="":"";/Room2_iChild2/.test(this.id)?n.xRoom2_iChild2?(this.value=n.xRoom2_iChild2,$("xRoom2_iChild2").val("")):this.value="":"";/Room2_iChild3/.test(this.id)?n.xRoom2_iChild3?(this.value=n.xRoom2_iChild3,$("xRoom2_iChild3").val("")):this.value="":"";/Room2_iChild4/.test(this.id)?n.xRoom2_iChild4?(this.value=n.xRoom2_iChild4,$("xRoom2_iChild4").val("")):this.value="":"";/Room3_iAdults/.test(this.id)?n.xRoom3_iAdults?(this.value=n.xRoom3_iAdults,$("xRoom3_iAdults").val("")):this.value="":"";/Room3_iChildren/.test(this.id)?n.xRoom3_iChildren?(this.value=n.xRoom3_iChildren,$("xRoom3_iChildren").val("")):this.value="":"";/Room3_iChild1/.test(this.id)?n.xRoom3_iChild1?(this.value=n.xRoom3_iChild1,$("xRoom3_iChild1").val("")):this.value="":"";/Room3_iChild2/.test(this.id)?n.xRoom3_iChild2?(this.value=n.xRoom3_iChild2,$("xRoom3_iChild2").val("")):this.value="":"";/Room3_iChild3/.test(this.id)?n.xRoom3_iChild3?(this.value=n.xRoom3_iChild3,$("xRoom3_iChild3").val("")):this.value="":"";/Room3_iChild4/.test(this.id)?n.xRoom3_iChild4?(this.value=n.xRoom3_iChild4,$("xRoom3_iChild4").val("")):this.value="":""}),i=1;i<=12;i++)n["xIDCity"+i]?(f=decodeURIComponent(n["xNACity"+i]),f=decodeURIComponent(f),e=0,u=u+'<input type="hidden" id="StayCity'+i+'" name="StayCity'+i+'" value="'+n["xIDCity"+i]+'"/>',u=u+'<input type="hidden" name="StayCity'+i+'_Name" id="StayCity'+i+'_Name" value="'+f+'" />',i===1?u=u+'<input type="hidden" name="InDate'+i+'" id="InDate'+i+'" value="'+decodeURIComponent(n.xtxtBYArriving)+'" />':"",u=u+'<input type="hidden" name="APICity'+i+'" id="APICity'+i+'" value="'+decodeURIComponent(n["xAPICity"+i])+'"/>',u=u+'<input type="hidden" name="StayNite'+i+'" id="StayNite'+i+'" value="'+n["xSTCity"+i]+'"/>',n["xOVNCity"+i]?e=n["xOVNCity"+i]:"",u=u+'<input type="hidden" name="OverNiteT'+i+'" id="OverNiteT'+i+'" value="'+e+'"/>',$("#formToBooking").append(u),u=""):i=12,i===12?toBPGo():"";else alert("error")}function toBPGo(){bpDep=$("#xgoingID").val();var n=$("#formToBooking").serialize();document.formToBooking.action=bookingurl;document.formToBooking.submit()}function QueryStringToJSON(n){var i=n.split("&"),t={};return i.forEach(function(n){n=n.split("=");var i=n[0],r=n[1];i.length&&(t[i]!==undefined?(t[i].push||(t[i]=[t[i]]),t[i].push(r||"")):t[i]=r||"")}),t}function countPax(n){var o=n,e=-1,t=[],r=[],u=0,f=0,s=$("#xiRoomsAndPax").val(),h=s.split("|");if($("#pRoom1").is(":visible")===!0?(e=0,t[0]=Number($("#xiAdults").val()),u=t[0],r[0]=Number($("#xiChildren").val()),f=r[0]):/Other/.test(s)===!1?t[0]=Number($("#xiAdults").val(),u=t[0]):"",$("#pRoom2").is(":visible")===!0?(e=1,t[1]=Number($("#xRoom2_iAdults").val()),u=t[0]+t[1],r[1]=Number($("#xRoom2_iChildren").val()),f=r[0]+r[1]):"",$("#pRoom3").is(":visible")===!0?(e=2,t[2]=Number($("#xRoom3_iAdults").val()),u=t[0]+t[1]+t[2],r[2]=Number($("#xRoom3_iChildren").val()),f=r[0]+r[1]+r[2]):"",u===0&&o===1)return alert("No adults on rooms !"),t[0]===0&&$("#xiAdults").addClass("errorClass"),t[1]===0&&$("#xRoom2_iAdults").addClass("errorClass"),t[2]===0&&$("#xRoom3_iAdults").addClass("errorClass"),!1;if(u>0&&o===1)for(i=0;i<=e;i++){if($ithis=i===0?$("#xiAdults"):$("#xRoom"+Number(i+1)+"_iAdults"),t[i]===0)return alert("No adults in room "+Number(i+1)+"!"),$ithis.addClass("errorClass"),!1;if(u+f>6)return alert("Max guest allowed (adults + children) are 6 !"),!1}else return u+f<=6&&$('p[id^="pRoom"]').find(".errorClass").length>0&&($('p[id^="pRoom"]').find(".errorClass").removeClass("errorClass"),$('select[id*="iChildren"]').each(function(){this.value>0?childAge(this):""})),u+f}function findNextCity(n){var i="",t=[];return t=jsonDataArr,t=$.grep(t,function(t){return t.ctyID==n}),jQuery.each(t,function(){i=this.ctyNA}),i}function errorAlert(n,t){var i=$("#"+n+"").position();return $("#"+n+"").addClass("errorClass").val(t),!1}function childAge(n){var t,i,r;t=n.id.match(isNumber)===null?1:n.id.match(isNumber);i=n.value;$("#"+n.id+"").removeClass("errorClass");r=countPax(0);r>6?(alert("Max guest allowed (adults + children) are 6 !"),$("#"+n.id+"").addClass("errorClass")):($("#pChildAges").show(),$("#pChildAges"+t+"").show().find("select").each(function(){this.id.slice(-1).match(isNumber)<=Number(i)?($(this).show(),$('label[for="'+this.id+'"]').show()):($(this).hide().val(-1),$('label[for="'+this.id+'"]').hide("fast",function(){countChilds()<=0?$("#pChildAges").hide():""}))}))}function countChilds(){var n=0,t=0,i=0;return $("#pRoom1").is(":visible")===!0?n=Number($("#xiChildren").val()):"",$("#pRoom2").is(":visible")===!0?t=Number($("#xRoom2_iChildren").val()):"",$("#pRoom3").is(":visible")===!0?i=Number($("#xRoom3_iChildren").val()):"",n+t+i}function changeAdults(n){$("#"+n.id+"").removeClass("errorClass");var t=countPax(0);t>6&&(alert("Max guest allowed (adults + children) are 6 !"),$("#"+n.id+"").addClass("errorClass"))}function IsMobileDevice(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Windows mobile/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Opera Mini/i)?!0:!1}function identifyBrowser(n,t){var r={Chrome:[/Chrome\/(\S+)/],Firefox:[/Firefox\/(\S+)/],MSIE:[/MSIE (\S+);/],Opera:[/Opera\/.*?Version\/(\S+)/,/Opera\/(\S+)/],Safari:[/Version\/(\S+).*?Safari\//]},u,f,i,e;n===undefined&&(n=navigator.userAgent);t===undefined?t=2:t===0&&(t=1337);for(i in r)while(u=r[i].shift())if(f=n.match(u))return e=f[1].match(new RegExp("[^.]+(?:.[^.]+){0,"+--t+"}"))[0],i+" "+e;return null}function changeIt(n,t){var s=t,e=n.length,o=e,i=0,r="",f="",u="",h=n;if(s=="none")while(o>0)lastpercent=n.lastIndexOf("%"),lastpercent!=-1?(f=n.substring(lastpercent+1,n.length),n=n.substring(0,lastpercent),f.length>=2&&(u=f.substring(0,2),r=f.substring(2,f.length)+r,"01234567890abcdefABCDEF".indexOf(u.substring(0,1))!=-1&&"01234567890abcdefABCDEF".indexOf(u.substring(1,2))!=-1&&(u=String.fromCharCode(parseInt(u,16)),r=u+r)),o=lastpercent):(r=n+r,o=0);else for(i=0;i<e;i++)n.substring(i,i+1).charCodeAt(0)<255?r=isUnsafe(n.substring(i,i+1))==!1?r+n.substring(i,i+1):r+convert(n.substring(i,i+1)):(alert("Found a non-ISO-8859-1 character at position: "+(i+1)+",\nPlease eliminate before continuing."),r=h,i=e);return r}function formatCurrency(n){var i,t;for(n=n.toString().replace(/\$|\,/g,""),isNaN(n)&&(n="0"),sign=n==(n=Math.abs(n)),n=Math.floor(n*100+.50000000001),cents=n%100,n=Math.floor(n/100).toString(),cents<10&&(cents="0"+cents),i=Math.floor(n.length),i=Number(i)-1,t=0;t<Math.floor(Number(i+t)/3);t++)n=n.substring(0,Number(n.length)-(4*t+3))+","+n.substring(Number(n.length)-(4*t+3));return(sign?"":"-")+"$"+n}function ObjectPosition(n){var t=0,i=0;if(n.offsetParent)do t+=n.offsetLeft,i+=n.offsetTop;while(n=n.offsetParent);return[t,i]}function getBusinessDateObj(n){var t=new Date;t.setTime(t.getTime()-0);var r=t.getDay(),i=n,u=r+n;return u>=6&&(n-=6-r,i+=2,bookWeeks=Math.floor(n/5),i+=bookWeeks*2),t.setTime(t.getTime()+i*864e5),t}function activeCckBx(n){$("#"+n+" input:checkbox").each(function(){this.checked?$("#false"+this.id+"").addClass("falsecheckeddop"):$("#false"+this.id+"").removeClass("falsecheckeddop")});var t;$("#"+n+" .falsecheckdop").click(function(){return this.id.indexOf("falsedot")>-1?t=this.id.replace("falsedot",""):this.id.indexOf("false")>-1?t=this.id.replace("false",""):"",$(this).hasClass("falsecheckeddop")?($(this).removeClass("falsecheckeddop"),$("#"+t+"").removeAttr("checked")):($(this).addClass("falsecheckeddop"),$("#"+t+"").attr("checked",!0)),$(this.hash).trigger("click"),!1})}function getDistanceFromLatLonInKm(n,t,i,r){var u=deg2rad(i-n),f=deg2rad(r-t),e=Math.sin(u/2)*Math.sin(u/2)+Math.cos(deg2rad(n))*Math.cos(deg2rad(i))*Math.sin(f/2)*Math.sin(f/2),o=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e));return 6371*o}function deg2rad(n){return n*(Math.PI/180)}function findPacks(n){var h,t,o,s,r,c,u,f,e;for($("#"+n+" #allID").val()!=""&&$("#"+n+" #allID").val(""),$("#"+n+" #allNA").val()!=""&&$("#"+n+" #allNA").val(""),h=n,t=$("#"+h+"").serialize(),t=t.substring(0,t.indexOf("&__RequestVerificationToken")),c="",e=0,t=t.replace(/\+/g," "),t=t.replace(/\%7C/g,"|"),o=t.split("&"),i=0;i<o.length;i++)s=o[i].split("="),s[1]!=""&&(e=e+1,r=s[1].split("|"),e>1?(u=u+","+r[0].replace(/\s/g,""),f=f+"_-_"+r[1].replace(/\s/g,"-")):(u=r[0].replace(/\s/g,"_"),f=r[1].replace(/\s/g,"-")));if(u==undefined){alert("Please check at least one box. Thanks!");return}$("#allID").val(u);$("#allNA").val(f);window.location.href=SiteName+"/"+f.toLowerCase()+"/find-packages"}function openDivInf(n,t,i,r){var u,f,o,e;u=r!=undefined?"dvpkInf"+n+r:"dvpkInf"+n;f=r!=undefined?"pic"+n+r:"pic"+n;t==1?($("#otherMr").show(),$('div[id^="dvpkInf"]').each(function(){var t=this.id.match(isNumber);t!=n?($(this).hide(),$("#dvMrTxt"+t+"").show(),$("#dvMrPic"+t+"").hide()):($(this).slideDown("slow"),$("#dvMrTxt"+t+"").hide(),$("#dvMrPic"+t+"").show(),relPackCall(n,i,r))})):t==2?$("#"+u+"").slideUp("slow",function(){$("#dvMrTxt"+n+"").show();$("#dvMrPic"+n+"").hide();$("#otherMr").hide()}):t==3?(o=$("#"+f+"").attr("src"),o.indexOf("Plus")>-1?($("#"+u+"").slideDown("slow"),relPackCall(n,i,r),$("#"+f+"").attr("src","https://pictures.tripmasters.com/siteassets/d/minus.jpg")):($("#"+u+"").slideUp("slow"),$("#"+f+"").attr("src","https://pictures.tripmasters.com/siteassets/d/Plus.jpg"))):t==4&&(e=$("#pic"+n+"").attr("src"),e.indexOf("Plus")>-1?($("#dvWait"+n+"").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" />'),$("#dvWait"+n+"").show(),$("#moreTx"+n+"").html("Close more details"),$("#pic"+n+"").attr("src","https://pictures.tripmasters.com/siteassets/d/minus.jpg"),relPackCall(n)):e.indexOf("Minus")>-1&&($("#moreTx"+n+"").html("More details"),$("#pic"+n+"").attr("src","https://pictures.tripmasters.com/siteassets/d/Plus.jpg"),$("#dvpkInf"+n+"").slideUp()))}function openDivInfFNwXXX(n){var t=$("#pic"+n+"").attr("src");t.indexOf("Plus")>-1?($("#dvWait"+n+"").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" />'),$("#dvWait"+n+"").show(),$("#moreTx"+n+"").html("Close more details"),$("#pic"+n+"").attr("src","https://pictures.tripmasters.com/siteassets/d/minus.jpg"),relPackCallFNw(n)):t.indexOf("Minus")>-1&&($("#moreTx"+n+"").html("More details"),$("#pic"+n+"").attr("src","https://pictures.tripmasters.com/siteassets/d/Plus.jpg"),$("#pkInf"+n+"").slideUp())}function relPackCall(n){var t="",r="",u="dvCom"+n,f="dvpkInf"+n,e="dvRel"+n;$.ajax({type:"GET",url:SiteName+"/Api/Packages/sqlRelPacks/"+n,contentType:"application/json; charset=utf-8",dataType:"text",success:function(o){if(console.log("Success: "+o),msg=o,msg!=""){for(t='<div class="txt_grayLight11" style="padding:5px 3px;">Related Package<\/div><div style="padding:2px 2px;" align="left">',r='<div class="txt_11" style="padding:3px 3px 5px 3px;"><b>For more choices, combine cities found in this itinerary:<\/b><\/div><div style="padding:2px 2px;" align="left">',strPrts=msg.split("@"),i=0;i<=strPrts.length-1;i++)echP=strPrts[i].split("|"),t=t+'<span style="float:left; margin-right:5px; margin-bottom:3px;">',t=t+'<a href="/europe/'+echP[0].replace(/\s/g,"_").toLowerCase()+'/vacations" style="margin-right:10px">',t=t+'<span class="txt_grayLight11">',t=t+"<u>"+echP[0]+" ("+echP[1]+")<\/u>",t=t+"<\/span><\/a><\/span>",echP[2]!=5&&(r=r+'<span style="float:left; margin-right:5px; margin-bottom:3px;"><a style="cursor:pointer;" class="falsecheckdop" id="falsedop'+echP[3]+'" >'+echP[0]+"<\/a>",r=r+'<input type="checkbox" name="dop'+echP[3]+'" id="dop'+echP[3]+'" style="display:none" value="'+echP[3]+"|"+echP[0]+'"/>',r=r+"<\/span>");t=t+'<br style="clear:both"/><\/div>';console.log("relTxt: "+t);r=r+'<br style="clear:both"/><\/div>';$("#"+e+"").html(t);$("#"+u+"").html(r);$("#dvWait"+n+"").hide();$("#dvWait"+n+"").html("");$("#"+f+"").slideDown();activeCckBx("frm"+n)}},error:function(t){console.log("Error: "+t.responseText);$("#dvWait"+n+"").html(t.responseText)}})}function hidePopUpInfo(){return $(".dvPopUp").hide(),!1}function goToBrowse(){var n;n=$("#tripTake option:selected");window.location=n.val()}function showPopUp(n){var t,i,r,u;i=ObjectPosition(document.getElementById(n));u=i[0]-5+"px";r=i[1]+16+"px";n.indexOf("Partially")!=-1?(t='<div style="padding:0px 0px 7px 0px;"><b>Partially Guided:<\/b><\/div>',t=t+"<div>"+$("#inpparGuided").val().replace(".",".<br><br>")+"<\/div>"):n.indexOf("none")!=-1?(t='<div style="padding:0px 0px 7px 0px;"><b>None:<\/b><\/div>',t=t+"<div>has no value<\/div>"):(t='<div style="padding:0px 0px 7px 0px;"><b>Guided:<\/b><\/div>',t=t+"<div>"+$("#inpGuided").val()+"<\/div>");dvMpop=$('<div id="dvMess" class="Text_12_Blue"><\/div>');$("body").append(dvMpop);$("#dvMess").html(t);$("#dvMess").attr("style","left:"+u+"; top:"+r+"; position:absolute; display:block; border:solid 1px black; width:300px; padding:10px; background-color:#FFF;");$("#dvMess").show()}function hidePopUp(){$("#dvMess").hide()}function windowCMS(n,t,i){var r,u,f,e=navigator.userAgent,s=document.domain,o="/europe/cms/"+n+"?cms&wh=0&wf=0";r=screen.width?(screen.width-t)/2:0;u=screen.height?(screen.height-i)/2:0;f=e.indexOf("Firefox")>=0?"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,toolbar=yes":e.indexOf("Chrome")>=0?"height="+i+",width="+t+",top="+u+",left="+r+"":"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,location=yes";window.open(o,"CMS_Window",f)}function openMapBubble(n){var t=$("#dvBigMap").offset();$("#dvHotelInfo").html(n);$("#dvHstInfContainer").css({top:""+Number(t.top+600)+"px",width:"500px",position:"absolute",left:"50%","margin-left":"-250px","z-index":"8110"});$("#dvHstInfContainer").css({display:"block"}).animate({top:""+Number(t.top+300)+"px"},"slow")}function cmsPopUp(n,t){var i=$(t).offset();$.ajax({type:"POST",url:"/europe/WS_Library.asmx/sqlThisCMS",contentType:"application/json; charset=utf-8",dataType:"json",data:'{cmsID:"'+n+'"}',success:function(n){if(msg=eval("("+n.d+")"),msg!=""){"https:"===document.location.protocol?msg=msg.replace(/http:/g,"https:"):"";$("#dvDetailInfo").html(msg);$("#dvInfoContainer").css({display:"block"});$("#dvInfoContainer").css({top:""+Number(i.top)-200+"px","z-index":"8110",position:"absolute"});var t=$("#dvDetailInfo").outerWidth();$("#dvInfoContainer").animate({width:""+t+"px",left:"50%","margin-left":"-"+t/2+"px"})}},error:function(n){alert(n.responseText+" = error")}})}var cookVal=getCookie("TM_BackCookie"),citySelID,BorF="BYO",$addButt,bTo,bFrom,$addCty,$noMore,depCities=[],arrivalCities=[],arrvCTY=[],airCabin=[{label:"Coach",value:"Coach",id:"Y"},{label:"Premium Economy",value:"Premium Economy",id:"W"},{label:"Business",value:"Business",id:"C"},{label:"First Class",value:"First Class",id:"F"}],stayLength=[],stayObj,adultObj,childPax,chilObj,windowWidth,windowHeight,maskHeight,maskWidth,$dvOptions,$dvMask,$dvTransOptResp,isIE,$frmCalNextStep,myDate,jscal,getNumericPart,num,$dvSearch,$dvSearchDes,$dvMAsk;for(i=1;i<=14;i++)stayObj=i==1?{label:i+" nt",value:i+" night",id:i}:{label:i+" nts",value:i+" nights",id:i},stayLength.push(stayObj);var goingTojs=[{label:"Europe",value:"Europe",id:"TMED"},{label:"Latin America",value:"Latin America",id:"TMLD"},{label:"Asia, Pacific & Middle East",value:"Asia, Pacific & Middle East",id:"TMAS"}],pickDay=[{label:"First Day",value:"First Day",id:"F"},{label:"Last Day",value:"Last Day",id:"L"}],paxRooms=[{id:"1|1",label:"1 room for 1 adult",value:"1 room for 1 adult"},{id:"1|2",label:"1 room for 2 adults",value:"1 room for 2 adults"},{id:"1|3",label:"1 room for 3 adults",value:"1 room for 3 adults"},{id:"1|4",label:"1 room for 4 adults",value:"1 room for 4 adults"},{id:"1|5",label:"1 room/suite for 5 adults",value:"1 room/suite for 5 adults"},{id:"1|6",label:"1 room/suite for 6 adults",value:"1 room/suite for 6 adults"},{id:"1|Other",label:"1 room with children or other options",value:"1 room with children or other options"},{id:"-1",label:"----------------------------------------------------",value:""},{id:"2|2-2",label:"2 rooms for (2 adults + 2 adults)",value:"2 rooms for (2 adults + 2 adults)"},{id:"2|3-3",label:"2 rooms for (3 adults + 3 adults)",value:"2 rooms for (3 adults + 3 adults)"},{id:"2|Other",label:"2 rooms with children or other options",value:"2 rooms with children or other options"},{id:"-1",label:"----------------------------------------------------",value:""},{id:"3|2-2-2",label:"3 rooms for (2 adults + 2 adults + 2 adults)",value:"3 rooms for (2 adults + 2 adults + 2 adults)"},{id:"3|Other",label:"3 rooms with children or other options",value:"3 rooms with children or other options"}],adultPax=[];for(a=1;a<=6;a++)adultObj={label:a,value:a},adultPax.push(adultObj);for(childPax=[],c=0;c<=2;c++)chilObj={label:c,value:c},childPax.push(chilObj);myDate=new Date;jscal="S";$(document).ready(function(){_utRawUrl.indexOf("default.")>-1||_utRawUrl.indexOf("Default.")>-1?jscal="B":"";$.ajax({type:"Get",url:SiteName+"/Api/Packages/depCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t=n;depCities=$.map(t,function(n){return{label:n.plC_Title+" - "+n.plC_Code,value:n.plC_Title,id:n.plcid}});doitDep()},error:function(n){alert(n.responseText)}});$.ajax({type:"Get",url:SiteName+"/Api/Packages/priorCity",contentType:"application/json; charset=utf-8",dataType:"json",data:'{name:"%"}',success:function(n){console.log("/Api/Packages/priorCity succes");jsonDataArr=n;arrvCTY=$.map(jsonDataArr,function(n){return{label:n.ctyNA+" ("+n.couNA+")  - "+n.ctyCOD,value:n.ctyNA+" ("+n.couNA+")",id:n.ctyID,dept:n.deptNA,code:n.ctyCOD,hotapi:n.hotelAPI}});arrivalCities=arrvCTY;doitArr();doitFArr(1);cookieCheck()},error:function(n){alert(n.responseText)}});$('input[id^="achk"]').each(function(){this.checked?$("#"+this.id.replace("chk","")).addClass("abRehChoChk").parent().addClass("spRehChoActiv"):$("#"+this.id.replace("chk","")).removeClass("abRehChoChk").parent().removeClass("spRehChoActiv")});$("#tabByo").click(function(){$(this).hasClass("tabInactive")&&($(this).attr("class","tabActive"),$("#tabFind").attr("class","tabInactive"),$("#dvbCalByoTools").show(),$("#dvbCalFindTools").hide(),BorF="BYO")});$("#tabFind").click(function(){$(this).hasClass("tabInactive")&&($(this).attr("class","tabActive"),$("#tabByo").attr("class","tabInactive"),$("#dvbCalFindTools").show(),$("#dvbCalByoTools").hide(),BorF="FIND")});$("#qWair").each(function(){this.checked?$(this).parent().addClass("active"):$(this).parent().removeClass("active")});$("input:radio[name=qWair]").click(function(){this.value=="True"?($("#spWair").addClass("active"),$("#spWout").removeClass("active"),$("#AirParam").show()):($("#spWair").removeClass("active"),$("#spWout").addClass("active"),$("#AirParam").hide())});$addCty=$(".inpAddCty");$noMore=$("#inpNoMore");$addCty.click(function(){bFrom=0;bTo=0;switch(BorF){case"BYO":bFrom=$('div[id^="dvCity"]').length;break;case"FIND":bFrom=$('div[id^="dvFCity"]').length}bFrom<12?(bTo=bFrom+1,qaddCity(bFrom,bTo)):alert("For Better results, not more than 12 cities is allowed")});$noMore.click(function(){switch(BorF){case"BYO":byoValidation();break;case"FIND":validateFIND()}});$dvOptions=$("#dvOptions");$dvMask=$("#dvMask");$dvTransOptResp=$("#dvTransOptResp");$frmCalNextStep=$("#frameTransOptResp");var n=Cookies.get("utmcampaign"),t;n!=null&&(t=n.split("="),$("#qutm_campaign").length!=0&&$("#qutm_campaign").val(jQuery.trim(t[1])));cookVal!=null?initCook():($("#qIDCity1").val(-1),$("#qNACity1").val("US city or airport"),$("#qAPICity1").val(""));$('input[id^="qNACity"]').keypress(function(){var n=this.id.replace("qNACity","");$("#"+this.id).val().length==1&&$("#qIDCity"+n).val(-1)});$(".btnContinue").click(function(n){submitPrice();$(this).off(n)});$('select[id*="iChild"]').click(function(){/iChild/g.test(this.id)===!0?$("#"+this.id+"").select().removeClass("errorClass"):""})}),function(n){n.fn.dvScroolWait=function(){var r=n("#dvTransOptResp"),t=n(this).width(),i=n(this).outerWidth(),u=(t+(i-t))/2;n(this).css("left","0%");n(this).css("margin-left","-"+i/2+"px");n(this).css("top","80px")}}(jQuery),function(n){n.fn.dvScrool=function(){var t=n("#dvTransOptResp"),i=n(this).width(),r=n(this).outerWidth(),e=(i+(r-i))/2,u,f;n(this).css("left","50%");n(this).css("margin-left","-"+r/2+"px");n(this).css("top","80px");f=t.outerHeight();n(window).scroll(function(){u=n(this).height();u>f&&t.stop().animate({top:n(window).scrollTop()+30+"px"},"slow")})}}(jQuery);$.fn.serializeObject=function(){var n={},t=this.serializeArray();return $.each(t,function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};getNumericPart=function(n){return n.replace(/[^\d]+/,"")};var isNumber=/[0-9]+/g,winWidth=window.screen.width,winHeight=window.screen.height;$(document).ready(function(){$dvSearch=$("#search_box");$dvSearchDes=$("#search_Destinos");$dvMAsk=$("#mask");var n;$("#qq").click(function(){var t,i;n="search_box";t=$(document).height();i=$(window).width();$("#mask").css({width:i,height:t});$("#mask").fadeIn(1e3);$("#mask").fadeTo("slow",.8);var r=ObjectPosition(this),u=r[0]-200,f=r[1];$dvSearch.attr("style","padding:20px; position:absolute; width:480px; height: 110px; display:none; z-index:9999; left:"+u+"px; top:"+f+"px");$dvSearch.fadeIn(2e3);$dvSearch.hAlign()});$("#mask").click(function(){$(this).hide();$("#"+n+"").hide()});$("#pcls").click(function(){$("#search_box").hide();$("#mask").hide()});$(".imgCityInfo").click(function(){var n,t=$(this).position().top-30,i="dv"+this.id.match(isNumber);return $.browser.msie?(n=$(this).position().left,$("#dvPopUp").css({left:n+"px",top:t+"px"})):(n=$(this).position().left,$("#dvPopUp").css({left:n+30+"px",top:t+"px"})),$("#dvPopUp").hide(),$("#dvPopContent").empty(),$("#dvPopContent").html($("#"+i+"").html()),$("#dvPopUp").show(),!1});$(".dvBoxClose").click(function(){$("#dvDetailInfo").html("");$("#dvInfoContainer").css({display:"none"})});$(".clkMore").click(function(){var n=this.id.match(isNumber),t=$("#img"+n+"").attr("src");t.indexOf("Plus")>-1?($("#img"+n+"").attr("src",t.replace("Plus","Minus")),$("#plus"+n+"").hide().removeClass("pLeftNoWrap"),$("#minus"+n+"").show().addClass("pLeftNoWrap"),$("#spMore"+n+"").html("close more info")):($("#img"+n+"").attr("src",t.replace("Minus","Plus")),$("#plus"+n+"").show().removeClass("pLeftNoWrap"),$("#minus"+n+"").hide().addClass("pLeftNoWrap"),$("#spMore"+n+"").html("more info"))})}),function(n){n.fn.hAlign=function(){return this.each(function(){var t=n(this).width(),i=n(this).outerWidth(),r=(t+(i-t))/2;n(this).css("position","absolute");n(this).css("left","50%");n(this).css("margin-left","-"+r+"px")})}}(jQuery);