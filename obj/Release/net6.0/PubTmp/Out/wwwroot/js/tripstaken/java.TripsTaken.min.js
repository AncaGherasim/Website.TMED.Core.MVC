function ShowOrHideDiv(){$("#dvCountryCities").css("display")=="none"?($("#dvRankCities").hide(),$("#dvCountryCities").show()):($("#dvCountryCities").hide(),$("#dvRankCities").show());scrollTo(0,$("#topPosition").offset().top-1);GetPacksWithFeeds()}function setCheckboxOnly(n,t){$('a[id^="falsedot'+t+'"]').removeClass().addClass("falsecheck_1");$('input[id^="dot'+t+'"]').prop("checked",!1);$("#falsedot"+t+n).addClass("falsechecked_1");$("#dot"+t+n).prop("checked",!0);GetPacksWithFeeds()}function BuildFilterExpression(){var n="",t;return $("#dvCountryCities").css("display")=="none"?$('input[type="checkbox"][id^="dotCity"]:checked').each(function(){n=n+$(this).val()+"C"}):$('input[type="checkbox"][id^="dotCCity"]:checked').each(function(){n=n+$(this).val()+"C"}),n==""&&(n="none"),t=$('input[name="orderValue"]:checked').val(),n+"|"+t}function GetPacksWithFeeds(){$("#dvResp").hide();$("#dvResp").html("");$("#dvWait").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>');$("#dvWait").show();var t=BuildFilterExpression(),i=$("#CountryId").val(),n={};n.url=SiteName+"/Api/CityTripsTakenFeeds";n.type="POST";n.contentType="application/json; charset=utf-8";n.data=JSON.stringify({SSFilter:t,Ids:i});n.dataType="text";n.success=function(n){msg=n.substr(1,n.length-2);var t=msg.split("@");$("#FeedsIdsPages").val(t[0]);$("#spTotalFeeds").html("("+t[1]+" total)");$("#TotalFeeds").val(t[1]);OpenPage(1)};n.error=function(n){$("#dvResp").html(n.responseText);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()};$.ajax(n)}function OpenPage(n){var t;console.log("OpenPage ");console.log(n);$("#dvResp").hide();$("#dvResp").html("");$("#dvWait").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>');$("#dvWait").show();var r=BuildFilterExpression(),u=r.split("|"),f=$("#FeedsIdsPages").val(),i=f.split("|");i[n-1]!=""?(t={},t.url=SiteName+"/TripsTakenCustomerFeedbacks",t.type="POST",t.contentType="application/json; charset=utf-8",t.data=JSON.stringify({SSFilter:i[n-1],Ids:u[1]}),t.dataType="html",t.success=function(t){console.log("before SetPages");SetPages(n);$("#dvResp").html(t);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show();$('input[type="checkbox"][name^="xdot"]').each(function(){this.checked?$("#false"+this.id).addClass("falsechecked_1"):$("#false"+this.id).removeClass("falsechecked_1")});$('a[id^="falsexdot"].falsecheck_1').click(function(){return $(this).hasClass("falsechecked_1")?$(this).removeClass("falsechecked_1"):$(this).addClass("falsechecked_1"),$(this.hash).trigger("click"),!1})},t.error=function(n){console.log("error");$("#dvResp").html(n.responseText);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()},$.ajax(t)):($("#dvResp").html('<div style="margin:20px 20px 0px 20px;font-size:14px;color:#19255f;">0 activities found. Please try other combination.<\/div>'),$("#dvWait").html(""),$("#dvWait").hide(),$("#dvResp").show(),SetPages(0),$("#header").css("visibility","visible"))}function SetPages(n){console.log("SetPages = ");console.log(n);var u=$("#TotalFeeds").val(),r=Math.ceil(u/10),t="";if(t=t+"Page(s): ",n>0){if(r<=7)for(i=1;i<=r;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";else if(n<5){for(i=1;i<=5;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="spNumUnselect"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else if(t=t+'<span class="spNumUnselect"><a onclick="OpenPage(1)">1<\/a><\/span>',t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>',n+3<r){for(i=n-1;i<=n+2;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="spNumUnselect"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else for(i=r-4;i<=r;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";$('div[id^="idPages"]').addClass("dvPaginNoContent").html(t);$('div[id="idPages2"] a').click(function(){scrollTo(0,0)})}else t=t+'<span class="spNumSelect">0<\/span>',$('div[id^="idPages"]').addClass("dvPaginNoContent").html(t),$('div[id="idPages2"] a').click(function(){scrollTo(0,0)})}function findPacks(n){var t,o,s,r,h,u,f,e;for($("#"+n+" #allID").val()!=""&&$("#"+n+" #allID").val(""),$("#"+n+" #allNA").val()!=""&&$("#"+n+" #allNA").val(""),t=$("#"+n+"").serialize(),t=t.substring(0,t.indexOf("&__")),h="",e=0,t=t.replace(/\+/g," "),t=t.replace(/\%7C/g,"|"),o=t.split("&"),i=0;i<o.length;i++)s=o[i].split("="),s[1]!=""&&(e=e+1,r=s[1].split("|"),e>1?(u=u+","+r[0],f=f+"_-_"+r[1].replace(/\s/g,"-")):(u=r[0],f=r[1].replace(/\s/g,"-")));if(u==undefined){alert("Please check at least one box. Thanks!");return}$("#"+n+" #allID").val(u);$("#"+n+" #allNA").val(f);window.location=SiteName+"/"+f+"/find-packages"}$(document).ready(function(){var n,t,r,i,u;$('img[id^="img"]').each(function(){var n=$(this).attr("data");n!="none"&&($(this).css({width:"50px",height:"50px"}),$(this).attr("src","https://pictures.tripmasters.com"+n),$(this).attr("data",""))});$("input:checkbox").each(function(){this.checked?$("#false"+this.id).addClass("falsechecked_1"):$("#false"+this.id).removeClass("falsechecked_1")});$(".falsecheck_1").click(function(){return $(this).hasClass("falsechecked_1")?$(this).removeClass("falsechecked_1"):$(this).addClass("falsechecked_1"),$(this.hash).trigger("click"),!1});r="";$('div[id*="city"]').hover(function(){var i=$(this).attr("id"),u;t=$.trim($("#"+i).text());i.indexOf("ccity")>=0?(n=i.replace("ccity",""),t.length>=28&&$("#falsedotCCity"+n).text(t.substr(0,26)+".."),u="'"+n+"'",r="'CCity'"):(n=i.replace("city",""),t.length>=28&&$("#falsedotCity"+n).text(t.substr(0,26)+".."),u="'"+n+"'",r="'City'");$(this).css({"background-color":"#E9EEF8","border-radius":"3px"});$(this).append('<span style="position:relative;float:right; top:-21px;right:13px;color:#6C8BC6;text-decoration:underline;cursor:pointer;" onclick="setCheckboxOnly('+u+","+r+')">only<\/span>')},function(){$(this).css("background-color","");$(this).find("span:last").remove();var i=$(this).attr("id");i.indexOf("ccity")>=0?$("#falsedotCCity"+n).text(t):$("#falsedotCity"+n).text(t)});$('a[id^="falsedotCity"]').click(function(){GetPacksWithFeeds()});$('a[id^="falsedotCCity"]').click(function(){GetPacksWithFeeds()});$(".resetFilters").click(function(){$('a[id^="falsedotCity"]').removeClass().addClass("falsecheck_1").addClass("falsechecked_1");$('a[id^="falsedotCCity"]').removeClass().addClass("falsecheck_1").addClass("falsechecked_1");$('input[type="checkbox"][id^="dotCity"]').prop("checked",!0);$('input[type="checkbox"][id^="dotCCity"]').prop("checked",!0);$("#dvRankCities").show();$("#dvCountryCities").hide();scrollTo(0,$("#topPosition").offset().top-1);GetPacksWithFeeds()});$('input[type="radio"][name="orderValue"]').click(function(){GetPacksWithFeeds()});i=$("#Place").val();u=$("#falsedotCCity"+i).length;i!="-1"?u>0&&($("#dvRankCities").hide(),$("#dvCountryCities").show(),scrollTo(0,$("#topPosition").offset().top-1),setCheckboxOnly(i,"CCity"),scrollTo(0,$("#falsedotCCity"+i).offset().top-10)):GetPacksWithFeeds()});