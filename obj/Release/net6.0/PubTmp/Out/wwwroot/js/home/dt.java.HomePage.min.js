function doAjaxOnReady(){$.ajax({type:"Get",url:SiteName+"/Api/Packages/depCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t=n;depCities=$.map(t,function(n){return{label:n.plC_Title+" - "+n.plC_Code,value:n.plC_Title,id:n.plcid}});doitDep()},error:function(){}});$.ajax({type:"Get",url:SiteName+"/Api/Packages/priorCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){jsonDataArr=n;arrivalCities=$.map(jsonDataArr,function(n){return{label:n.ctyNA+" ("+n.couNA+")  - "+n.ctyCOD,value:n.ctyNA+" ("+n.couNA+")",id:n.ctyID,code:n.ctyCOD,dept:n.deptNA,hotapi:n.hotelAPI}});cookieCheck()},error:function(){}})}function showRecently(){var i=Cookies.get("utPackView"),t,n;return pakTot=Cookies.get("utTotal"),t={Id:visitID},console.log("utPackView: "),console.log(i),console.log("utTotal: "),console.log(pakTot),n={},n.url=SiteName+"/Api/RecentlyViewed",n.type="POST",n.contentType="application/json",n.data=JSON.stringify(t),n.dataType="json",n.success=function(n){pkVisited=n;var t=0;pkVisited?t=pkVisited.length:"";t>0?(buildRecentlyViewed(pkVisited),t>5?$(".moreViewed").show():$(".moreViewed").hide()):($(".template-RecentlyViewed").hide(),$(".moreViewed").hide())},n.error=function(n){console.log(n)},$.ajax(n),!1}function buildRecentlyViewed(n){pakTot=Cookies.get("utTotal");var r=0,i,t="";jQuery.each(n,function(){if(r++,r<6){switch(this.UTS_Site){case"TMLD":i="/europe";break;case"TMASIA":i="/asia";break;case"TMLD":i="/latin"}var n=new Date(Date.parse(this.UTS_Date)),u=new Date,f=Date.timeBetween(n,u);t=t+'<li><div class="div-ContainerFlex" ><div class="wrapper"><img src="https://pictures.tripmasters.com'+this.IMG_Path_URL.toLowerCase()+'" alt="'+this.PDL_Title+'"><div><h5><a href="'+this.UTS_URL+'">'+this.PDL_Title+'<\/a><\/h5><\/div><\/div><div class="div-UnderImg"><p class="p-under1">Viewed '+f+"<\/p>";this.feedbacks>0&&(t=t+'<p class="p-under1"><a href="'+this.UTS_URL.replace("/package","/feedback")+'">'+this.feedbacks+" Customer Reviews<\/a><\/p>");t=t+'<hr class="hr1"><a href="'+this.UTS_URL+'" class="allRecViewBtn">Customize It<\/a><\/div><\/div ><\/li >'}});$(".dvRecentlyTitle").find("span").html("["+pakTot+"]");$("#ulRecentlyViewed").append(t);$(".template-RecentlyViewed").slideDown()}function moreSuggestPacks(){$("#sugg2").is(":visible")===!1?($("#sugg2").slideDown("slow"),$(".moreSuggButton").removeClass("moreSuggButton").addClass("moreSuggButtonRot")):($("#sugg2").slideUp("slow"),$(".moreSuggButtonRot").removeClass("moreSuggButtonRot").addClass("moreSuggButton"))}function buildPackImg(){var r=0,n,t="Bipic",i=3,u=$("#imgItemID").val();$.ajax({type:"GET",url:SiteName+"/Api/Packages/PicsForPacks/"+u,contentType:"application/json; charset=utf-8",dataType:"json",success:function(u){var f,e;for(objPics=u,objImgs=$.grep(objPics,function(n){return n.imG_ImageType=="P0"}),picTotal=objPics.length,f=0,objPics.length<=3&&(f=objPics.length-1),objPics[f]&&(n=imageSize(objPics[f].imG_500Path_URL,objPics[f].imG_ImageType),objPics[f].imG_ImageType=="M0"&&(t="KipicMap",i=1),e='<img src="https://pictures.tripmasters.com'+objPics[f].imG_500Path_URL.toLowerCase()+'" id="'+t+i+'" alt="'+objPics[f].imG_500Path_URL.toLowerCase()+'" title="'+objPics[f].imG_Title+'" width="'+n[0]+'" height="'+n[0]+'" class="clsCursor"/>',$(".dvshowPIC").html(e),$(".dvshowPIC").show()),picTotal==3?CarrouPicsBuild(3):picTotal==4?CarrouPicsBuild(4):picTotal==5?CarrouPicsBuild(5):CarrouPicsBuild(6),m=0;m<Number(picTotal-1);m++)objPics[m].imG_ImageType=="M0"?($("#dvsmalMAP").html('<image src="https://pictures.tripmasters.com'+objPics[m].imG_500Path_URL+'" width="325" height="325" alt="'+objPics[m].imG_500Path_URL.toLowerCase()+'" title="'+objPics[m].imG_Title+'"/>'),$("#dvsmalMAP").show(),shwMaps=shwMaps+'<div align="center"><span class="Text_Arial12_LightBold">'+objPics[m].imG_Title+'<\/span><br/><br/><image src="https://pictures.tripmasters.com'+objPics[m].imG_500Path_URL+'" alt="'+objPics[m].imG_500Path_URL.toLowerCase()+'" title="'+objPics[m].imG_Title+'"/><\/div>',$("#dvShwMap").html(shwMaps),m=Number(picTotal-1)):r==1?$("#dvShwMap").html(shwMaps):$("#dvTabMap").hide()},error:function(n){$("#packPics").html(n.responseText)}});$('a[id*="prev"]').click(function(){return sliceThumb(Number(ini),Number(fin),this.id),!1});$('a[id*="next"]').click(function(){return sliceThumb(Number(ini+6),Number(fin+6),this.id),!1})}function winlocation(n){window.location=n}function buildFromCook(n){var t=jQuery.parseJSON(Cookies.get("backCookieTMED")),i=0,u=Object.keys(t).length,r;n===1&&jQuery.each(t,function(n,t){n==="qWair"?t==="False"?$(".dvIntlFly").find('span:contains("Without Air")').trigger("click"):$(".dvIntlFly").find('span:contains("With Air")').trigger("click"):"";/qNACity/.test(n)===!0?(n.match(isNumber)>1?$(".dvByoCalButtons").find('span:contains("ADD DESTINATION")').trigger("click"):"",$("#"+n+"").val(t)):"";/qIDCity|qSTCity|qCOCity|qAPICity|qLeave|qArrDate/.test(n)===!0?$("#"+n+"").val(t):"";/qgoingID/.test(n)===!0?($("#"+n+"").val(t),r=t):"";i+=1;i===u?(Cookies.set("backCookieTMED","",{expires:-1}),dateByDest(r)):""})}function startAgain(n){var t=n.innerHTML;switch(!0){case/Without/.test(t):$(".dvIntlFly").find('span:contains("Without")').trigger("click");break;case/With Air/.test(t):$(".dvIntlFly").find('span:contains("With Air")').trigger("click")}$("#myModal, .modal-content").slideUp();$(".dvTransportation").hide().removeAttr("style");$(".dvMask").hide().removeAttr("height");$("div.dvtranspCityList").remove();$("#dvTranspError").hide();$(".dvtranspByoCalTools").hide();$(".dvSpin").show()}function withAir(n){$(n).className==="spselect"?"":($(".dvIntlFly .spselect").removeClass("spselect"),$(n).addClass("spselect"),/Without/.test(n.innerHTML)===!0?hideAir("H"):hideAir("S"))}function hideAir(n){n==="H"?($(".dvAirParam").slideUp("slow"),$("#qWair").val("False")):($(".dvAirParam").slideDown("slow"),$("#qWair").val("True"))}function doitDep(){$("#qLeaveNA").autocomplete({autoFocus:!0,source:depCities,minLength:3,response:function(n,t){if(t.content.length===0)return alert("No valid airport found"),!1},select:function(n,t){return $("#qLeaveNA").val(t.item.value),$("#qLeaveID").val(t.item.id),!1},close:function(n){var i=$("#"+n.target.id+"").val();if($("#"+n.target.id+"").val().length>=3&&$("#"+n.target.id.replace("NA","ID")+"").val()=="-1"){var r=$(this).data("ui-autocomplete").menu.element[0].children[0],u=$(".ui-autocomplete"),f=u.val(),t=$(r).text();$("#"+this.id+"").val(t.substring(0,t.indexOf("-")));t=="No result found"?($("#"+n.target.id.replace("NA","ID")+"").val("-1"),$("#"+n.target.id+"").val(i)):$.map(depCities,function(i){$.each(i,function(r){r.label==t&&($("#"+n.target.id.replace("NA","ID")+"").val(i.id),$("#"+n.target.id.replace("NA","CO")+"").val(i.code))})})}}}).click(function(){$("#qLeaveNA").select().removeClass("errorClass");$("#"+this.id.replace("NA","ID")+"").val("-1");IsMobileDevice()&&$("#qLeaveNA").val("")}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)}}function dateByDest(){$("#qArrDate").datepicker("destroy");var n="";n=new Date(myDate.getTime()+6048e5);$("#qArrDate").datepicker({defaultDate:n,changeMonth:!1,changeYear:!1,numberOfMonths:2,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:n,maxDate:"+1Y",showOtherMonths:!1,beforeShow:function(){$(this).removeClass("errorClass")}})}function qaddCity(n){var f=n.id.split(","),s=Number(f[0]),t=Number(f[1]),r,u,e,o;if(Number(t)>12)return alert("For best results, no more than 12 cities is allowed. Thanks."),!1;if(Number(t)<=12){for(r="",u="",r="<!-- div city "+t+' --><div class="dvByoCalCity" id="dvCity'+t+'" style="margin-top:10px"><div><input id="qNACity'+t+'" type="text" name="qNACity'+t+'" value="City or airport" /><input type="hidden" name="qIDCity'+t+'"  id="qIDCity'+t+'" value="-1" /><input name="qCOCity'+t+'" type="hidden" id="qCOCity'+t+'" value=""/><input name="qAPICity'+t+'" type="hidden" id="qAPICity'+t+'" value="" /><\/div><div><span class="spRemoveCity" id="cty'+t+'" onclick="qdeleteCty(this)">Remove City<\/span><\/div><div><select name="qSTCity'+t+'" id="qSTCity'+t+'">',i=1;i<=14;i++)u=i===3?"Selected":"",r=r+'<option value="'+i+'" '+u+">"+i+" nights<\/option>";r=r+'<\/select>\t\t<\/div>\t\t<br style="clear:both" />\t\t<\/div>';e=$("#dvCity"+s);$(r).insertAfter(e);doitArr();o=Number(t)+1;$(".btnAddCty").attr("id",t+","+o);$("#qNACity"+t).keypress(function(){$("#"+this.id).val().length==1&&$("#qIDCity"+t).val(-1)})}}function qdeleteCty(n){var u=Number(n.id.match(isNumber)),f=u+1,r,t;for(r=$(".dvByoCalCity").length,$("#dvCity"+u+"").remove(),$(".btnAddCty").attr("id",Number(r-1)+","+Number(r)),i=f;i<=r;i++)$("#dvCity"+i+"").length>0&&(t=i-1,$("#dvCity"+i+"").attr("id","dvCity"+t+""),$("#qNACity"+i+"").attr("name","qNACity"+t+""),$("#qNACity"+i+"").attr("id","qNACity"+t+""),$("#qIDCity"+i+"").attr("name","qIDCity"+t+""),$("#qIDCity"+i+"").attr("id","qIDCity"+t+""),$("#qCOCity"+i+"").attr("name","qCOCity"+t+""),$("#qCOCity"+i+"").attr("id","qCOCity"+t+""),$("#qAPICity"+i+"").attr("name","qAPICity"+t+""),$("#qAPICity"+i+"").attr("id","qAPICity"+t+""),$("#cty"+i+"").attr("id","cty"+t+""),$("#qSTCity"+i+"").attr("name","qSTCity"+t+""),$("#qSTCity"+i+"").attr("id","qSTCity"+t+""),$("#cty"+i+"").attr("id","cty"+t+""),doitArr(t))}function byoValidation(){if($("#qWair").val()==="True"&&$("#qLeaveID").val()==="-1")return errorAlert("qLeaveNA","Select a valid city or airport"),!1;if(/\//.test($("#qArrDate").val())===!1)return errorAlert("qArrDate","Date is not valid"),!1;var n=0;$('form#formBYO input[id^="qIDCity"]').each(function(){this.value==="-1"&&$("#"+this.id.replace("ID","NA")+"").val()=="City or airport"?(errorAlert(this.id.replace("ID","NA"),"Select a valid city or airport"),n-=1):this.value==="-1"&&(errorAlert(this.id.replace("ID","NA"),$("#"+this.id.replace("ID","NA")+"").val()),n-=1);n+=1;n===$('form#formBYO input[id^="qIDCity"]').length?submitForm("formBYO"):""})}function submitForm(n){var r,i,t;openMask();$(".dvTransportation").show().css({position:"absolute"});r="";r=JSON.stringify($("#formBYO").serializeObject());Cookies.set("backCookieTMED",r,{expires:1});i="";i=$("#"+n+"").serialize();console.log("submitForm.stringForm: ");console.log(i);t={};t.url=SiteName+"/Api/Packages/webservTransportationOption";t.type="POST";t.contentType="application/json";t.data=JSON.stringify(i);t.dataType="json";t.success=function(n){cityData=n.Cities;console.log("cityData: ");console.log(cityData);buildTransportationFrom()};t.error=function(n){console.log(n)};$.ajax(t)}function findNextCity(n){var i="",t=[];return t=jsonDataArr,t=$.grep(t,function(t){return t.ctyID==n}),jQuery.each(t,function(){i=this.ctyNA}),i}function buildTransportationFrom(){var n;$(".dvSpin").hide();$(".dvtranspByoCalTools").show();n=JSON.parse(Cookies.get("backCookieTMED"));$("#xaddFlight").val(n.qWair);n.qWair==="True"?($('span:contains("With Air")').addClass("spselect"),$('span:contains("Without")').removeClass("spselect"),$(".dvtranspAirParam").show()):"";n.qWair==="False"?($('span:contains("Without")').addClass("spselect"),$('span:contains("With Air")').removeClass("spselect"),$(".dvtranspAirParam").hide()):"";$("#xLeaveCO").val(n.qLeaveNA);$("#xtxtLeavingFrom").val(decodeURIComponent(n.qLeaveNA));$("#xidLeavingFrom").val(n.qLeaveID);$("#xtxtBYArriving").val($("#qArrDate").val());$('#xCabin option[value="'+n.qCabinOpt+'"]').attr("selected","selected");$("#xgoingID").val(n.qgoingID);var i=[],t="",r=0,u=0,f=length(n)-1;$.each(n,function(n,e){n.match(/\d+/g)!=null&&(r!=n.match(/\d+/g)&&(r=Number(n.match(/\d+/g)),r>1?(i.push(t),t=""):"",t=t+n.match(isNumber)+"@"+e),/qNACity/.test(n)===!1?t=t+"@"+e:"");u++;u===f?(i.push(t),t="",buildTransportationTo(i),dvTrans=""):""})}function buildTransportationTo(n){var r,u;try{var t="",f=cityData.length;if(f===undefined){for(r=JSON.parse(JSON.stringify(cityData)),u=n[0].split("@"),t=t+'<div id="cityTo'+r.No+'" class="dvtranspCityList"><!-- City Name / '+this.No+" /--><div><span>"+r.No+". <b>"+decodeURIComponent(r.PlaceName.replace(/\+/g," "))+'<\/b><\/span><input type="hidden" id="xNOCity'+r.No+'" name="xNOCity'+r.No+'" value="'+r.No+'" /><input name="xNACity'+r.No+'" type="hidden" id="xNACity'+r.No+'" value="'+decodeURIComponent(r.PlaceName.replace("+"," "))+'"/><input type="hidden" name="xIDCity'+r.No+'"  id="xIDCity'+r.No+'" value="'+r.PlaceID+'"  /><input name="xCOCitx'+r.No+'" type="hidden" id="xCOCitx'+r.No+'" value="'+u[3].trim()+'"/><input name="xAPICity'+r.No+'" type="hidden" id="xAPICity'+r.No+'" value="'+u[4].replace(/\%\7C/g,"|").trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span>',t=this.No==="1"?t+"<b>"+$("#qArrDate").val()+"<\/b>":t+'<span class="sptranspRemoveCity goToStartAgain">Edit/Remove<\/span>',t=t+'<\/span><\/div><!-- Staying for --><div> <span><select name="xSTCity'+r.No+'" id="xSTCity'+r.No+'">',i=1;i<=14;i++)t=i==u[5]?t+'<option value="'+i+'" selected>'+i+" nights<\/option>":t+'<option value="'+i+'">'+i+" nights<\/option>";t=t+'<\/select><\/span><\/div><br style="clear:both;"><\/div>'}else $.each(cityData,function(){var h=findNextCity(this.PlaceToID),l,p,y,v,s,c,u;if(isNaN(Number(this.No))===!0){if(this.No==="S"){if(l=n[0].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList" style="margin:0"><!-- City Name / S /--><div><span><font size="3">&#8224;<\/font> Must arrive to <b>'+decodeURIComponent(this.PlaceName)+'<\/b> <\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+decodeURIComponent(this.PlaceName)+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+l[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+l[4].replace(/\%\7C/g,"|").trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span><\/span><\/div><!-- Staying for --><div> <span><input type="hidden" id="xSTCity'+this.No+'" name="xSTCity'+this.No+'" value="0"/><\/span><\/div><div>',this.Options!==null){var u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+this.No+'">',r=this.No,o=this.Options,s="ptranspSelAct",a=1;t=t+"<!-- Transport options -->";o.Ranking===undefined?$.each(o,function(){var n,i;this.Ranking===1?(t=t+'<input name="xFIELDCityS" type="hidden" id="xFIELDCityS" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCityS" type="hidden" id="xTRANSCityS" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCityS" name="xOVNCityS" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to $$"+l[1]:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',a++);this.ProductType==="C"&&(n='style="display:none"',this.Ranking===1?n='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+n+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity" data-city="'+r+'">',this.CarDropOff.DOCity.DOPlaceNo!==undefined?u=u+'<option value="'+this.CarDropOff.DOCity.DOPlaceNo+'">'+this.CarDropOff.DOCity.DOPlaceNo.replace(/\+/g," ")+". "+decodeURIComponent(this.CarDropOff.DOCity.DOPlaceName)+"<\/option>":(i=this.CarDropOff.DOCity,this.Ranking===1&&(DropOffEndCity=i[0].DOPlaceNo,DropOffStartCity=r),$.each(i,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')}):($.each(o,function(){var i,n;o.Ranking===1&&(t=t+'<input name="xFIELDCityS" type="hidden" id="xFIELDCityS" value="'+o.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCityS" type="hidden" id="xTRANSCityS" value="'+o.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCityS" name="xOVNCityS" value="'+o.Overnight+'"/>',e=e+'<input data-type="'+o.ProductType+'" data-field="'+o.ProductFreeField1+'" data-ovrnts="'+o.Overnight+'" data-rank="'+o.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+o.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+o.Ranking+'" class="'+s+'"><span><b>'+o.ProductTypeName+"<\/b>",o.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct");o.ProductType==="C"&&(i='style="display:none"',o.Ranking===1?i='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+i+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity" data-city="'+r+'">',this.CarDropOff!==undefined?(n=this.CarDropOff.DOCity,$.each(n,function(){this.Ranking===1&&(DropOffEndCity=this.DOPlaceNo,DropOffStartCity=r);u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})):(n=o.CarDropOff.DOCity,this.Ranking===1&&(DropOffEndCity=n[0].DOPlaceNo,DropOffStartCity=r),$.each(n,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName.replace(/\+/g," "))+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')}),a=1);u=u+'<p id="pTranspSel'+r+"-"+Number(a+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(a+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';t=t+e+"<\/p>"+u}t=t+'<\/div><br style="clear:both;"><\/div>'}this.No==="E"&&(p=Number(n.length-1),y=n[p].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList"><!-- City Name / E /--><div><span><font size="3">&raquo;<\/font> Must depart from <b>'+decodeURIComponent(this.PlaceName)+'<\/b> <\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+decodeURIComponent(this.PlaceName)+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+y[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+y[4].replace(/\%\7C/g,"|").trim()+'"/><input type="hidden" id="xSTCity'+this.No+'" name="xSTCity'+this.No+'" value="0"/><input type="hidden" id="xOVNCity'+this.No+'" name="xOVNCity'+this.No+'" value="0"/><\/div><!-- Date / Edit-Remove --><div><span><\/span><\/div><!-- Staying for --><div> <span><\/span><\/div><br style="clear:both;"><\/div>')}else{for(v=n[Number(this.No-1)].split("@"),t=t+'<div id="cityTo'+this.No+'" class="dvtranspCityList"><!-- City Name / '+this.No+" /--><div><span>"+this.No+". <b>"+decodeURIComponent(this.PlaceName.replace(/\+/g," "))+'<\/b><\/span><input type="hidden" id="xNOCity'+this.No+'" name="xNOCity'+this.No+'" value="'+this.No+'" /><input name="xNACity'+this.No+'" type="hidden" id="xNACity'+this.No+'" value="'+this.PlaceName.replace("+"," ")+'"/><input type="hidden" name="xIDCity'+this.No+'"  id="xIDCity'+this.No+'" value="'+this.PlaceID+'"  /><input name="xCOCitx'+this.No+'" type="hidden" id="xCOCitx'+this.No+'" value="'+v[3].trim()+'"/><input name="xAPICity'+this.No+'" type="hidden" id="xAPICity'+this.No+'" value="'+v[4].replace(/\%\7C/g,"|").trim()+'"/><\/div><!-- Date / Edit-Remove --><div><span>',t=this.No==="1"?t+"<b>"+$("#qArrDate").val()+"<\/b>":t+'<span class="sptranspRemoveCity goToStartAgain">Edit/Remove<\/span>',t=t+'<\/span><\/div><!-- Staying for --><div> <span><select name="xSTCity'+this.No+'" id="xSTCity'+this.No+'">',i=1;i<=14;i++)t=i==v[5]?t+'<option value="'+i+'" selected>'+i+" nights<\/option>":t+'<option value="'+i+'">'+i+" nights<\/option>";if(t=t+"<\/select><\/span><\/div><div>",s="ptranspSelAct",c=1,this.Options!==null){var r=this.No,u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+this.No+'">',w=this.Options;if(this.Options[0].Ranking!==null)$.each(w,function(){var i,n;this.Ranking===1?(t=t+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',c++);this.ProductType==="C"&&(i='style="display:none"',this.Ranking===1?i='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+i+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity" data-city="'+r+'">',this.CarDropOff!==null?(n=this.CarDropOff.DOCity,$.each(n,function(){this.Ranking===1&&(DropOffEndCity=this.DOPlaceNo,DropOffStartCity=r);u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})):(n=this.CarDropOff.DOCity,$.each(n,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName.replace(/\+/g," "))+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')}),u=u+'<p id="pTranspSel'+r+"-"+Number(c+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(c+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>',t=t+e+"<\/p>"+u;else{c=1;var o=this.Options,u="",e='<!-- Checkboxes for trasnsport options --><p class="ptranspCheck" id="pCheckBox'+r+'">',s="ptranspSelAct";$.each(o,function(){var n,i;this.Ranking===1?(t=t+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="'+this.ProductFreeField1+'"/>',t=t+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="'+this.ProductType+'"/>',t=t+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="'+this.Overnight+'"/>',e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" checked type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span><b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',s="ptranspSelNoAct"):(e=e+'<input data-type="'+this.ProductType+'" data-field="'+this.ProductFreeField1+'" data-ovrnts="'+this.Overnight+'" data-rank="'+this.Ranking+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>'+this.ProductTypeName+"&nbsp;&nbsp;<\/span>",u=u+'<!-- Trasport option selected label --><p id="pTranspSel'+r+"-"+this.Ranking+'" class="'+s+'"><span> <b>'+this.ProductTypeName+"<\/b>",this.ProductType!="C"?u=u+" to "+h:"",u=u+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>',c++);this.ProductType==="C"&&(n='style="display:none"',this.Ranking===1?n='style="display:block"':"",u=u+'<!-- CAR options / parameters --><span class="dvCarOpt" id="carOptions'+r+'" '+n+'><p class="dvCarUpOff" id="pickup'+r+'"><span>Pick-up<\/span><select name="xpickupPlaceCity'+r+'" id="xpickupPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xpickupDayCity'+r+'" id="xpickupDayCity'+r+'"><option value="F">First Day<\/option><option value="L">Last Day<\/option><\/select><br style="clear:both;"><\/p><p class="dvCarUpOff" id="trdropOff'+r+'"><span>Drop-off<\/span><select name="xdropoffPlaceCity'+r+'" id="xdropoffPlaceCity'+r+'"><option value="A">Airport<\/option><\/select><select name="xdropoffDayCity'+r+'" id="xdropoffDayCity'+r+'"><option value="L">Last Day<\/option><option value="F">First Day<\/option><\/select><select name="xdropoffCity'+r+'" id="xdropoffCity'+r+'" class="selectDropOffCity" data-city="'+r+'">',this.CarDropOff.DOCity.DOPlaceNo!==undefined?(u=u+'<option value="'+this.CarDropOff.DOCity.DOPlaceNo+'">'+this.CarDropOff.DOCity.DOPlaceNo+". "+decodeURIComponent(this.CarDropOff.DOCity.DOPlaceName.replace(/\+/g," "))+"<\/option>",this.Ranking===1&&(DropOffEndCity=this.CarDropOff.DOCity.DOPlaceNo,DropOffStartCity=r)):(i=this.CarDropOff.DOCity,this.Ranking===1&&(DropOffEndCity=i[0].DOPlaceNo,DropOffStartCity=r),$.each(i,function(){u=u+'<option value="'+this.DOPlaceNo+'">'+this.DOPlaceNo+". "+decodeURIComponent(this.DOPlaceName)+"<\/option>"})),u=u+'<\/select><br style="clear:both;"><\/p><\/span>')});u=u+'<p id="pTranspSel'+r+"-"+Number(c+1)+'" class="ptranspSelNoAct"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';e=e+'<input data-type="W" data-field="OWN" data-ovrnts="0" data-rank="'+Number(c+1)+'" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';t=t+e+"<\/p>"+u}}else if(this.No<f&&h!=""){var r=this.No,s="ptranspSelAct",e="<!-- Checkboxes for trasnsport options -->";e=e+'<input name="xFIELDCity'+r+'" type="hidden" id="xFIELDCity'+r+'" value="OWN"/>';e=e+'<input name="xTRANSCity'+r+'" type="hidden" id="xTRANSCity'+r+'" value="W"/>';e=e+'<input type="hidden" id="xOVNCity'+r+'" name="xOVNCity'+r+'" value="0"/><p class="ptranspCheck" id="pCheckBox'+r+'"><input data-type="OWN" data-field="W" data-ovrnts="0" data-rank="1" id="xradioTrans'+r+'" name="xradioTrans'+r+'" class="checkBox" value="'+r+'" type="radio"><span>On your own<\/span>';u='<!-- Trasport option selected label --><p id="pTranspSel'+r+'-1" class="'+s+'"><span><b>On your own<\/b> to '+h+'<\/span><span><input class="buttontranspChange" value="change" id="'+r+'" type="button"><\/span> <br style="clear:both"><\/p>';t=t+e+u}t=t+"<\/div>";t=t+'<br style="clear:both"/>';t=t+"<\/div>"}});$("#dvWaitGlobe").html("").hide();$(".dvtranspMainContainer").show();$("#dvTranspError").hide();$(t).insertAfter(".dvtranspLabels");$(".buttontranspChange").click(function(){changeTranspOption(this)});$(".selectDropOffCity").change(function(){carSelected($(this).data("city"))});$(".checkBox").click(function(){modifyTransportation(this,this.value)});$(".goToStartAgain").click(function(){startAgain(this)});t=""}catch(e){buildTransportationError(e.message)}}function buildTransportationError(n){$(".goToStartAgain").click(function(){startAgain(this)});var i=jQuery.parseJSON(Cookies.get("backCookieTMED")),r=0,u=Object.keys(i).length,t="";jQuery.each(i,function(i,f){/qNACity/.test(i)===!0?t=t+"<li>"+f+"<\/li>":"";r+=1;r===u?(Cookies.set("backCookieTMED","",{expires:-1}),$("#sptrancities").html(t),$("#perrorCode").html(n),$(".dvWaitGlobe").hide(),$(".dvtranspMainContainer").hide(),$("#dvTranspError").show()):""})}function checkIfCarIsFirst(){$(".checkBox").each(function(){$(this).data("rank")===1?$(this).data("type")==="C"?$(this).is(":checked")?carSelected(this.id.match(isNumber)):"":"":""})}function length(n){return Object.keys(n).length}function changeTranspOption(n){$('p[id^="pTranspSel'+n.id+'"]').each(function(){this.className==="ptranspSelAct"?$(this).attr("class","ptranspSelNoAct"):""});$("#pCheckBox"+n.id+"").show()}function modifyTransportation(n,t){$("#xFIELDCity"+t+"").val($(n).data("field"));$("#xTRANSCity"+t+"").val($(n).data("type"));$("#xOVNCity"+t+"").val($(n).data("ovrnts"));$("#pCheckBox"+t+"").hide();$("#pTranspSel"+t+"-"+$(n).data("rank")+"").attr("class","ptranspSelAct");$(n).data("type")==="C"?($("#carOptions"+t+"").show(),carSelected(t)):($("#carOptions"+t+"").hide(),carNoSelected(t))}function carSelected(n){var i=$(".dvtranspCityList").length,u=n,r,f,t;for(u==="S"?(u=1,i=Number(i)-1):u=Number(u)+1,r=$("#xdropoffCity"+n+"").val(),r==="E"?$("#cityToS").length===1?(r=$(".dvtranspCityList").length-1,i=Number(i)-1):r=i:"",f=0,t=u;t<=i;t++)t<r?($("#xFIELDCity"+t+"").val(""),$('p[id^="pTranspSel'+t+"").attr("class","ptranspSelNoAct"),$("#carOptions"+t+"").is(":visible")===!0?$($("#carOptions"+t+"").hide()):""):"",t>=r?($("#xFIELDCity"+t+"").val($("#xradioTrans"+t+'[data-rank="1"]').data("field")),$('p[id^="pTranspSel'+t+"-1").attr("class","ptranspSelAct"),$("#xFIELDCity"+t+"").val()==="TBA"?($("#carOptions"+t+"").show(),t++):""):""}function carNoSelected(n){var i=$(".dvtranspCityList").length,r=n,u,f,t;for(r==="S"?(r=1,i=Number(i)-1):r=Number(r)+1,u=$("#xdropoffCity"+n+"").val(),u==="E"?$("#cityToS").length===1?(u=$(".dvtranspCityList").length-1,i=Number(i)-1):u=i:"",f=0,t=r;t<=i;t++)$("#xFIELDCity"+t+"").val($("#xradioTrans"+t+'[data-rank="1"]').data("field")),$('p[id^="pTranspSel'+t+"-1").attr("class","ptranspSelAct"),$("#xFIELDCity"+t+"").val()==="TBA"?($("#carOptions"+t+"").show(),t++):""}function openMask(){var n=$(document).height();$(".dvMask").css({height:n});$(".dvMask").fadeIn(1e3);$(".dvMask").fadeTo("slow",.9)}function errorAlert(n,t){var i=$("#"+n+"").position();return $("#"+n+"").addClass("errorClass").val(t),window.scroll(0,i.top-100),!1}function popupImages(){var n=objPics[0].picBIG,t;n==undefined&&(n=objPics[0].picURL);t=objPics[0].picNA;$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" title="'+t+'" alt="'+n.toLowerCase()+'"/>');$("#dvPicNa").html(t);popUpImagesNav();var i=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.65);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(i.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(i.top+600))}function popupThisImages(n){popUpImagesNav();var t=$(".dvImgContOv").position();openMask();$(".dvmediaPopUp").css("top",t.top).show();window.scroll(0,t.top-150);n===undefined?(n=$(".dvshowPIC").find("img"),replacePicture(n.attr("id").replace("B","K"),n.attr("src"),n.attr("title"),n.attr("alt"))):replacePicture(n.id.replace("B","K"),n.src,n.title,n.alt)}function replacePicture(n,t,i,r){var u;u=r==="none"?picSRC:"https://pictures.tripmasters.com"+r;/O/.test(n)===!1?($('img.picSel[id*="Kipic"]').attr("class","picNSel"),$('img.picSel[id*="Mipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),$(".dvFstPic").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'" />'),/M/.test(n)===!0?($("#dvMV").hide(),$("#Mipic"+n.match(isNumber)+"").attr("class","picSel")):($("#dvMV").show(),$("#dvPicNa").html(i))):($('img[id*="Oipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),/Map/.test(n)===!0||u.match(img500)===!0?($(".dvshowPIC").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'" alt="'+r+'" title="'+i+'" width="290" height="290"  class="clsCursor"/>'),$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")):($(".dvshowPIC").html('<img src="'+u.toLowerCase()+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'"  class="clsCursor"/>'),$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")))}function moreMediaCLS(){$(".dvMask").hide().removeAttr("height");$(".dvmediaPopUp").hide()}function otherMoreDetails(n,t){$(".dvOtherInfo").each(function(){var i=$(this).attr("id"),t=i.match(isNumber);t==n?$("#"+i+"").is(":visible")==!1?($("#"+i+"").slideDown(),$("#dvArrow"+t+"").slideDown(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(270deg)")):($("#"+i+"").slideUp(),$("#dvArrow"+t+"").slideUp(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(90deg)")):($("#"+i+"").slideUp(),$("#dvArrow"+t+"").slideUp(),$('div.dveachOtherMore[lang="'+t+'"]').find("span").css("transform","rotate(90deg)"))});t===1?relPackCall(n):""}function relPackCall(n){var t="",r="",u="dvCom"+n,f="dvpkInf"+n,e="dvRel"+n;console.log(SiteName+"/Api/Packages/sqlRelPacks/"+n);$.ajax({type:"GET",url:SiteName+"/Api/Packages/sqlRelPacks/"+n,contentType:"application/json; charset=utf-8",dataType:"text",success:function(o){if(console.log("Success: "+o),msg=o,msg!=""){for(t='<div class="txt_grayLight11" style="padding:5px 3px;">Related Package<\/div><div style="padding:2px 2px;" align="left">',r='<div class="txt_11" style="padding:3px 3px 5px 3px;"><b>For more choices, combine cities found in this itinerary:<\/b><\/div><div style="padding:2px 2px;" align="left">',strPrts=msg.split("@"),i=0;i<=strPrts.length-1;i++)echP=strPrts[i].split("|"),t=t+'<span style="float:left; margin-right:5px; margin-bottom:3px;">',t=t+'<a href="'+SiteName+"/"+echP[0].replace(/\s/g,"_").toLowerCase()+'/vacations" style="margin-right:10px">',t=t+'<span class="txt_grayLight11">',t=t+"<u>"+echP[0]+" ("+echP[1]+")<\/u>",t=t+"<\/span><\/a><\/span>",echP[2]!=5&&(r=r+'<span style="float:left; margin-right:5px; margin-bottom:3px;"><a style="cursor:pointer;" class="falsecheckdop" id="falsedop'+echP[3]+'" >'+echP[0]+"<\/a>",r=r+'<input type="checkbox" name="dop'+echP[3]+'" id="dop'+echP[3]+'" style="display:none" value="'+echP[3]+"|"+echP[0]+'"/>',r=r+"<\/span>");t=t+'<br style="clear:both"/><\/div>';r=r+'<br style="clear:both"/><\/div>';$("#"+e+"").html(t);$("#"+u+"").html(r);$("#dvWait"+n+"").hide();$("#dvWait"+n+"").html("");$("#"+f+"").slideDown();activeCckBx("frm"+n)}},error:function(t){console.log("Error: "+t.responseText);$("#dvWait"+n+"").html(t.responseText)}})}function activeCckBx(n){$("#"+n+" input:checkbox").each(function(){this.checked?$("#false"+this.id+"").addClass("falsecheckeddop"):$("#false"+this.id+"").removeClass("falsecheckeddop")});var t;$("#"+n+" .falsecheckdop").click(function(){return this.id.indexOf("falsedot")>-1?t=this.id.replace("falsedot",""):this.id.indexOf("false")>-1?t=this.id.replace("false",""):"",$(this).hasClass("falsecheckeddop")?($(this).removeClass("falsecheckeddop"),$("#"+t+"").removeAttr("checked")):($(this).addClass("falsecheckeddop"),$("#"+t+"").attr("checked",!0)),$(this.hash).trigger("click"),!1})}function imageSize(n,t){return n.match(img500)!=null||t=="M0"?(picW="290px",picMtp="0px",$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")):(picW="200px",picMtp="45px",$(".selM").css("width","399px"),$("#dvallTHU").attr("style","width:258px;")),[picW,picMtp]}function CarrouPicsBuild(n){for(CoPic=0,CoMap=0,i=0;i<n;i++)picClass=i==0?"picSel":"picNSel",objPics[i].imG_ImageType=="P0"?(CoPic++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+CoPic+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(CoMap++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+CoMap+'"  class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>',hvBigMap=1),ini=0,fin=i;if(picTotal<6)var t=18*(6-picTotal);else t=0;$("#dvallTHU #prev").css({"padding-left":""+t+"px","background-position":""+t+"px 0"});$("#thumbs").html(TthumPic);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}function sliceThumb(n,t,r){var e,u,f;if(TthumPic="",r=="prev"){if(t==picTotal-1?(e=Number(t-n),n=n-6,t=Number(t-e)-1):(n=n-6,t=t-6),n<0)return alert("No more images"),!1;for(u=n,f=n,i=n;i<=t;i++)picClass="picNSel",objPics[i].imG_ImageType=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"right"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"left"},500);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}if(r=="next")if(t>picTotal-1&&(t=picTotal-1),n>=picTotal-1)alert("No more images");else{for(u=n-1,f=n-1,i=n;i<=t;i++)picClass="picNSel",objPics[i].imG_ImageType=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/><\/span>'):objPics[i].imG_ImageType=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"left"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"right"},500);$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}}function popUpImagesNav(){thumPic="";thumMap="";hvMap=0;var n=0,r=0,t="picNSel";for(i=0;i<Number(picTotal);i++)t=i==0?"picSel":"picNSel",objPics[i].imG_ImageType=="P0"?(n++,thumPic=thumPic+'<img id="Kipic'+n+'" class="'+t+'" src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL.toLowerCase()+'" title="'+objPics[i].imG_Title+'"/>'):(objPics[i].imG_ImageType=="M0"||objPics[i].imG_ImageType=="M1")&&(r++,thumMap=thumMap+'<img src="https://pictures.tripmasters.com'+objPics[i].imG_Path_URL.toLowerCase()+'" id="Mipic'+r+'" class="'+t+'" width="30" height="30" alt="'+objPics[i].imG_500Path_URL+'" title="'+objPics[i].imG_Title+'"/>',hvMap=1);newPicTot=n;$("#dvThuPic").html("Photos<br/>"+thumPic);hvMap==1?($("#dvThMp").show(),$("#dvThuMap").html("Map<br/>"+thumMap)):($("#dvThMp").hide(),$("#dvTabMap").hide());$("img.picSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){replacePicture(this.id,this.src,this.title,this.alt)})}function swichImg(n){var e,f,t,u,i,r;e=newPicTot;f=$('img.picSel[id^="K"]');t=f.attr("id");t=t.replace("ipic","");t.indexOf("O")>-1&&(t=t.replace("O",""));t.indexOf("K")>-1&&(t=t.replace("K",""));n=="F"&&(t==e?alert("No more photos"):(u=Number(t)+1,r=objImgs[t].imG_500Path_URL,r==""&&(r=objImgs[u].imG_500Path_URL),i=$("#Kipic"+u+""),$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")));n=="B"&&(t==1?alert("No more photos"):(u=Number(t)-1,r=objImgs[u-1].imG_500Path_URL,r==""&&(r=objImgs[u-1].imG_500Path_URL),i=$("#Kipic"+u+""),$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")))}function moreMedia(){var n=objPics[0].picBIG,t;n==undefined&&(n=objPics[0].picURL);t=objPics[0].picNA;$(".dvFstPic").html('<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" title="'+t+'" alt="'+n.toLowerCase()+'"/>');$("#dvPicNa").html(t);popUpImagesNav();var i=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.65);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(i.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(i.top+600))}function moreMediaB(n,t,i,r){popUpImagesNav();var u=$(".dvImgContOv").position();$("#dvMask").css({width:maskW,height:maskH});$("#dvMask").fadeTo("slow",.8);$(".dvmediaPopUp").attr("style","position:absolute; z-index:9999; width:1010px; left:50%; margin-left:-505px; top:"+Number(u.top+610)+"px; height:auto; background-color:#FFF;");$(".dvmediaPopUp").show();window.scrollTo(0,Number(u.top+600));replacePicture(n.replace("B","K"),t,i,r)}function scrollToTop(){$("body,html").animate({scrollTop:0},800)}function findPacksHome(n){var h,t;$("#"+n+" input[name=allID]").val("");$("#"+n+" input[name=allNA]").val("");$("#"+n+" input[name=__RequestVerificationToken]").prop("disabled",!0);h=n;t=$("#"+h+"").serialize();$("#"+n+" input[name=__RequestVerificationToken]").prop("disabled",!1);var o,s,r,u="",f="",e=0;for(t=t.replace(/\+/g," "),t=t.replace(/\%7C/g,"|"),o=t.split("&"),i=0;i<o.length;i++)s=o[i].split("="),s[1]!=""&&(e=e+1,console.log("count = "+e),r=s[1].split("|"),e>1?(u=u+","+r[0],f=f+"_-_"+r[1].replace(/\s/g,"_")):(u=r[0],f=r[1].replace(/\s/g,"_")));if(u==""){alert("Please check at least one box. Thanks!");return}$("#allID").val(u);$("#allNA").val(f);window.location.href=SiteName+"/"+f.toLowerCase()+"/find-packages"}function cookieCheck(){selectRoomPax("1|2");backCookie=Cookies.get("backCookieTMED");backCookie!=undefined?(haveCook=1,buildFromCook(1),doitArr()):(haveCook=0,dateByDest(),doitArr())}function doitArr(){$('input[id^="qNACity"]').each(function(){var n=""+this.id+"";$(this).autocomplete({autoFocus:!0,source:function(n,t){var i;n.term.length<4?i=new RegExp("^"+$.ui.autocomplete.escapeRegex(n.term),"i"):n.term.length>=4&&(i=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(n.term),"i"));t($.map(arrivalCities,function(n){if(i.test(n.value)||i.test(n.code))return n}))},minLength:3,response:function(t,i){if(i.content.length===0&&$("#"+n+"").val().length>=5)return $("#"+this.id.replace("NA","ID")+"").val("-1"),i.content.push({label:"No result found",value:""}),!1},select:function(n,t){$("#"+this.id+"").val(t.item.value).removeClass("errorClass");$("#"+this.id.replace("NA","ID")+"").val(t.item.id);$("#"+this.id.replace("NA","CO")+"").val(t.item.code);$("#"+this.id.replace("NA","API")+"").val(t.item.hotapi);var i=this.id.match(isNumber);return Number(i)===1&&$("#qgoingID, #xgoingID").val(t.item.dept),!1},close:function(t){var r=$("#"+t.target.id+"").val();if($("#"+n+"").val().length>=3&&$("#"+t.target.id.replace("NA","ID")+"").val()=="-1"){var u=$(this).data("ui-autocomplete").menu.element[0].children[0],f=$(".ui-autocomplete"),e=f.val(),i=$(u).text();$("#"+this.id+"").val(i.substring(0,i.indexOf("-")));i=="No result found"?($("#"+t.target.id.replace("NA","ID")+"").val("-1"),$("#"+t.target.id+"").val(r)):$.map(arrivalCities,function(n){$.each(n,function(){if(n.label==i){$("#"+t.target.id.replace("NA","ID")+"").val(n.id);$("#"+t.target.id.replace("NA","CO")+"").val(n.code);$("#"+t.target.id.replace("NA","API")+"").val(n.hotapi);var r=t.target.id.match(isNumber);Number(r)===1&&$("#qgoingID, #xgoingID").val(n.dept)}})})}}}).click(function(){$(this).select().removeClass("errorClass");$("#"+this.id.replace("NA","ID")+"").val("-1");$("#"+this.id+"").select();IsMobileDevice()&&$(this).val("")}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightTextBYO(this.term,i),$("<li><\/li>").append(i).appendTo(n)}})}function highlightTextBYO(n,t){for(var f=$.trim(n).toLowerCase(),i=t.get(0).firstChild,e,u,r;(e=i.data.toLowerCase().indexOf(f))>=0;)u=i.splitText(e),i=u.splitText(f.length),r=document.createElement("span"),r.className="highlight",i.parentNode.insertBefore(r,i),r.appendChild(u)}function selectRoomPax(n){var t=n.split("|");$("#xiRoom").val(t[0]);$("#xRooms").val(t[0]);/Other/.test(n)===!0?(openRoom(t[0],1),$("#xiAdults").val(0)):(openRoom(t[0],0),$('#xiAdults option[value="'+t[1]+'"').attr("selected","selected"),otherCleanRoom())}function openRoom(n,t){t===0?$(".dvtranspAdultChild, #pPaxLabels").slideUp("fast"):$(".dvtranspAdultChild, #pPaxLabels").slideDown("fast");$('p[id^="pRoom"]').each(function(){this.id.match(isNumber)<=n?$(this).slideDown("slow"):($(this).slideUp("slow"),cleanRoom(this))})}function cleanRoom(n){$("#"+n.id+" select").each(function(){/_iAdults/.test(this.id)===!0?$("#"+this.id+"").val(0):/iChildren/.test("#"+this.id+"")===!0?$(this).val(0):/iChild/g.test(this.id)===!0?$("#"+this.id+"").val(-1):""})}function otherCleanRoom(){$('select[id*="iChild"]').each(function(){/iChildren/.test(this.id)===!0?$("#"+this.id+' option[value="0"]').attr("selected","selected"):"";/iChild/g.test(this.id)===!0?$("#"+this.id+' option[value="-1"]').attr("selected","selected"):""})}function childAge(n){var t,i,r;t=n.id.match(isNumber)===null?1:n.id.match(isNumber);i=n.value;$("#"+n.id+"").removeClass("errorClass");r=countPax(0);r>6?(alert("Max guest allowed (adults + children) are 6 !"),$("#"+n.id+"").addClass("errorClass")):($("#pChildAges").show(),$("#pChildAges"+t+"").show().find("select").each(function(){this.id.slice(-1).match(isNumber)<=Number(i)?($(this).show(),$('label[for="'+this.id+'"]').show()):($(this).hide().val(-1),$('label[for="'+this.id+'"]').hide("fast",function(){countChilds()<=0?$("#pChildAges").hide():""}))}))}function countChilds(){var n=0,t=0,i=0;return $("#pRoom1").is(":visible")===!0?n=Number($("#xiChildren").val()):"",$("#pRoom2").is(":visible")===!0?t=Number($("#xRoom2_iChildren").val()):"",$("#pRoom3").is(":visible")===!0?i=Number($("#xRoom3_iChildren").val()):"",n+t+i}function countPax(n){var o=n,e=-1,t=[],r=[],u=0,f=0,s=$("#xiRoomsAndPax").val(),h=s.split("|");if($("#pRoom1").is(":visible")===!0?(e=0,t[0]=Number($("#xiAdults").val()),u=t[0],r[0]=Number($("#xiChildren").val()),f=r[0]):/Other/.test(s)===!1?t[0]=Number($("#xiAdults").val(),u=t[0]):"",$("#pRoom2").is(":visible")===!0?(e=1,t[1]=Number($("#xRoom2_iAdults").val()),u=t[0]+t[1],r[1]=Number($("#xRoom2_iChildren").val()),f=r[0]+r[1]):"",$("#pRoom3").is(":visible")===!0?(e=2,t[2]=Number($("#xRoom3_iAdults").val()),u=t[0]+t[1]+t[2],r[2]=Number($("#xRoom3_iChildren").val()),f=r[0]+r[1]+r[2]):"",u===0&&o===1)return alert("No adults on rooms !"),t[0]===0&&$("#xiAdults").addClass("errorClass"),t[1]===0&&$("#xRoom2_iAdults").addClass("errorClass"),t[2]===0&&$("#xRoom3_iAdults").addClass("errorClass"),!1;if(u>0&&o===1)for(i=0;i<=e;i++){if($ithis=i===0?$("#xiAdults"):$("#xRoom"+Number(i+1)+"_iAdults"),t[i]===0)return alert("No adults in room "+Number(i+1)+"!"),$ithis.addClass("errorClass"),!1;if(u+f>6)return alert("Max guest allowed (adults + children) are 6 !"),!1}else return u+f<=6&&$('p[id^="pRoom"]').find(".errorClass").length>0&&($('p[id^="pRoom"]').find(".errorClass").removeClass("errorClass"),$('select[id*="iChildren"]').each(function(){this.value>0?childAge(this):""})),u+f}function changeAdults(n){$("#"+n.id+"").removeClass("errorClass");var t=countPax(0);t>6&&(alert("Max guest allowed (adults + children) are 6 !"),$("#"+n.id+"").addClass("errorClass"))}function childValidAge(){var n=!0;return $("#pRoom1").is(":visible")===!0?($('#pRoom1 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)}),$("#pRoom2").is(":visible")===!0&&($(' #pRoom2 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)}),$("#pRoom3").is(":visible")===!0&&$('#pRoom3 span[id^="pChildAges"]').find("select").each(function(){$(this).is(":visible")===!0&&$(this).val()==="-1"&&($(this).addClass("errorClass"),n=!1)})),n):n}function submitPrice(){var n=countPax(1);if(childValidAge()){if(n>6)return alert("Max guest allowed (adults + children) are 6 !"),$(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1;if(n===!1)return $(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1;submitCompList()}else return alert("Child age is empty"),$(".btnContinue").click(function(n){submitPrice();$(this).off(n)}),!1}function submitCompList(){var t=!1;if($("#frmTransp div[id^='cityTo']").each(function(){var i;if(!isNaN(parseInt($(this).attr("id").replace("cityTo","")))){var r=$(this).find("div input[id^='xIDCity']").val(),n=findNextCity(r),u=$(this).find("div input[id^='xNACity']").val();if(n=="")return $(this).find("div input[id^='xNACity']").val(n),startAgain(this),i=$(this).attr("id"),varIdCity="qNACity"+getNumericPart(i),$("#formBYO input[id='"+varIdCity+"']").val("Select city or airport"),$("#formBYO input[id='"+varIdCity.replace("NA","ID")+"']").val(-1),t=!0,!1;n!=u&&$(this).find("div input[id^='xNACity']").val(n)}}),t==!0){$(".btnContinue").click(function(n){submitPrice();$(this).off(n)});byoValidation();return}var i,r=$("#frmTransp").serialize(),u=QueryStringToJSON(r),n={};n.url=SiteName+"/Api/Packages/webservComponentList";n.type="POST";n.contentType="application/json";n.data=JSON.stringify(r);n.dataType="json";n.success=function(n){console.log("Api/Packages/webservComponentList: ");console.log(n);i=n;submitToBP(u,i)};n.error=function(n){console.log(n)};$.ajax(n)}function submitToBP(n,t){var e,f;$(".dvMMask").append('<div style="background:white; width:95%; margin:0 auto"><img src="https://pictures.tripmasters.com/siteassets/m/SearchingAH.gif" style="width:100%; height:100%"/><\/div>').show();var r=t.split("@|@"),o=$("#formToBooking"),s="xIDcity"+r[11],u="";if(r[1]==="1")for(o.find("input").each(function(){/SystemID/.test(this.id)?this.value=r[2]:"";/PackageComponentList/.test(this.id)?this.value=r[0]:"";/ByStayNite/.test(this.id)?this.value=r[3]:"";/GetNextDay/.test(this.id)?this.value=r[4]:"";/AirVendorAPI/.test(this.id)?this.value=r[5]:"";/AirP2PVendorAPI/.test(this.id)?this.value=r[6]:"";/CarVendorAPI/.test(this.id)?this.value=r[7]:"";/SSVendorAPI/.test(this.id)?this.value=r[8]:"";/TransferVendorAPI/.test(this.id)?this.value=r[9]:"";/TICVendorAPI/.test(this.id)?this.value=r[10]:"";bookingurl=r[12];/GIVendorAPI/.test(this.id)?this.value=r[13]:"";/addFlight/.test(this.id)?this.value=n.xaddFlight:"";/Cabin/.test(this.id)?this.value=n.xCabin:"";/iDepCity|iRetCity/.test(this.id)?this.value=n.xidLeavingFrom:"";/StayCityS/.test(this.id)?this.value=n.xNOCityS?n.xIDCityS:n.xIDCity1:"";/StayCityS_Name/.test(this.id)?this.value=n.xNOCityS?decodeURIComponent(n.xNACityS.replace(/\+/g," ")):decodeURIComponent(n.xNACity1.replace(/\+/g," ")):"";/StayCityE/.test(this.id)?this.value=n.xNoCityE?n.xIDcityE:n["xIDCity"+r[11]]:"";/StayCityE_Name/.test(this.id)?this.value=n.xNoCityE?decodeURIComponent(n.xNAcityE.replace(/\+/g," ")):decodeURIComponent(n["xNACity"+r[11]].replace(/\+/g," ")):"";/Rooms/.test(this.id)?(this.value=n.xRooms,$("#xRooms").val("1")):"";/iRoom/.test(this.id)?(this.value=n.xiRoom,$("#xiRooms").val("1")):"";/iRoomsAndPax/.test(this.id)?(this.value=decodeURI(n.xiRoomsAndPax),$("#xcabinRoomPax").val("1 Room, 2 Travelers, Economy"),$("#xiRoomsAndPax").val("1|2")):"";/iAdults/.test(this.id)?/Room/.test(this.id)?"":(this.value=n.xiAdults,$("xiAdults").val("2")):"";/iChildren/.test(this.id)?/Room/.test(this.id)?"":(this.value=n.xiChildren,$("xiChildren").val("")):"";/iChild1/.test(this.id)?/Room/.test(this.id)?"":n.xiChild1?(this.value=n.xiChild1,$("xiChild1").val("")):"":"";/iChild2/.test(this.id)?/Room/.test(this.id)?"":n.xiChild2?(this.value=n.xiChild2,$("xiChild2").val("")):"":"";/iChild3/.test(this.id)?/Room/.test(this.id)?"":n.xiChild3?(this.value=n.xiChild3,$("xiChild3").val("")):"":"";/iChild4/.test(this.id)?/Room/.test(this.id)?"":n.xiChild4?(this.value=n.xiChild4,$("xiChild4").val("")):"":"";/Room2_iAdults/.test(this.id)?n.xRoom2_iAdults?(this.value=n.xRoom2_iAdults,$("xRoom2_iAdults").val("")):this.value="":"";/Room2_iChildren/.test(this.id)?n.xRoom2_iChildren?(this.value=n.xRoom2_iChildren,$("xRoom2_iChildren").val("")):this.value="":"";/Room2_iChild1/.test(this.id)?n.xRoom2_iChild1?(this.value=n.xRoom2_iChild1,$("xRoom2_iChild1").val("")):this.value="":"";/Room2_iChild2/.test(this.id)?n.xRoom2_iChild2?(this.value=n.xRoom2_iChild2,$("xRoom2_iChild2").val("")):this.value="":"";/Room2_iChild3/.test(this.id)?n.xRoom2_iChild3?(this.value=n.xRoom2_iChild3,$("xRoom2_iChild3").val("")):this.value="":"";/Room2_iChild4/.test(this.id)?n.xRoom2_iChild4?(this.value=n.xRoom2_iChild4,$("xRoom2_iChild4").val("")):this.value="":"";/Room3_iAdults/.test(this.id)?n.xRoom3_iAdults?(this.value=n.xRoom3_iAdults,$("xRoom3_iAdults").val("")):this.value="":"";/Room3_iChildren/.test(this.id)?n.xRoom3_iChildren?(this.value=n.xRoom3_iChildren,$("xRoom3_iChildren").val("")):this.value="":"";/Room3_iChild1/.test(this.id)?n.xRoom3_iChild1?(this.value=n.xRoom3_iChild1,$("xRoom3_iChild1").val("")):this.value="":"";/Room3_iChild2/.test(this.id)?n.xRoom3_iChild2?(this.value=n.xRoom3_iChild2,$("xRoom3_iChild2").val("")):this.value="":"";/Room3_iChild3/.test(this.id)?n.xRoom3_iChild3?(this.value=n.xRoom3_iChild3,$("xRoom3_iChild3").val("")):this.value="":"";/Room3_iChild4/.test(this.id)?n.xRoom3_iChild4?(this.value=n.xRoom3_iChild4,$("xRoom3_iChild4").val("")):this.value="":""}),i=1;i<=12;i++)n["xIDCity"+i]?(f=decodeURIComponent(n["xNACity"+i]),f=decodeURIComponent(f.replace(/\+/g," ")),e=0,u=u+'<input type="hidden" id="StayCity'+i+'" name="StayCity'+i+'" value="'+n["xIDCity"+i]+'"/>',u=u+'<input type="hidden" name="StayCity'+i+'_Name" id="StayCity'+i+'_Name" value="'+f+'" />',i===1?u=u+'<input type="hidden" name="InDate'+i+'" id="InDate'+i+'" value="'+decodeURIComponent(n.xtxtBYArriving)+'" />':"",u=u+'<input type="hidden" name="APICity'+i+'" id="APICity'+i+'" value="'+decodeURIComponent(n["xAPICity"+i])+'"/>',u=u+'<input type="hidden" name="StayNite'+i+'" id="StayNite'+i+'" value="'+n["xSTCity"+i]+'"/>',n["xOVNCity"+i]?e=n["xOVNCity"+i]:"",u=u+'<input type="hidden" name="OverNiteT'+i+'" id="OverNiteT'+i+'" value="'+e+'"/>',$("#formToBooking").append(u),u=""):i=12,i===12?toBPGo():"";else alert("error")}function toBPGo(){var n=$("#formToBooking").serialize();document.formToBooking.action=bookingurl;document.formToBooking.submit()}function QueryStringToJSON(n){var i=n.split("&"),t={};return i.forEach(function(n){n=n.split("=");var i=n[0],r=n[1];i.length&&(t[i]!==undefined?(t[i].push||(t[i]=[t[i]]),t[i].push(r||"")):t[i]=r||"")}),t}var regionCheck="TMLD",depCities=[],arrivalCities=[],latinCities=[],arrvCTY=[],myDate=new Date,BorF="BYO",docH,backCookie,visitID,chnC=0,visCook=0,getNumericPart;$(document).ready(function(){var i=Cookies.get("utmcampaign"),n,t;$(".template-RecentlyViewed").hide();$(".moreViewed").hide();Cookies.get("ut2")!=undefined?(n=Cookies.get("ut2").split("&"),t=n[0].split("="),visitID=t[1]):_ut2Functions.push(function(){utValues=_ut2;jQuery.each(utValues,function(n,t){n=="_utvId"&&(visitID=t)})});console.log("visitID = "+visitID);doAjaxOnReady();$("#dvHeaderGap").css("margin-bottom","0px");$(".dvhGreyBG").css("margin-bottom","0px");$(".dvChooseReg span").click(function(){chooseRegion(this)});$(".dvIntlFly span").click(function(){withAir(this)});$(".btnAddCty").click(function(){qaddCity(this)});$(".btnNoMore").click(function(){byoValidation()});$(".btnFAddCty").click(function(){qaddCity(this)});$(".btnFNoMore").click(function(){findValidation()});$(".moreViewed, .buildButton, .btnRevMore").click(function(){winlocation(this.getAttribute("data-go-to"))});$(".dvshowPIC").on("click","img",function(){popupThisImages(this)});$(".moreImgButt").click(function(){popupThisImages()});$(".moreSuggButton").click(function(){moreSuggestPacks()});$("#imgForw").click(function(){swichImg("F")});$("#imgBack").click(function(){swichImg("B")});buildPackImg();$(".dvEachOtherMore").click(function(){var n=this.getAttribute("data-id");otherMoreDetails(n,1)});$(".dvOtherClose span").click(function(){var n=this.id;otherMoreDetails(n,0)});$('input[id^="qNACity"]').keypress(function(){var n=this.id.replace("qNACity","");$("#"+this.id).val().length==1&&$("#qIDCity"+n).val(-1)});$(".btnContinue").click(function(n){submitPrice();$(this).off(n)});visitID!=undefined?showRecently():"";$('select[id*="iChild"]').click(function(){/iChild/g.test(this.id)===!0?$("#"+this.id+"").select().removeClass("errorClass"):""})});Date.timeBetween=function(n,t){var e=n.getTime(),o=t.getTime(),i=o-e,s,r,u,f;return i=i/1e3,s=Math.floor(i%60),i=i/60,r=Math.floor(i%60),i=i/60,u=Math.floor(i%24),f=Math.floor(i/24),f>0?f===1?f+" day ago":f+" days ago":u>0?u===1?u+" hour ago":u+" hours ago":r>0?r===1?r+" minute ago":r+" minutes ago":"  just visited"};$.fn.serializeObject=function(){var n={},t=this.serializeArray();return $.each(t,function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};var pics="",aPic="",thumPic="",OthumPic="",TthumPic="",thumMap="",OthumMap="",picSize=200,shwMaps="",maskH,maskW,isNumber=/[0-9]+/g;$(document).ready(function(){maskH=$(document).height();maskW=$(window).width();$(".moreButton").click(function(){$(".dvEacHighhHide").is(":visible")===!1?($(this).html("Close More Highlights & Attractions "),$(".dvEacHighhHide").slideDown()):($(this).html("More Highlights & Attractions"),$(".dvEacHighhHide").slideUp())});$(".dvSuggestTitle a, .dvEachSuggest2ndCol").click(function(){var n=this.id,t=$("#divInfo"+n+"");return t.is(":visible")==!1?(t.slideDown(),$('div.dvEachSuggest2ndCol[id="'+n+'"]').css("transform","rotate(270deg)"),otherMoreDetails(n,1)):(t.slideUp(),$('div.dvEachSuggest2ndCol[id="'+n+'"]').css("transform","rotate(90deg)")),!1})});getNumericPart=function(n){return n.replace(/[^\d]+/,"")};