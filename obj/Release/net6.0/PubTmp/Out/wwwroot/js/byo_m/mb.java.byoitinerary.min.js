function buildFromCookie1(){var n=jQuery.parseJSON(Cookies.get("TMEDpkbyoBack")),s=n.xrdAWair,t,o;for(s=="True"&&($("#xtxtLeavingFrom").val(n.xtxtLeavingFrom),$("#xIDLeavingFrom").val(n.xIDLeavingFrom),$("#xtxtReturningTo").val(n.xtxtReturningTo),$("#xIDReturningTo").val(n.xIDReturningTo),$("#xCabinTxt").val(n.xCabinTxt),$("#xCabin").val(n.xCabin)),t=n.xtotCities,$("#xtotCities").val(t),i=1;i<=t;i++){var r=n["xsCityNA"+i],u=n["xsCityID"+i],f=n["xrdselTransField"+i],e=n["xrdselTrans"+i];citiesStr=i==1?i+"|"+r+"|"+u+"|"+f+"|"+e:citiesStr+"$$$"+i+"|"+r+"|"+u+"|"+f+"|"+e;i==t&&itineraryModifed("0","0",citiesStr)}$("#xiRoomsAndPaxText").val(n.xiRoomsAndPaxText);o=n.xiRoomsAndPax;$("#dvpxroomlst").find('li[id="'+o+'"]').trigger("click")}function buildFromCookie2(){var t=jQuery.parseJSON(Cookies.get("TMEDpkbyoBack")),i,r,u;for($("#xtxtBYArriving").val(t.xtxtBYArriving),i=t.xtotCities,r=1,n=r;n<=i;n++)$("#xOfNtsTxt"+n+"").val(t["xOfNtsTxt"+n]),$("#xselNoOfNts"+n+"").val(t["xselNoOfNts"+n]),$("#xSTCity"+n+"  option").removeAttr("selected"),u=t["xselNoOfNts"+n],$("#xSTCity"+n+"").val(u),n==i?Cookies.set("TMEDpkbyoBack","",{expires:-1}):"",n==i&&(backCook=null)}function sethometown(n){var t=n.split("|");return $("#qLeaveID").val(t[0]),$("#qLeaveCO").val(t[2]),$("#qsRetCity").val(t[0]),$("#qDepCode").html(t[2]),$("#qDepCity").html(t[1]),$("#qLeaveNA").val(t[1]).hide(),$(".pdepcode, .pdepcity, .pdepnocode").show(),!1}function newDest(){$('select[id^="xSTCity"]').change(function(){doitStay(this,this.id)});$("select").change(function(){doitCar(this)})}function doitCar(n){var t=$(n).attr("id").match(isNumber);n.value=="Downtown"?$("#xpickupPlace"+t+"").val(n.value.substring(0,1)):n.value=="Airport"?$("#xpickupPlace"+t+"").val(n.value.substring(0,1)):n.value=="First Day"?$("#xpickupDay"+t+"").val(n.value.substring(0,1)):n.value=="Last Day"&&$("#xpickupDay"+t+"").val(n.value.substring(0,1))}function doitStay(n,t){$("#xOfNtsTxt"+t.match(isNumber)+"").val($(n).find("option:selected").val());$("#xselNoOfNts"+t.match(isNumber)+"").val($(n).find("option:selected").val())}function dateByDest(){var h=$("#fixDates").val(),t,f,n,s,u;if(h!=0)return!1;if(t=$("#blockDates").val(),t==0)n=new Date(myDate.getTime()+6048e5),f='"'+today.getFullYear()+":"+Number(today.getFullYear()+1)+'"',$("#xtxtBYArriving").datepicker({defaultDate:n,yearRange:f,changeMonth:!1,changeYear:!1,numberOfMonths:1,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:n,showOtherMonths:!1,maxDate:"+365d"}).click(function(){$(this).attr("style","").removeClass("errorClass")});else{t=t.replace("B-","");t=t.trim().split("-");var e=t[0].split("*"),c=t[1].split("*"),y=new Date;for(i=0;i<=e.length-1;i++)for(var l=e[i],a=c[i],r=stringToDate(""+a+"","mm/dd/yyyy","/"),v=stringToDate(""+l+"","mm/dd/yyyy","/"),o;v<=r;)o=r.getDate(),between.push(jQuery.datepicker.formatDate("yy-mm-dd",r)),r=new Date(r.setDate(--o));if(n="",n=new Date(myDate.getTime()+6048e5),s=new Date(myDate.getTime()+7776e6),u=jQuery.datepicker.formatDate("yy-mm-dd",n),between.indexOf(u)!=-1){while(between.indexOf(u)!=-1)n.setDate(n.getDate()+1),u=jQuery.datepicker.formatDate("yy-mm-dd",n);s<=n&&$("#InDate1").val(jQuery.datepicker.formatDate("mm/dd/yy",n))}$("#xtxtBYArriving").datepicker("destroy");$("#xtxtBYArriving").datepicker({orientation:"top",defaultDate:n,changeMonth:!1,changeYear:!1,numberOfMonths:1,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:n,maxDate:"+1Y",showOtherMonths:!1,beforeShowDay:function(n){var t=jQuery.datepicker.formatDate("yy-mm-dd",n);return[between.indexOf(t)===-1]},beforeShow:function(n,t){var i=t.dpDiv;setTimeout(function(){i.position({my:"right top",at:"right bottom",collision:"flip",of:n})},1)}}).click(function(){$(this).attr("style","").removeClass("errorClass")})}}function stringToDate(n,t,i){var e=t.toLowerCase(),r=e.split(i),u=n.split(i),o=r.indexOf("mm"),s=r.indexOf("dd"),h=r.indexOf("yyyy"),f=parseInt(u[o]);return f-=1,new Date(u[h],f,u[s])}function bbdates(n){$("#xtxtBYArriving").datepicker("destroy");var t=$("#fxdates").val();builFixDatediv(t,n);objPOS=$("#"+n+"").offset();$("#dvFixDates").show();$("#dvFixDates").offset({left:objPOS.left-0,top:objPOS.top+20})}function builFixDatediv(n,t){var f,e,s="",r="",u=n.split(","),o;for(i=0;i<u.length;i++)s!=dateFormat(u[i],"mmm")&&(s=dateFormat(u[i],"mmm"),o=0,r=i==0?'<div class="dvFixDates">':r+'<\/div><div class="dvFixDates">',r=r+" "+s+" "+dateFormat(u[i],"yyyy")+": "),o==0?(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+'<span id="fxDates" onclick="changeDaysLenght1('+f+","+e+')" class="spFixDates">'+dateFormat(u[i],"dd")+"<\/span>"):(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+', <span id="fxDates" onclick="changeDaysLenght1('+f+","+e+')" class="spFixDates">'+dateFormat(u[i],"dd")+"<\/span>"),o=o+1;r=r+"<\/div>";$("#dvFixDates").html(r);setTimeout(function(){$("#dvFixDates").hide()},7e3)}function changeDaysLenght1(n,t){$("#"+t+"").val(n).removeClass("errorClass")}function AirCabin(){$("#xCabinTxt").autocomplete({autoFocus:!0,source:airCabin,minLength:0,position:{collision:"flip"},select:function(n,t){return $("#xCabinTxt").val(t.item.label),$("#xCabin").val(t.item.id),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()})}function changeCabin(n){$(".pMbyodialogCabin").each(function(){this.id===n.id?($("#"+n.id+"").find("span:first").html("&#10003;"),$("#Cabin, #xCabin").val(n.id)):$("#"+this.id+"").find("span:first").html("&nbsp;")})}function checkTotalPax(){var n=Number($("#xiAdults").val())+Number($("#xRoom2_iAdults").val())+Number($("#xRoom3_iAdults").val()),t=Number($("#xiChildren").val())+Number($("#xRoom2_iChildren").val())+Number($("#xRoom3_iChildren").val());return totalPax=n+t,totalPax<=6?!0:(alert("Max guest allowed (adults + children) are 6 !"),!1)}function adultPlus(n){var t,i;n.id.match(isNumber)===null?(t=$("#xiAdults"),i=Number(t.val()),i<=6?($(t).val(i+1),checkTotalPax()===!0?"":$(t).val(i)):""):(t=$("#xRoom"+n.id.match(isNumber)+"_iAdults"),i=Number(t.val()),i<=6?($(t).val(i+1),checkTotalPax()===!0?"":$(t).val(i)):"")}function adultMinus(n){var t;n.id.match(isNumber)===null?(t=$("#xiAdults"),nwObjVal=Number(t.val()),nwObjVal>1?t.val(nwObjVal-1):(alert("At least one adult should be present at room 1!"),t.val("1"))):(t=$("#xRoom"+n.id.match(isNumber)+"_iAdults"),nwObjVal=Number(t.val()),nwObjVal>1?t.val(nwObjVal-1):(alert("At least one adult should be present at room "+n.id.match(isNumber)+"!"),t.val("1")))}function childPlus(n){var t;n.id.match(isNumber)===null?(t=$("#xiChildren"),t.val()===""||t.val()==="0"?(t.val("1"),checkTotalPax()===!0?childAgeChange(t):t.val("0")):t.val()==="1"?(t.val("2"),checkTotalPax()===!0?childAgeChange(t):t.val("1")):t.val()==="2"?alert("Sorry, only 2 Children per room"):""):(t=$("#xRoom"+n.id.match(isNumber)+"_iChildren"),t.val()===""||t.val()==="0"?(t.val("1"),checkTotalPax()===!0?childAgeChange(t):t.val("0")):t.val()==="1"?(t.val("2"),checkTotalPax()===!0?childAgeChange(t):t.val("1")):t.val()==="2"?alert("Sorry, only 2 Children per room"):"")}function childMinus(n){var t;n.id.match(isNumber)===null?(t=$("#xiChildren"),t.val()==="2"?(t.val("1"),childAgeChange(t)):t.val()==="1"?(t.val("0"),childAgeChange(t)):""):(t=$("#xRoom"+n.id.match(isNumber)+"_iChildren"),t.val()==="2"?(t.val("1"),childAgeChange(t)):t.val()==="1"?(t.val("0"),childAgeChange(t)):"")}function childAgeChange(n){$(n).attr("id").match(isNumber)===null?$('#dvroom1 p[id^="pAge"]').each(function(t,i){i.id.match(isNumber)<=n.val()?($(this).show(),$("#xiChild"+this.id.match(isNumber)+"").val("Child "+this.id.match(isNumber)+" Age")):($(this).hide(),$("#xiChild"+this.id.match(isNumber)+"").val(""))}):$("#dvroom"+$(n).attr("id").match(isNumber)+' p[id^="pAge"]').each(function(t,i){i.id.match(isNumber)<=n.val()?($(this).show(),$("#xRoom"+$(n).attr("id").match(isNumber)+"_iChild"+this.id.match(isNumber)+"").val("Child "+this.id.match(isNumber)+" Age")):($(this).hide(),$("#xRoom"+$(n).attr("id").match(isNumber)+"_iChild"+this.id.match(isNumber)+"").val(""))})}function roomTravelers(n){$("#xiRoomsAndPax").val(n.id);$("#roomPaxTxt").html(n.innerHTML);openPaxRoomlist();/Other/.test(n.id)?openRooms(n.id.match(isNumber),0):openRooms(n.id.substring(0,1),n.id.substring(2,3))}function openRooms(n,t){t===0?($("#dvpxperroom").slideDown("slow"),$('div[id^="dvroom"]').each(function(){this.id.match(isNumber)<=n?$(this).slideDown("slow"):($(this).slideUp("slow"),cleanRooms(this))})):($("#dvpxperroom").slideUp("slow"),$('div[id^="dvroom"]').each(function(){this.id.match(isNumber)>1?cleanRooms(this):firstRoom(n,t)}))}function openPaxRoomlist(){$("#dvpxroomlst").is(":visible")===!1?($("#dvpxroomlst").slideDown("slow"),$("#dvpaxRoom").switchClass("dvMdialogRoom","dvMdialogRoomROT")):($("#dvpxroomlst").slideUp("slow"),$("#dvpaxRoom").switchClass("dvMdialogRoomROT","dvMdialogRoom"))}function firstRoom(n,t){$("#xiAdults").val(t);$("#xiChildren").val("");$("#xiChild1").val("");$("#xiChild2").val("");$('#dvroom1 p[id^="pAge"]').each(function(){$(this).hide()})}function cleanRooms(n){$("#"+n.id+"").find("input").each(function(n,t){switch(n){case 0:$("#"+t.id+"").val("");break;case 1:$("#"+t.id+"").val("");break;case 2:$("#"+t.id+"").val("");break;case 3:$("#"+t.id+"").val("")}});$("#"+n.id+' p[id^="pAge"]').each(function(){$(this).hide()})}function showdialog(){$("html, body").animate({scrollTop:"0px"},300);$(".dvMMask").show();$(".dvMbyoPgContainer").show();$(".pMbyodialogCabin").click(function(){changeCabin(this)})}function hidedialog(){var n=Number($('div[id^="dvroom"]:visible').length);$('div[id^="dvroom"]').each(function(){if($(this).is(":visible")===!0){var i=0,t=this.id.match(isNumber),r=!0,u=!0;if(i=t==1?$(".inpAdult").val():$("#xRoom"+t+"_iAdults").val(),i==""||i==0?r=t==null?errorAlert("xiAdults","Should be at least 1 adult in Room 1"):errorAlert("xRoom"+t+"_iAdults","Should be at least 1 adult in Room"+t):"",r==!1)return!1;$("#"+this.id+' p[id^="pAge"] select').each(function(){if($(this).is(":visible")==!0){var i=$(this).val();i==""||i==null||i==0?(u=errorAlert(this.id,"Room"+t+": Child age is missing"),n++):$("#"+this.id+"").removeClass("errorClass")}})}if(!u)return!1;n--});n===0?hidedialogCont():""}function errorAlert(n,t){var i=$("#"+n+"").position();return $("#"+n+"").addClass("errorClass"),/qNACity/.test(n)?$("#"+n+"").val(t):alert(t),window.scroll(0,i.top-100),!1}function hidedialogCont(){var r,n,i,u,t,f;$("#xwCabin").val()==="No"?qcabin="":"";r=$("#xiRoomsAndPax").val();n=r.substring(0,1);$("#xiRoom").val(n);$("#xRooms").val(n);$("#xselRooms").val(n);n=n>1?n+" Rooms":n+" Room";i=r.split("|");t=0;u=/-/.test(i[1])?i[1].split("-"):i[1];for(p in u)t+=Number(u[p]);isNaN(t)?checkTotalPax()===!0?t=Number(totalPax):"":"";haveCook=0;f=n+", "+t+" Travelers";$("#xcabinRoomPax").val(f);$("#dvRoomPax").modal("hide")}function doitDeparture(n){$("#"+n+"").autocomplete({autoFocus:!0,source:depAirport,minLength:3,position:{my:"left top",at:"left bottom",collision:"flip"},response:function(n,t){if(t.content.length===0)return alert("No valid airport found"),!1},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("xtxt","xID")+"").val(i.item.id),n=="xtxtLeavingFrom"&&($("#xtxtReturningTo").val(i.item.value),$("#xIDReturningTo").val(i.item.id)),!1}}).click(function(){IsMobileDevice()?$("#"+n+"").val(""):$("#"+n+"").select()}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)}}function doAutoComple(n){$("#"+n).removeAttr("readonly");$("#"+n+"").autocomplete({autoFocus:!0,source:function(n,t){var i;n.term.length<4?i=new RegExp("^"+$.ui.autocomplete.escapeRegex(n.term),"i"):n.term.length>=4&&(i=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(n.term),"i"));t($.map(arrCty,function(n){if(i.test(n.value)||i.test(n.code))return n}))},minLength:3,position:{my:"left top",at:"left bottom",collision:"flip"},response:function(n,t){if(t.content.length===0)return alert("No valid European destination found"),!1},select:function(t,i){return $("#"+n+"").attr("value",i.item.value).hide().attr("readonly"),$("#"+n+"").val(i.item.value),$("#xArrCity"+n.match(isNumber)+"").text(i.item.value).show(),$("#"+n.replace("NA","ID")+"").val(i.item.id),newCitySeq(),!1},close:function(t){if($("#"+t.target.id.replace("NA","ID")+"").val()=="-1"){var r=$(this).data("ui-autocomplete").menu.element[0].children[0],u=$(".ui-autocomplete"),f=u.val(),i=$(r).text();$("#"+this.id+"").val(i);$("#dvMove"+this.id.match(isNumber)).removeClass("spCityName").addClass("spCityNameOff");$.map(arrCty,function(n){$.each(n.label,function(){n.label==i&&$("#"+t.target.id.replace("NA","ID")+"").val(n.id)})})}$("#"+n).attr("readonly","readonly");$("#"+n+"").attr("disabled","disabled")}}).click(function(){$("#"+this.id+"").val()!="type city name here"&&$("#"+this.id+"").val("type city name here");$("#"+this.id.replace("NA","ID")+"").val("-1");$(this).focus();$("#"+n+"").val("")}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)}}function newCitySeq(){if(cityValidation($('input[id^="xsCityNA"]').length)!=!1){var n=[];$('input[id^="xsCityNA"]').each(function(){var t=this.id.match(/[\d\.]+/g),i;t!=null&&(i=t+"|"+this.value+"|"+$("#xsCityID"+t+"").val(),n.push(i))});fixdates=0;itineraryModifed("0","0",n.join("$$$"))}}function cityValidation(n){for(i=1;i<=n;i++){if(i>n)return!0;if($("#xsCityID"+i+"").val()==-1){var t="'xsCityNA"+i+"'";return!1}}}function modifyTranspOption(n){var i=n.id.substring(0,n.id.length-1),t=i[i.length-1],r=Number(n.id.substring(n.id.length-1,n.id.length))+1,u=$('span[id^="'+i+'"]').length,f;r>u?r=1:"";i=i+r;u>1?($("#"+n.id+"").hide("slide",{direction:"up"},"fast").removeClass("spTransActive").addClass("spTransNoActive"),$("#"+i+"").show("slide",{direction:"up"},"fast").removeClass("spTransNoActive").addClass("spTransActive"),$("#xrdselTransField"+t+"").val($("#"+i+"").data("field")),$("#xrdselTrans"+t+"").val($("#"+i+"").data("type")),$("#xOverNts"+t+"").val($("#"+i+"").data("ovrnts")),/car/.test($("#"+i+"").find("img").attr("src"))===!0?($("#dvCarOpt"+t+"").slideDown("slow"),t==="S"?$("#xdropoffCityS option:first-child").attr("selected","selected").trigger("change"):($("#xdropoffCity"+t+" option:first-child").attr("selected","selected"),modifyDropCarCtyLast(t,$("#xdropoffCity"+t+"").val()))):$("#dvCarOpt"+t+"").is(":visible")===!0?(f=$("#xdropoffCity"+t+" option:selected").val(),$("#dvCarOpt"+t+"").slideUp("slow"),checkCarSelected(f,t),$("#xdropoffCity"+t+" option:selected").removeAttr("selected")):""):alert("Only this option.")}function checkCarSelected(n,t){var i,r;i=t==="S"?0:t;r=n;$(".dvMtravelto").each(function(){var n=this.id[this.id.length-1];n>i?($("#"+this.id+"").show(),$("#xrdselTransField"+n+"").val($("#"+this.id+"").show().find("span:visible").data("field"))):""})}function modifyDropCarCty(n){var i,t;console.log("modifyDropCarCty");i=n.id[n.id.length-1];console.log("objSeq = "+i);t=$("#"+n.id+"").find("option:selected").val();console.log("drpoff = "+t);$('div[id*="dvMtravelTo"]').each(function(){console.log("dvMtravelTo id = "+this.id.length);var n=this.id[this.id.length-1];i===n?"":t!="E"?(n<t?($("#"+this.id+"").hide(),$("#xrdselTransField"+n+"").val("")):"",n>=t?($("#"+this.id+"").show(),$("#xrdselTransField"+n+"").val($("#"+this.id+"").show().find("span:visible").data("field"))):""):($("#"+this.id+"").hide(),$("#xFIELDCity"+n+"").val(""))})}function modifyDropCarCtyLast(n,t){var i=n,r=t;$(".dvMtravelto").each(function(){var n=this.id[this.id.length-1];n>i?n<r?($("#"+this.id+"").hide(),$("#xrdselTransField"+n+"").val("")):"":""})}function addnewcity(n){var i=n.lang.split(","),u=i[0],t=i[1],r;if(t>12)return alert("For best results, no more than 12 cities is allowed. Thank."),!1;var f=Number(t)+Number(1),e='<div id="cityTo'+t+'" class="dvMTo"><div><span class="spCityNo">'+t+'<\/span><span class="spbtnicon"><\/span><br style="clear:both"/><\/div><span class="L"><p id="xArrCode'+t+'" class="parrcode"><\/p><p id="xArrCity'+t+'" class="parrcity"><\/p><input name="xsCityNA'+t+'" type="text" id="xsCityNA'+t+'" class="form-control mt-3" value="City name"/><input type="hidden" name="xsCityID'+t+'"  id="xsCityID'+t+'" value="-1"  /><input name="xsCityCO'+t+'" type="hidden" id="xsCityAPI'+t+'" value=""/><input name="xsCityAPI'+t+'" type="hidden" id="xsCityAPI'+t+'" value=""/><\/span><br style="clear:both"/><\/div>',o=$("#cityTo"+u);$(e).insertAfter(o);doAutoComple("xsCityNA"+t+"");$(".pMaddcity").attr("lang",t+","+f);r=$("#cityTo"+t).position();$("html,body").animate({scrollTop:r.top-200},400)}function resetPage(){Cookies.set("TMEDpkbyoBack","",{expires:-1});var n=document.URL.toLowerCase();window.location=n.replace("_pkbyo","_pk")}function itineraryModifed(n,t,i){var u={pkID:n,pkNA:t,itiSQ:i},r={};r.url=SiteName+"/BYOitinerary";r.type="POST";r.contentType="application/json; charset=utf-8";r.data=JSON.stringify(u);r.dataType="html";r.success=function(n){var r=$("<div>"+n+"<\/div>").find("#hasErr").text(),t,i;r==1&&alert("This itinerary city sequence can not be modified at this moment!");t=$("<div>"+n+"<\/div>").find("#xNACity1").val();$(".dvByoCityContainer").html(n);i=$("<div>"+n+"<\/div>").has("#cityToS");i[0]!=undefined&&$(".spSlegend").first().text("Transfer to"+t);AirCabin();dateByDest();newDest();indate=$("#inDatePromo").val();$("#inDatePromo").val()!=9999?$("#xtxtBYArriving").val(indate):"";(backCook!=null||backCook!=undefined)&&buildFromCookie2()};r.error=function(n){$("#dvCalContainerbyo").html(n.responseText)};$.ajax(r)}function submitToBook(){var i=$("#inpCities").val(),t,n;$("#xtotCities").val(i);t=$("#getNewItin").serialize();n="";n=JSON.stringify($("#getNewItin").serializeObject());Cookies.set("TMEDpkbyoBack",n,{expires:1});$.ajax({type:"POST",url:SiteName+"/Calendar/T4BuildComponentList",contentType:"application/json",data:JSON.stringify(t),dataType:"html",success:function(n){processResponseB(n)},error:function(n){$("#content").html(n.responseText);alert(n.responseText+" = error")}})}function processResponseB(n){window.ActiveXObject?$("#content").append(n):document.implementation&&document.implementation.createDocument?$("#content").append(n):alert("Your browser cannot handle this script");var t=$("#formSub").val(),i=$("#placeID").val();$("#utm_campaign").val()==""?$("#utm_campaign").val(""+utmValue+""):"";t==1&&(document.getElementById("frmToBook").action="https://reservation.tripmasters.com/Tourpackage4/Itinerary/Create?"+i,document.getElementById("frmToBook").submit())}function modifyDropOffOption(n){var t=$("#"+n.id+"").find("option:selected").val();$("#"+n.id.replace("Txt","")+"").val(t);modifyDropCarCty(n)}function IsMobileDevice(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Windows mobile/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Opera Mini/i)?!0:!1}var depAirport=[],arrAirport=[],arrCty=[],prevSq,stayLength=[],childAge=[],isNumber=/[0-9]+/g,totalPax=0,myDate=new Date,today=new Date,fixdates=[],blockdates=[],indate="",chilObj,airCabin,between;for(c=2;c<=11;c++)chilObj={label:c,value:c},childAge.push(chilObj);airCabin=[{label:"Coach",value:"Coach",id:"Y"},{label:"Premium Economy",value:"Premium Economy",id:"W"},{label:"Business",value:"Business",id:"C"},{label:"First Class",value:"First Class",id:"F"}];$(document).ready(function(){for(i=1;i<=14;i++){var n;n=i==1?{label:i+" night",value:i+" night",id:i}:{label:i+" nights",value:i+" nights",id:i};stayLength.push(n)}packID=$("#pakID").val();packNA=$("#pakNA").val();fixdates=$("#fixDates").val().split(",");blockdates=$("#blockDates").val().split("|");totCity=$("#inpCities").val();$("#xcabinRoomPax").click(function(){showdialog()});$("#dvpaxRoom").click(function(){openPaxRoomlist()});$("#dvpxroomlst li").click(function(){roomTravelers(this)});$('span[id^="adultPlus"]').click(function(){$('input[id^="xRoom'+Number(this.id.match(isNumber))+'_"').removeClass("errorClass");adultPlus(this)});$('span[id^="adultMinus"]').click(function(){$('input[id^="xRoom'+Number(this.id.match(isNumber))+'_"').removeClass("errorClass");adultMinus(this)});$('span[id^="childrenPlus"]').click(function(){childPlus(this)});$('span[id^="childrenMinus"]').click(function(){childMinus(this)});$('#xiAdults, input[id^="xRoom"], select[id^="xRoom"], select[id^=xiChild]').click(function(){$(this).removeClass("errorClass")});$(".spMbtnReset").click(function(){resetPage()});$(".spMnextbutt").click(function(){submitToBook()});dateByDest();$(".radioCtn input").click(function(){var n=$(this).val();switch(n){case"False":$("#dvLeavingFrom").hide("slow");$(".divAirAdvance").hide("slow");break;case"True":$("#dvLeavingFrom").show("slow");$(".divAirAdvance").show("slow")}});$(document.body).on("click",".iconEdit",function(){$("#xArrCity"+this.id+"").hide();$("#xsCityNA"+this.id+"").removeAttr("style");$("#xsCityNA"+this.id+"").removeAttr("disabled");$("#xsCityNA"+this.id+"").removeAttr("readonly");doAutoComple("xsCityNA"+this.id)});$(document.body).on("click",".iconUp",function(){var i=$(this).attr("id"),r=Number(i)-Number(1),n=$("#xsCityNA"+i+""),u=$("#xsCityID"+i+""),t=$("#xsCityNA"+r+""),f=$("#xsCityID"+r+""),e=$(n).val(),o=$(u).val(),s=$(t).val(),h=$(f).val();$(n).animate({"margin-top":"-100px",opacity:"0"},300,function(){$(n).val(s);$(t).val(e);$(u).val(h);$(f).val(o)});$(t).animate({opacity:"0","margin-top":"100px"},300);$(n).animate({"margin-top":"0px",opacity:"1"},300);$(t).animate({opacity:"1","margin-top":"0px"},300,function(){newCitySeq()})});$(document.body).on("click",".iconDwn",function(){var i=$(this).attr("id"),r=Number(i)+Number(1),n=$("#xsCityNA"+i+""),u=$("#xsCityID"+i+""),t=$("#xsCityNA"+r+""),f=$("#xsCityID"+r+""),e=$(n).val(),o=$(u).val(),s=$(t).val(),h=$(f).val();$(n).animate({"margin-top":"30px",opacity:"0"},300,function(){$(n).val(s);$(t).val(e);$(u).val(h);$(f).val(o)});$(t).animate({opacity:"0","margin-top":"-30px"},300);$(n).animate({"margin-top":"0px",opacity:"1"},300);$(t).animate({opacity:"1","margin-top":"0px"},300,function(){newCitySeq()})});$(document.body).on("click",".iconTrsh",function(){$("#cityTo"+this.id+"").remove();newCitySeq()});$(document.body).on("click",'span[id^="spTransRank"]',function(){modifyTranspOption(this)});$(document.body).on("click",".pMaddcity",function(){addnewcity(this)});$(".inpChild").autocomplete({autoFocus:!0,source:childAge,minLength:0,select:function(n,t){return $(this).val(t.item.value).blur(),!1},response:function(n,t){t.content.length===0&&(errorAlert(this.id,"No valid age"),$(this).blur())}}).click(function(){$(this).removeClass("errorClass");$(this).val("");$(this).attr("readonly",!1)}).focus(function(){$(this).keydown();$(this).attr("readonly",!0)}).blur(function(){($(this).val()==="0"||$(this).val()==="1")&&errorAlert(this.id,"No valid age")});$.ajax({type:"Get",url:SiteName+"/Api/Packages/DepCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t=n;depAirport=$.map(t,function(n){return{label:n.plC_Title+" - "+n.plC_Code,value:n.plC_Title,id:n.plcid,code:n.plC_Code}});doitDeparture("xtxtLeavingFrom");doitDeparture("xtxtReturningTo")},error:function(){}});$.ajax({type:"Get",url:SiteName+"/Api/Packages/PriorCity",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var t=n;arrCty=$.map(t,function(n){return{label:n.ctyNA+" - "+n.ctyCOD,value:n.ctyNA,id:n.ctyID,code:n.ctyCOD,dept:n.deptNA,hoapi:n.hotelAPI}})},error:function(n){alert(n.responseText)}});backCook=Cookies.get("TMEDpkbyoBack");backCook==null||backCook==undefined?itineraryModifed(packID,packNA):buildFromCookie1();$(document.body).on("change",'select[id^="xdropoffCityTxt"]',function(){modifyDropOffOption(this)});$("#DoneModal").click(function(){hidedialog()});$("#BackModal").click(function(){hidedialog()})});between=[];