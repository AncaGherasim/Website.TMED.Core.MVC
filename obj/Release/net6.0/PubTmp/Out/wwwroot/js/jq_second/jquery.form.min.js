(function(n){function t(){n.fn.ajaxSubmit.debug&&window.console&&window.console.log&&window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}n.fn.ajaxSubmit=function(i){function w(){function s(){var r,c,i,f;if(!p++){e.detachEvent?e.detachEvent("onload",s):e.removeEventListener("load",s,!1);r=!0;try{if(w)throw"timeout";if(i=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document,(i.body==null||i.body.innerHTML=="")&&!y){y=1;p--;setTimeout(s,100);return}t.responseText=i.body?i.body.innerHTML:null;t.responseXML=i.XMLDocument?i.XMLDocument:i;t.getResponseHeader=function(n){var t={"content-type":u.dataType};return t[n]};u.dataType=="json"||u.dataType=="script"?(f=i.getElementsByTagName("textarea")[0],t.responseText=f?f.value:t.responseText):u.dataType!="xml"||t.responseXML||t.responseText==null||(t.responseXML=b(t.responseText));c=n.httpData(t,u.dataType)}catch(l){r=!1;n.handleError(u,t,"error",l)}r&&(u.success(c,"success"),o&&n.event.trigger("ajaxSuccess",[t,u]));o&&n.event.trigger("ajaxComplete",[t,u]);o&&!--n.active&&n.event.trigger("ajaxStop");u.complete&&u.complete(t,r?"success":"error");setTimeout(function(){h.remove();t.responseXML=null},100)}}function b(n,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)):t=(new DOMParser).parseFromString(n,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var f=r[0],t,o,v,y;if(n(":input[name=submit]",f).length){alert('Error: Form elements must not be named "submit".');return}var u=n.extend({},n.ajaxSettings,i),l=n.extend(!0,{},n.extend(!0,{},n.ajaxSettings),u),a="jqFormIO"+(new Date).getTime(),h=n('<iframe id="'+a+'" name="'+a+'" src="about:blank" />'),e=h[0];if(h.css({position:"absolute",top:"-1000px",left:"-1000px"}),t={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;h.attr("src","about:blank")}},o=u.global,o&&!n.active++&&n.event.trigger("ajaxStart"),o&&n.event.trigger("ajaxSend",[t,u]),l.beforeSend&&l.beforeSend(t,l)===!1){l.global&&n.active--;return}if(!t.aborted){var p=0,w=0,c=f.clk;c&&(v=c.name,v&&!c.disabled&&(i.extraData=i.extraData||{},i.extraData[v]=c.value,c.type=="image"&&(i.extraData[name+".x"]=f.clk_x,i.extraData[name+".y"]=f.clk_y)));setTimeout(function(){var c=r.attr("target"),l=r.attr("action"),t,o;f.setAttribute("target",a);f.getAttribute("method")!="POST"&&f.setAttribute("method","POST");f.getAttribute("action")!=u.url&&f.setAttribute("action",u.url);i.skipEncodingOverride||r.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});u.timeout&&setTimeout(function(){w=!0;s()},u.timeout);t=[];try{if(i.extraData)for(o in i.extraData)t.push(n('<input type="hidden" name="'+o+'" value="'+i.extraData[o]+'" />').appendTo(f)[0]);h.appendTo("body");e.attachEvent?e.attachEvent("onload",s):e.addEventListener("load",s,!1);f.submit()}finally{f.setAttribute("action",l);c?f.setAttribute("target",c):r.removeAttr("target");n(t).remove()}},10);y=0}}var u,s,o,f,v,c,r,e,y,l,a,h,p;if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;if(typeof i=="function"&&(i={success:i}),u=n.trim(this.attr("action")),u&&(u=(u.match(/^([^#]+)/)||[])[1]),u=u||window.location.href||"",i=n.extend({url:u,type:this.attr("method")||"GET"},i||{}),s={},this.trigger("form-pre-serialize",[this,i,s]),s.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;if(o=this.formToArray(i.semantic),i.data){i.extraData=i.data;for(f in i.data)if(i.data[f]instanceof Array)for(v in i.data[f])o.push({name:f,value:i.data[f][v]});else o.push({name:f,value:i.data[f]})}if(i.beforeSubmit&&i.beforeSubmit(o,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[o,this,i,s]),s.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;for(c=n.param(o),i.type.toUpperCase()=="GET"?(i.url+=(i.url.indexOf("?")>=0?"&":"?")+c,i.data=null):i.data=c,r=this,e=[],i.resetForm&&e.push(function(){r.resetForm()}),i.clearForm&&e.push(function(){r.clearForm()}),!i.dataType&&i.target?(y=i.success||function(){},e.push(function(t){n(i.target).html(t).each(y,arguments)})):i.success&&e.push(i.success),i.success=function(n,t){for(var u=0,f=e.length;u<f;u++)e[u].apply(i,[n,t,r])},l=n("input:file",this).fieldValue(),a=!1,h=0;h<l.length;h++)l[h]&&(a=!0);return p=!1,i.iframe||a||p?i.closeKeepAlive?n.get(i.closeKeepAlive,w):w():n.ajax(i),this.trigger("form-submit-notify",[this,i]),this};n.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return n(this).ajaxSubmit(t),!1}).each(function(){n(":submit,input:image",this).bind("click.form-plugin",function(t){var i=this.form,r;i.clk=this;this.type=="image"&&(t.offsetX!=undefined?(i.clk_x=t.offsetX,i.clk_y=t.offsetY):typeof n.fn.offset=="function"?(r=n(this).offset(),i.clk_x=t.pageX-r.left,i.clk_y=t.pageY-r.top):(i.clk_x=t.pageX-this.offsetLeft,i.clk_y=t.pageY-this.offsetTop));setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},10)})})};n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin"),this.each(function(){n(":submit,input:image",this).unbind("click.form-plugin")})};n.fn.formToArray=function(t){var u=[],i,o,s,l,e,r,f,h,a;if(this.length==0||(i=this[0],o=t?i.getElementsByTagName("*"):i.elements,!o))return u;for(s=0,l=o.length;s<l;s++)if(e=o[s],r=e.name,r){if(t&&i.clk&&e.type=="image"){e.disabled||i.clk!=e||(u.push({name:r,value:n(e).val()}),u.push({name:r+".x",value:i.clk_x},{name:r+".y",value:i.clk_y}));continue}if(f=n.fieldValue(e,!0),f&&f.constructor==Array)for(h=0,a=f.length;h<a;h++)u.push({name:r,value:f[h]});else f!==null&&typeof f!="undefined"&&u.push({name:r,value:f})}if(!t&&i.clk){var v=n(i.clk),c=v[0],r=c.name;r&&!c.disabled&&c.type=="image"&&(u.push({name:r,value:v.val()}),u.push({name:r+".x",value:i.clk_x},{name:r+".y",value:i.clk_y}))}return u};n.fn.formSerialize=function(t){return n.param(this.formToArray(t))};n.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var f=this.name,r,u,e;if(f)if(r=n.fieldValue(this,t),r&&r.constructor==Array)for(u=0,e=r.length;u<e;u++)i.push({name:f,value:r[u]});else r!==null&&typeof r!="undefined"&&i.push({name:this.name,value:r})}),n.param(i)};n.fn.fieldValue=function(t){for(var f,i,r=[],u=0,e=this.length;u<e;u++)(f=this[u],i=n.fieldValue(f,t),i!==null&&typeof i!="undefined"&&(i.constructor!=Array||i.length))&&(i.constructor==Array?n.merge(r,i):r.push(i));return r};n.fieldValue=function(n,t){var l=n.name,r=n.type,s=n.tagName.toLowerCase(),f,e,i,u;if(typeof t=="undefined"&&(t=!0),t&&(!l||n.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!n.checked||(r=="submit"||r=="image")&&n.form&&n.form.clk!=n||s=="select"&&n.selectedIndex==-1))return null;if(s=="select"){if(f=n.selectedIndex,f<0)return null;var h=[],c=n.options,o=r=="select-one",a=o?f+1:c.length;for(e=o?f:0;e<a;e++)if(i=c[e],i.selected){if(u=i.value,u||(u=i.attributes&&i.attributes.value&&!i.attributes.value.specified?i.text:i.value),o)return u;h.push(u)}return h}return n.value};n.fn.clearForm=function(){return this.each(function(){n("input,select,textarea",this).clearFields()})};n.fn.clearFields=n.fn.clearInputs=function(){return this.each(function(){var n=this.type,t=this.tagName.toLowerCase();n=="text"||n=="password"||t=="textarea"?this.value="":n=="checkbox"||n=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};n.fn.resetForm=function(){return this.each(function(){typeof this.reset!="function"&&(typeof this.reset!="object"||this.reset.nodeType)||this.reset()})};n.fn.enable=function(n){return n==undefined&&(n=!0),this.each(function(){this.disabled=!n})};n.fn.selected=function(t){return t==undefined&&(t=!0),this.each(function(){var r=this.type,i;r=="checkbox"||r=="radio"?this.checked=t:this.tagName.toLowerCase()=="option"&&(i=n(this).parent("select"),t&&i[0]&&i[0].type=="select-one"&&i.find("option").selected(!1),this.selected=t)})}})(jQuery);