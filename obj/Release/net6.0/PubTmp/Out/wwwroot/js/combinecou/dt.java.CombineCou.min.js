function replaceChars(n){return n=$.trim(n),n=n.replace(", ","|"),n=n.replace(" and ","|"),n=n.replace("||","|"),n.substring(0,1)=="|"&&(n=n.substring(1,n.length)),n.substring(n.length-1,n.length)=="|"&&(n=n.substring(0,n.length-1)),n}function cutTitle(n,t){if(n!=""&&typeof n!="undefined"){var i="",r=$("#IDplace").val();i=$("#idPageTitleFCI").text();i=replaceChars(i);$("#"+n).hasClass("falsechecked_1")?(i=i+"|"+t,r=r+","+n.match(isNumber),$("#IDplace").val(r),fChangeTitName(i)):(i=i.replace(t,""),i=replaceChars(i),fChangeTitName(i))}}function initCitiesCheck(){var t="",n;if(t=$("#IDplace").val(),t!="")for(n=t.split(","),x=0;x<=n.length-1;x++)if(n[x]!=""&&n[x]!=undefined)$("#dotCou"+n[x]).prop("checked",!0);else return}function SetOptionForPresentFilter(){var t,r,u,f="",n;if(f=$("#StrFilter").val(),f!="")for(n=f.split("I"),i=0;i<=n.length-1;i++)if(n[i]!=""&&n[i]!=undefined){if(i==0)for(t=n[i].split("P"),j=0;j<=t.length-2;j++)$("#dotPrice"+t[j]).prop("checked",!0),$("#falsedotPrice"+t[j]).addClass("falsechecked_1");if(i==1)for(r=n[i].split("L"),j=0;j<=r.length-2;j++)$("#dotLen"+r[j]).prop("checked",!0),$("#falsedotLen"+r[j]).addClass("falsechecked_1");if(i==2)for(u=n[i].split("C"),j=0;j<=u.length-2;j++)$("#dotCou"+u[j]).prop("checked",!0),$("#falsedotCou"+u[j]).addClass("falsechecked_1")}}function EnableUnckechOption(){var i=$('input[type="checkbox"][id^="dotPrice"]:checked').length,n,t;i==0?($("#uncheckPrice").removeClass("UncheckOption"),$("#uncheckPrice").addClass("UncheckOptionDisabled")):($("#uncheckPrice").addClass("UncheckOption"),$("#uncheckPrice").removeClass("UncheckOptionDisabled"));n=$('input[type="checkbox"][id^="dotLen"]:checked').length;n==0?($("#uncheckLength").removeClass("UncheckOption"),$("#uncheckLength").addClass("UncheckOptionDisabled")):($("#uncheckLength").addClass("UncheckOption"),$("#uncheckLength").removeClass("UncheckOptionDisabled"));t=$('input[type="checkbox"][id^="dotCou"]:checked').length;t==0?($("#uncheckCities").removeClass("UncheckOption"),$("#uncheckCities").addClass("UncheckOptionDisabled")):($("#uncheckCities").addClass("UncheckOption"),$("#uncheckCities").removeClass("UncheckOptionDisabled"))}function UncheckOptions(n){if(n=="price"){if($("#uncheckPrice").hasClass("UncheckOptionDisabled"))return;$('input[type="checkbox"][id^="dotPrice"]:checked').each(function(){$(this).prop("checked",!1)});$('a[id^="falsedotPrice"]').each(function(){$(this).removeClass("falsechecked_1")});ShowPackets()}if(n=="length"){if($("#uncheckLength").hasClass("UncheckOptionDisabled"))return;$('input[type="checkbox"][id^="dotLen"]:checked').each(function(){$(this).prop("checked",!1)});$('a[id^="falsedotLen"]').each(function(){$(this).removeClass("falsechecked_1")});ShowPackets()}if(n=="city"){if($("#uncheckCities").hasClass("UncheckOptionDisabled"))return;$('input[type="checkbox"][id^="dotCou"]:checked').each(function(){$(this).prop("checked",!1)});$('a[id^="falsedotCou"]').each(function(){$(this).removeClass("falsechecked_1")});fChangeTitName("");$("#idPageTitleCpy").css("visibility","visible");$("#idPageTitleFCI").text("");$("#idPageTitleFCI").css("visibility","hidden");ShowPackets()}}function ShowOtherCities(n){var t=$("#"+n).css("display");t=="none"&&($("#"+n).show(),$("html, body").animate({scrollTop:$("#"+n).offset().top-30},300),$("#moreCitiesLink").hide(),$("#CloseMoreCitiesLink").show())}function CloseOtherCities(n,t){$("html, body").animate({scrollTop:$("#"+t).offset().top-30},300);$("#"+n).hide();$("#moreCitiesLink").show();$("#CloseMoreCitiesLink").hide()}function BuildFilterExpression(){var i="",n,t,r;return $('input[type="checkbox"][id^="dotPrice"]:checked').each(function(){i=i+$(this).val()+"P"}),n="",$('input[type="checkbox"][id^="dotLen"]:checked').each(function(){n=n+$(this).val()+"L"}),t="",$('input[type="checkbox"][id^="dotCou"]:checked').each(function(){t=$(this).val()+"C"+t}),r="",i+"I"+n+"I"+t}function ShowPackets(){var t;EnableUnckechOption();$("#dvResp").hide();$("#dvResp").html("");$("#dvWait").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>');$("#dvWait").show();t=BuildFilterExpression();$("#StrFilter").val(t);var i=$("#IDplace").val(),r=$("#IDCouNAme").val(),u=$("#OrderVal").val(),n={};n.url=SiteName+"/FindCusPackInfo";n.type="POST";n.contentType="application/json; charset=utf-8";n.data=JSON.stringify({plcID:i,plcNA:r,filter:t,OrderVal:u});n.dataType="html";n.success=function(n){$("#dvResp").html(n);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show();OpenPage(1)};n.error=function(n){$("#dvResp").html(n.responseText);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()};$.ajax(n)}function fChangeTitName(n){var r="",u="",t="",f;if(n!=""){if(n=replaceChars(n),t=n.split("|"),f=t.length,f==1)r='<a href="/europe/'+t[0].toLowerCase()+'/vacations">'+t[0]+"<\/a>",u=t[0];else for(i in t)i==f-1?(r=r+' | <a href="/europe/'+t[i].toLowerCase()+'/vacations">'+t[i]+"<\/a>",u=u+" - "+t[i]):i==0?(r=r+' <a href="/europe/'+t[i].toLowerCase()+'/vacations">'+t[i]+"<\/a>",u=t[i]):i<f&&(u=u+", "+t[i],r=r+' | <a href="/europe/'+t[i].toLowerCase()+'/vacations">'+t[i]+"<\/a>");$("#IDCouNAme").val(u);$("#idPageTitleFCI").text("");$("#navLinksTit").html("");$("#idPageTitleFCI").text(u);$("#navLinksTit").html(r)}else $("#navLinksTit").html(""),$("#idPageTitleFCI").text("")}function OpenPage(n){var e,f,r,t,u;if($("#dvPackets").hide(),$("#dvPackets").html(""),$("#dvWaitPacks").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>'),$("#dvWaitPacks").show(),$("#footer").css("visibility","hidden"),e=$("#TotalPacks").val(),f=$("#OrderVal").val(),f==""&&f=="0",$("#idOrderBy").val(f),r=Math.ceil(e/20),t="",t=n==1?'<span class="pgStyleDisabled">&lt;&lt;&nbsp;Previous<\/span>':'<span class="pgStyle"><a onclick="OpenPage('+(n-1)+')">&lt;&lt;&nbsp;Previous<\/a><\/span>',t=t+'<span style="color:black;font-weight:Bold;">&nbsp;|&nbsp;Page:&nbsp;<\/span>',r<=7)for(i=1;i<=r;i++)t=i!=n?t+'<span class="pgStyle"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="pgStyleSelected">'+i+"<\/span>";else if(n<5){for(i=1;i<=5;i++)t=i!=n?t+'<span class="pgStyle"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="pgStyleSelected">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="pgStyle"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else if(t=t+'<span class="pgStyle"><a onclick="OpenPage(1)">1<\/a><\/span>',t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>',n+2<r){for(i=n-1;i<=n+1;i++)t=i!=n?t+'<span class="pgStyle"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="pgStyleSelected">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="pgStyle"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else for(i=r-4;i<=r;i++)t=i!=n?t+'<span class="pgStyle"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="pgStyleSelected">'+i+"<\/span>";t=t+"&nbsp;|&nbsp;";t=n==r?t+'<span class="pgStyleDisabled">Next&nbsp;&gt;&gt;<\/span>':t+'<span class="pgStyle"><a onclick="OpenPage('+(n+1)+')">Next&nbsp;&gt;&gt;<\/a><\/span>';var s=$("#AllPackIds").val(),o=s.split("|"),h=$("#IDplace").val();o[n-1]!=""?(u={},u.url=SiteName+"/Api/PacksFindItinPage",u.type="POST",u.contentType="application/json; charset=utf-8",u.data=JSON.stringify({placeID:h,packsIds:o[n-1],OrderVal:f}),u.dataType="text",u.success=function(n){msg=n.substr(1,n.length-2);msg!=""&&(window.scrollTo(0,0),BuildPackets(msg),$('span[id^="idPages"]').html(""),$('span[id^="idPages"]').html(t));$("#header").css("visibility","visible");$("#footer").css("visibility","visible")},u.error=function(n){$("#dvPackets").html(n.responseText)},$.ajax(u)):($('select[id^="idOrderBy"]').prop("disabled","disabled"),$("#header").css("visibility","visible"),$("#dvWaitPacks").hide(),$("#dvWaitPacks").html(""),$("#dvPackets").html('<div style="margin:20px 20px 0px 20px;font-size:12px;color:navy;">0 itineraries found. Please try other combination.<\/div>'),$("#dvPackets").show())}function BuildPackets(n){var o,r,t="",c=$("#IDCouNAme").val(),u="",e="",h,f,s;n=n.replace("<div>","");n=n.replace("<\/div>","");o=n.split("@");for(i in o)if(i<o.length-1){if(r=o[i].split("|"),t=t+'<div style="width:96%; border-bottom: dashed 1px #bdbcbc; margin:0 10px;clear:both;">',t=t+'<div style="float:left; margin-left:5px; width:120px;"><img id="img'+r[0]+'" style="width:100px; height:100px;margin-top:15px" src="" alt=""/><\/div>',t=t+'<div style="float:left;width:540px;">',t=t+'<div class="Text_Arial16_BlueBold" style="margin-right:5px; padding-top:11px;clear:both;"><a class="Text_Arial16_BlueBold" href="'+SiteName+"/"+r[14].replace(/\s/g,"_").toLowerCase()+"/"+r[1].replace(/\s/g,"_").toLowerCase()+"/package-"+r[0]+'">'+r[1]+"<\/a>",r[13].indexOf("Partially")>=0?t=t+'&nbsp;<span><img id="imgPartiallyGuid'+ +r[0]+'" src="https://pictures.tripmasters.com/siteassets/d/GuidedPartially.jpg" alt="" style="vertical-align:middle;margin-top:-5px;" onMouseOver="showPopUp(this.id)" onMouseOut="hidePopUp(this.id)"/><\/span>':r[13].indexOf("Guided")>=0&&(t=t+'&nbsp;<span><img id="imgGuided'+ +r[0]+'" src="https://pictures.tripmasters.com/siteassets/d/Guided.jpg" alt="" style="vertical-align:middle;margin-top:-5px;" onMouseOver="showPopUp(this.id)" onMouseOut="hidePopUp(this.id)"/><\/span>'),t=t+"<\/div>",t=t+'<div style="margin-top:5px;">',r[3]!=""&&(r[6].indexOf("Inflexible package")==-1?(u=r[3]+" to "+(parseInt(r[3])+Math.round(parseInt(r[3])/2))+"+ nights",e="by selecting dates, No. of nights in each city and your departure city.",t=t+'<span id="ntsBubble'+r[0]+'" name="'+u.replace(/\s/g,"_")+"|"+e.replace(/\s/g,"_")+'" title="'+u.replace(/\s/g,"_")+"|"+e.replace(/\s/g,"_")+'" class="Text_12Arial_BlackBold" style="border-bottom:dashed 1px black;cursor:pointer;">'+u+"<\/span>"):(u=r[3]+" nights",e="by selecting date, and your departure city.",t=t+'<span id="ntsNoBubble'+r[0]+'" name="'+u.replace(/\s/g,"_")+"|"+e.replace(/\s/g,"_")+'" class="Text_12Arial_BlackBold">'+u+"<\/span>")),r[4]!=9999&&r[4]!=""&&(t=t+'&nbsp;from&nbsp;<span class="Text_Arial15_Orange"><b>'+formatCurrency(r[4],0)+"<\/b><\/span>"),t=t+"<\/div>",r[7]!="0"){var l=c.replace(/\s/g,"_"),v=l.split("_and_"),a=SiteName+"/"+r[14].toLowerCase()+"/"+r[1].replace(/\s/g,"_").toLowerCase()+"/feedback-"+r[0]+"";t=t+'<div style="margin-top:5px;"><a style="color:#4056c6;" href="'+a+'">Customer feedback ('+r[7]+') <img src="https://pictures.tripmasters.com/siteassets/d/FeedbackBox.gif" width="21" height="16" border="0"/><\/a><\/div>'}h=new RegExp(/<[^<>]+>/g);f=r[2];f=f.replace(h,"");f.length>400&&(f=f.substring(0,400),f=f+" ... ");t=t+'<div style="margin-top:15px;">'+f+"<\/div>";s="'divInfo"+r[0]+"'";t=t+'<div style="margin-top:8px;cursor:pointer;padding-bottom:20px;width:130px;"><img id="imgInfo'+r[0]+'" src="https://pictures.tripmasters.com/siteassets/d/PackageIncludes.jpg" onclick="dvOpenMain('+s+');"/><\/div>';t=t+'<div id="divInfo'+r[0]+'" style="display:none; border:solid 1px #1f67c8; width:450px; background-color:#FFF;position:absolute;">';t=t+'<div align="right" style="padding:3px 10px; font-size:12px;color:#4056c6;"><span style="cursor:pointer" onclick="dvCloseMain('+s+')">close [ - ]<\/span><\/div>';t=t+'<div class="Text_Arial16_BlueBold" style="margin:0px 20px 0px 20px;">'+r[1]+"<\/div>";t=t+'<div style="margin:5px 0px 0px 20px;">';r[3]!=""&&(t=t+'<span id="DivInfntsBubble'+r[0]+'" name="'+u.replace(/\s/g,"_")+"|"+e.replace(/\s/g,"_")+'" class="Text_12Arial_BlackBold">'+u+"<\/span>");r[4]!=9999&&r[4]!=""&&(t=t+'&nbsp;from&nbsp;<span class="Text_Arial15_Orange"><b>'+formatCurrency(r[4],0)+"<\/b><\/span>&nbsp;w/air,  hotel &amp; air taxes*");t=t+"<\/div>";r[4]!=9999&&r[4]!=""&&(t=t+'<div class="Text_12_Gray" style="margin:8px 20px 0px 20px;"> This sample price includes ALL air taxes & fuel surcharges: '+r[10]+" for arrival on "+r[8]+", departure from "+r[9]+". Choose your own departure city and dates.<\/div>");t=t+'<div class="Text_12Arial_BlackBold" style="margin:25px 0px 0px 20px;">This '+r[3]+" night sample itinerary includes:<\/div>";t=t+'<div style="margin:3px 30px 0px 20px;">'+r[5]+"<\/div>";t=t+'<div style="margin:20px auto; width:140px;"><a href="'+SiteName+"/"+r[14].replace(/\s/g,"_").toLowerCase()+"/"+r[1].replace(/\s/g,"_").toLowerCase()+"/package-"+r[0]+'"><img width="131" height="34" border="0" src="https://pictures.tripmasters.com/siteassets/d/MoreDetails.jpg"><\/a><\/div>';t=t+"<\/div>";t=t+"<\/div>";t=t+"<\/div>";i==4&&(t=t+'<div style="width:96%; margin:0 10px; border-top: dashed 1px #bdbcbc; padding:5px 0px 15px 0px; text-align:center;clear:both;"><a href="/build_your_own_vacation"><img src="https://pictures.tripmasters.com/siteassets/d/BuildOnYourOwn_Large.jpg" style="margin-top:10px;border-style:none;"/><\/a><\/div>')}o.length-1<=4&&(t=t+'<div style="width:96%; border-bottom: dashed 1px #bdbcbc; margin:0 10px; border-top: dashed 1px #bdbcbc; padding:5px 0px 15px 0px; text-align:center;clear:both;"><a href="/build_your_own_vacation"><img src="https://pictures.tripmasters.com/siteassets/d/BuildOnYourOwn_Large.jpg" style="margin-top:10px;border-style:none;"/><\/a><\/div>');$("#dvWaitPacks").hide();$("#dvWaitPacks").html("");$("#dvPackets").html(t);$("#dvPackets").show();$('span[id^="ntsBubble"]').each(function(){var n=$(this).prop("id"),t=$(this).prop("title");priceBubble(n,t.replace(/\_/g," "))});SetPictures(n)}function SetPictures(n){n=n.replace("<div>","");n=n.replace("<\/div>","");strMsg=n.split("@");for(i in strMsg)i<strMsg.length-1&&(strMsgLn=strMsg[i].split("|"),$("#img"+strMsgLn[0]).prop("src","https://pictures.tripmasters.com"+strMsgLn[12].toLowerCase()))}function getOrderValue(){var n=$("#idOrderBy option:selected").val();$("#OrderVal").val(n);ShowPackets()}function formatCurrency(n){n=n.toString().replace(/\$|\,/g,"");isNaN(n)&&(n="0");sign=n==(n=Math.abs(n));n=Math.floor(n*100+.50000000001);cents=n%100;n=Math.floor(n/100).toString();cents<10&&(cents="0"+cents);for(var t=0;t<Math.floor((n.length-(1+t))/3);t++)n=n.substring(0,n.length-(4*t+3))+","+n.substring(n.length-(4*t+3));return(sign?"":"-")+"$"+n}function priceBubble(n,t){$("#"+n+"").tooltip({position:{my:"center bottom-20",at:"center top",using:function(n,t){$(this).css(n);$("<div>").addClass("arrow").addClass(t.vertical).addClass(t.horizontal).appendTo(this)}},content:function(){var n=t.split("|");return'<div class="Text_Arial12" style="margin:10px">This packages is recommended for '+n[0]+".<br /><br /><b>Customize it <\/b> "+n[1]+"<\/div>"}})}function dvOpenMain(n){var t=$("#img"+n.replace("divInfo","")),i=$("#imgInfo"+n.replace("divInfo",""));$("#"+n+"").css("top",t.offset().top-4);$("#"+n+"").css("left",i.left);$("#"+n+"").show(300);$("html, body").animate({scrollTop:$("#"+n).offset().top-200},300)}function dvCloseMain(n){$("#"+n+"").hide(100)}function openLinkInNewWindow(n){var t=screen.width-300,i=screen.height-300,r,u,f=navigator.userAgent;r=screen.width?(screen.width-t)/2:0;u=screen.height?(screen.height-i)/2:0;settings=f.indexOf("Firefox")>=0?"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,toolbar=yes":f.indexOf("Chrome")>=0?"height="+i+",width="+t+",top="+u+",left="+r+"":"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,location=yes";window.open(n,"newWindow",settings)}var isNumber=/[0-9]+/g;$(document).ready(function(){initCitiesCheck();$("input:checkbox").each(function(){this.checked?$("#false"+this.id).addClass("falsechecked_1"):$("#false"+this.id).removeClass("falsechecked_1")});$(".falsecheck_1").click(function(){return $(this).hasClass("falsechecked_1")?$(this).removeClass("falsechecked_1"):$(this).addClass("falsechecked_1"),$(this.hash).trigger("click"),!1});$('a[id^="falsedotPrice"]').click(function(){ShowPackets()});$('a[id^="falsedotLen"]').click(function(){ShowPackets()});$('a[id^="falsedotCou"]').click(function(){$("#idPageTitleFCI").css("visibility","visible");$("#idPageTitleCpy").css("visibility","hidden");$("#idPageTitleCpy").text("");var n="",t="";t=$(this).prop("id");n=$(this).text();cutTitle(t,n);ShowPackets()});SetOptionForPresentFilter();ShowPackets();$('span[id^="ntsBubble"]').each(function(){$(this).tooltip()})});