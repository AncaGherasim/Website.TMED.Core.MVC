function getPacks(){var n=$("#placeID").val(),t={Id:n};$.ajax({type:"POST",url:SiteName+"/Api/All_Packages/GetAllPackages/",contentType:"application/json; charset=utf-8",data:JSON.stringify(t),success:function(n){console.log(n);pkObj=n;initpkObj=n;pkObj!=""&&$.each(pkObj,function(){this.pdL_Places!=null&&(pdlPlaceIds=pdlPlaceIds+this.pdL_Places)});pdlPlaceIds=pdlPlaceIds.substr(0,pdlPlaceIds.length-1);getCities(pdlPlaceIds);buildPkList();createPagination()},error:function(n){console.log(n.responseText)}})}function getCities(n){var t={Id:n};$.ajax({type:"POST",url:SiteName+"/Api/All_Packages/GetAllPlaces",contentType:"application/json; charset=utf-8",dataType:"text",data:JSON.stringify(t),success:function(n){console.log(JSON.parse(n));ctyObj=JSON.parse(n);$.each(JSON.parse(n),function(n,t){var i=$.grep(countries,function(n){return n.countryName===t.countryName});i.length===0&&countries.push(t)});buildCityList()},error:function(n){console.log(n.responseText)}})}function buildPkList(n,t){$(".dvPkList").html("");var r="",u=page*10,f=prevInt*nxtPg*10,e=pkObj.slice(f,u);n==undefined&&t==undefined?$(".spNoPks").text(pkObj.length):t==undefined&&$(".spNoPks").text(pkObj.length+" Filtered");$.each(e,function(){var t,n;for(r=r+"<div class='row pt-2 pb-2 border border-secondary border-top-0 border-right-0 border-left-0'><div class='col-4 pr-0'><img class='img-fluid' src='https://pictures.tripmasters.com"+this.imG_Path_URL.replace(" ","_")+"' /><\/div><div class='col-8 pl-0'><div class='col font14 blueText pr-0'>"+this.pdL_Title+"<\/div><div class='col'>",this.stP_NumOfNights!=""&&(r=this.spD_InternalComments.indexOf("Inflexible package")==-1?r+"<span class='font12 greyText'>"+this.stP_NumOfNights+" to "+(this.stP_NumOfNights+Math.round(this.stP_NumOfNights/2))+" nights<\/span>":r+"<span class='font12 greyText'>"+this.stP_NumOfNights+" nights<\/span>"),this.stP_Save!=9999&&this.stP_Save!=""&&(r=r+"<span class='font12 greyText'> from <b class='orgClr'>"+formatCurrency(this.stP_Save,0)+"*<\/b><\/span>"),r=r+"<\/div><div class='col'><button type='button' class='btn btn-link font12 pl-0' data-target='#dvPkDesc"+this.pdlid+"' data-toggle='collapse' aria-expanded='false'>Show Itinerary Details<\/button><\/div><div class='col'><a href='"+SiteName+"/"+this.countryName.replace(" ","_").toLowerCase()+"/"+this.pdL_Title.replace(" ","_").toLowerCase()+"/package-"+this.pdlid+"' class='btn btn-warning btn-block font14'>View It<\/a><\/div><\/div>",this.spD_Description!=""&&(t=new RegExp(/<[^<>]+>/g),this.spD_Description=this.spD_Description.replace(t,"")),r=r+"<div class='collapse font12' id='dvPkDesc"+this.pdlid+"'><div class='col-12 pt-4'>"+this.spD_Description+"<\/div><div class='col-12'>This sample price includes ALL air taxes & fuel surcharges: "+this.stP_MiniTitle+" for arrival on"+this.stP_StartTravelDate+", departure from "+this.plC_Title+". Choose your own departure city and dates.<\/div><div class='col-12'><span>This "+this.stP_NumOfNights+" night sample itinerary includes:<\/span><ul class='p-0 pl-3'>",n=this.pdL_Content.split(/\n/g),i=0;i<=n.length-1;i++)r=r+"<li>"+n[i]+"<\/li>";r=r+"<\/ul>";this.noOfFeed>0&&(r=r+"<div class='col-12 border border-secondary border-bottom-0 border-left-0 border-right-0 text-center'><a class='btn btn-link font12' href='"+SiteName+"/"+this.countryName.replace(" ","_").toLowerCase()+"/"+this.pdL_Title.replace(" ","_").toLowerCase()+"/feedback-"+this.pdlid+"'>See out Customer feedbacks ("+this.noOfFeed+")<\/a><\/div>");r=r+"<\/div><\/div><\/div>"});$(".dvPkList").append(r)}function buildCityList(){var n="";$.each(countries,function(t,i){n=n+"<div class='list-group-item list-group-item-action bg-white'><button type='button' class='btn btn-outline-light btn-block text-dark text-left pl-0 pr-0 border-0' data-target='#dvCityList"+i.countryId+"' data-toggle='collapse'>"+i.countryName+"<\/button><div class='collapse list-group-flush' id='dvCityList"+i.countryId+"'>";$.each(ctyObj,function(t,r){r.countryName==i.countryName&&(n=n+"<div class='list-group-item list-group-item-action bg-white'><input type='checkbox' name='radio-city' id='radiocity"+r.placeId+"' value='"+r.placeId+"' /><label for='radiocity"+r.placeId+"'>"+r.placeName+"<\/label><\/div>")});n=n+"<\/div><\/div>"});$("#dvCity").append(n);$("input[type='checkbox']").change(function(){var n="";$("input[type=checkbox]").each(function(){this.checked&&(n=n==""?n+$("label[for="+$(this).attr("id")+"]").html():n+","+$("label[for="+$(this).attr("id")+"]").html())});$(".typeCity").text(n)})}function createPagination(){prevInt=0;totPag=Math.ceil(pkObj.length/10);$(".totPag").text("Total: "+totPag);var n="";for(i=1;i<=totPag;i++)n=n+'<option value="'+i+'">'+i+"<\/option>";$(".selPage").html(n);$(".Page").removeClass("d-none").removeAttr("style");$(".pagePrev").parent().addClass("disabled");totPag==1?$(".pageNext").parent().addClass("disabled"):$(".pageNext").parent().removeClass("disabled")}function pagination(n,t){var i,r,u;if($(".pagePrev").parent().removeClass("disabled"),$(".pageNext").parent().removeClass("disabled"),i=t.value,n===undefined)prevInt=i-1,page=i,i==1&&$(".pagePrev").parent().addClass("disabled"),i==totPag&&$(".pageNext").parent().addClass("disabled"),$(".selPage option").each(function(){$(this).val()!=i?$(this).removeAttr("selected"):$(this).val()==i&&$(this).prop("selected","selected")});else if(i=parseInt($(".selPage").val()),n.id==="pagePrev"){if(i===0)return;r=i-1;page=r;prevInt=page-1;r==1&&$(".pagePrev").parent().addClass("disabled");$(".selPage option").each(function(){$(this).val()==i?$(this).removeAttr("selected"):$(this).val()==r&&$(this).prop("selected","selected")})}else n.id==="pageNext"&&($(".pagePrev").parent().removeClass("disabled"),page=i+1,prevInt=page-1,u=page-2,page==totPag&&$(".pageNext").parent().addClass("disabled"),$(".selPage option").each(function(){$(this).val()==i?$(this).removeAttr("selected"):$(this).val()==page&&$(this).prop("selected","selected")}));buildPkList(1,1)}function formatCurrency(n){n=n.toString().replace(/\$|\,/g,"");isNaN(n)&&(n="0");sign=n==(n=Math.abs(n));n=Math.floor(n*100+.50000000001);cents=n%100;n=Math.floor(n/100).toString();cents<10&&(cents="0"+cents);for(var t=0;t<Math.floor((n.length-(1+t))/3);t++)n=n.substring(0,n.length-(4*t+3))+","+n.substring(n.length-(4*t+3));return(sign?"":"-")+"$"+n}function orderFilterBy(n){var t;switch(!0){case/radiochoice/i.test(n.id):t=$("label[for="+n.id+"]").html();$(".typeOrder").text(t);break;case/radioprice/i.test(n.id):t=$("label[for="+n.id+"]").html();$(".typePrice").text(t);break;case/radionight/i.test(n.id):t=$("label[for="+n.id+"]").html();$(".typeStay").text(t)}}function applyFilter(){var t,n;pkObj=initpkObj;sortno=$("input[name=radio-choice]:checked").val();priceno=$("input[name=radioprice]:checked").val();lengthno=$("input[name=radio-night]:checked").val();t=[];$("input[type='checkbox']").each(function(){this.checked?t.push(this.value):""});n=[];t.length>0?$.each(t,function(t,i){$.each(pkObj,function(t,r){this.pdL_Places!=null&&this.pdL_Places.indexOf(i.toString()+",")>=0&&n.push(r)})}):n=initpkObj;priceno!=undefined&&(prInterval=priceno.split("_"),n=prInterval[1]!="MAX"?n.filter(n=>(n.stP_Save==9999?0:n.stP_Save)>=prInterval[0]&&(n.stP_Save==9999?0:n.stP_Save)<=prInterval[1]):n.filter(n=>(n.stP_Save==9999?0:n.stP_Save)>=prInterval[0]));lengthno!=undefined&&(lnInterval=lengthno.split("_"),n=lnInterval[1]!="MAX"?n.filter(n=>n.stP_NumOfNights>=lnInterval[0]&&n.stP_NumOfNights<=lnInterval[1]):n.filter(n=>n.stP_NumOfNights>=lnInterval[0]));switch(sortno){case"1":n=n.sort(function(n,t){return n.pdlid>t.pdlid?1:n.pdlid<t.pdlid?-1:0});break;case"2":n=n.sort(function(n,t){return n.stP_NumOfNights>t.stP_NumOfNights?1:n.stP_NumOfNights<t.stP_NumOfNights?-1:0});break;case"3":n=n.sort(function(n,t){return(n.stP_Save!=9999?n.stP_Save:0)>(t.stP_Save!=9999?t.stP_Save:0)?1:(n.stP_Save!=9999?n.stP_Save:0)<(t.stP_Save!=9999?t.stP_Save:0)?-1:0});break;case"4":n=n.sort(function(n,t){return(n.stP_Save!=9999?n.stP_Save:0)<(t.stP_Save!=9999?t.stP_Save:0)?1:(n.stP_Save!=9999?n.stP_Save:0)>(t.stP_Save!=9999?t.stP_Save:0)?-1:0});break;case"5":n=n.sort(function(n,t){return n.pdL_Title>t.pdL_Title?1:n.pdL_Title<t.pdL_Title?-1:0})}pkObj=n;buildPkList(1);createPagination();$("#dvFilter").modal("hide")}function resetFilters(){$("input:radio[name='radioprice']").each(function(){this.checked=!1});$(".typePrice").text("");$("input:radio[name='radio-night']").each(function(){this.checked=!1});$(".typeStay").text("");$("input[type=checkbox]").each(function(){this.checked=!1});$(".typeCity").text("");pkObj=initpkObj;buildPkList();createPagination();$("#dvFilter").modal("hide")}var $loader="<div class='loader'><\/div>",pkObj,initpkObj,page=1,prevInt=0,nxtPg=1,plcNA="",pdlPlaceIds="",countries=[],ctyObj,isNumber=/[0-9]+/g;$(document).ready(function(){$(".dvPkList").html($loader);plcNA=$("#placeNA").val();getPacks();$(document).on("click",".pageNext, .pagePrev",function(n){n.preventDefault();pagination(this,this)});$(".selPage").change(function(){pagination(this.val,this)});$(document).on("click",".btnReset",function(){resetFilters()});$(document).on("click",".btnApply",function(){applyFilter()});$(".list-group-item").click(function(){var n=$(this).children("input");$(this).children("input").prop("checked","checked");orderFilterBy(n[0])})});Number.prototype.between=function(n,t){return n<t?this>=n&&this<=t:this>=t&&this<=n};