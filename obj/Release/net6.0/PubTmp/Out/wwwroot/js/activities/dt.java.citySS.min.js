function setCheckboxOnly(n){n=="TypeFavorite"?$("#falseshowFav").trigger("click"):($('a[id^="falsedot"]').removeClass().addClass("falsecheck_1"),$('input[id^="dot"]').prop("checked",!1),$("#falsedot"+n).addClass("falsechecked_1"),$("#dot"+n).prop("checked",!0),GetCitySSData())}function BuildFilterExpression(){var n="",i,t,r;return $('input[type="checkbox"][id^="dotType"]:checked').each(function(){n=n+$(this).val()+"T"}),i="",i=$("#showFav").is(":checked")?"1":"0",t=$("#tourName").val(),t=="Type word"&&(t="none"),r=$('input[name="orderValue"]:checked').val(),n==""&&(n="999999T"),n+"|"+i+"|"+t+"|"+r}function GetCitySSData(){var i,t,n;$("#dvResp").hide();$("#dvResp").html("");$("#dvWait").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>');$("#dvWait").show();i=BuildFilterExpression();t=$("#SSIds").val();t.trim()!=""?(n={},n.url=SiteName+"/Api/CitySSData",n.type="POST",n.contentType="application/json; charset=utf-8",n.data='{"SSFilter":"'+i+'", "Ids":"'+t+'"}',n.dataType="text",n.success=function(n){msg=n.substr(1,n.length-2);var t=msg.split("@");$("#SSIdsPages").val(t[0]);$("#spanTotalSS").html("("+t[1]+" total)");$("#totalSS").val(t[1]);OpenPage(1)},n.error=function(n){$("#dvResp").html(n.responseText);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()},$.ajax(n)):($("#dvResp").html('<div style="margin:20px 20px 0px 20px;font-size:14px;color:#19255f;">0 activities found. Please try other combination.<\/div>'),$("#dvWait").html(""),$("#dvWait").hide(),$("#dvResp").show(),SetPages(0),$("#header").css("visibility","visible"))}function OpenPage(n){var t;$("body,html").animate({scrollTop:0},500);$("#dvResp").hide();$("#dvResp").html("");$("#dvWait").html('<img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif" width="50" height="50" /><\/br><\/br><div style="margin-let:10px;color:navy;">Loading ...<\/div>');$("#dvWait").show();var r=BuildFilterExpression(),u=r.split("|"),f=$("#SSIdsPages").val(),i=f.split("|");i[n-1]!=""?(t={},t.url=SiteName+"/Api/CityActivities",t.type="POST",t.contentType="application/json; charset=utf-8",t.data='{"SSFilter":"'+i[n-1]+'", "Ids":"'+u[3]+'"}',t.dataType="json",t.success=function(t){lcHtml="<div>";jQuery.each(t,function(){if(lcHtml=lcHtml+'<div class="dvEachPackContent"><div class="dvEachPkTop">',lcHtml=lcHtml+'<span class="spTopTitle" style="margin-bottom:0px;color: #19255f;">'+this.name+"<\/span>",this.pdL_SequenceNo>49&&this.pdL_SequenceNo<60&&(lcHtml=lcHtml+'<span class="spPackLength"><img src="https://pictures.tripmasters.com/siteassets/d/favorite.gif" alt=""/><\/span>'),lcHtml=lcHtml+'<br style="clear:both;"/><hr class="grayLine" style="margin:0px 0px 10px 0px; padding:0px;"/><div class="dvEachPkLeft" style="padding:0px;">',this.imG_Path_URL!="none"){var n=this.imG_Path_URL;lcHtml=lcHtml+'<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" alt=""/>'}else lcHtml=lcHtml+'<img src="https://pictures.tripmasters.com/siteassets/d/NoPicture.jpg" alt=""/>';lcHtml=lcHtml+"<\/div>";lcHtml=lcHtml+'<div class="dvEachPkRight" style="padding:0px; line-height:20px">'+this.spD_Description+"<\/div>";lcHtml=lcHtml+'<br style="clear:both;"/><div class="dvEachPkBottom dvbLighBlueBG" style="padding:0px!important;color:#000">';lcHtml=this.rating>0&&this.reviews>0?lcHtml+'<div><span style="color:Gray;">Score: <b style="color:#000">'+this.rating+'<\/b> out of 5 | <b style="color:#000">'+this.reviews+"<\/b> Reviews<\/span><\/div>":lcHtml+'<div><span style="color:Gray;">Score: <b style="color:#000">Not rated yet<\/b> | <b style="color:#000">'+this.reviews+"<\/b> Reviews<\/span><\/div>";lcHtml=lcHtml+'<div><span style="color:Gray;">Type:<\/span> '+this.scD_CodeTitle+"<\/div>";lcHtml=lcHtml+'<div ><span style="color:Gray;">Duration:<\/span> '+this.duration+" "+this.durationUnit+"<\/div>";lcHtml=lcHtml+"<div>";lcHtml=lcHtml+'<input type="button" value="Tour detail" class="bookItButton" onclick="OpenDivInfo(\'divInfo'+this.id+'\');" id="butInfo'+this.id+'" style=" padding: 2px 25px !important;text-decoration: underline;"/>';lcHtml=lcHtml+'<\/div><br style="clear:both;"/><\/div><\/div><\/div>';lcHtml=lcHtml+'<div id="divInfo'+this.id+'" style="display:none;border:solid 1px #1f67c8;width:450px;background-color:#FFF;position:absolute;">';lcHtml=lcHtml+'<div align="right" style="padding:3px 10px;font-size:12px;color:#4056c6;"><span onclick="CloseDivInfoMain(\'divInfo'+this.id+'\');" style="cursor:pointer">close [ - ]<\/span><\/div>';lcHtml=lcHtml+'<div style="margin:8px 20px 0px 20px;" class="Text_12_Gray">'+this.pdL_Description+" <\/div>";lcHtml=lcHtml+'<\/div><hr class="gradLine"/><\/div>'});SetPages(n);$("#dvResp").html(lcHtml);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()},t.error=function(n){$("#dvResp").html(n.responseText);$("#dvWait").html("");$("#dvWait").hide();$("#dvResp").show()},$.ajax(t)):($("#dvResp").html('<div style="margin:20px 20px 0px 20px;font-size:14px;color:#19255f;">0 activities found. Please try other combination.<\/div>'),$("#dvWait").html(""),$("#dvWait").hide(),$("#dvResp").show(),SetPages(0),$("#header").css("visibility","visible"))}function SetPages(n){var u=$("#totalSS").val(),r=Math.ceil(u/10),t="";if(t=t+"Page(s): ",n>0){if(r<=7)for(i=1;i<=r;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";else if(n<5){for(i=1;i<=5;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="spNumUnselect"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else if(t=t+'<span class="spNumUnselect"><a onclick="OpenPage(1)">1<\/a><\/span>',t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>',n+3<r){for(i=n-1;i<=n+2;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";t=t+'<span style="margin:0px 2px;color:Navy;">...<\/span>';t=t+'<span class="spNumUnselect"><a onclick="OpenPage('+r+')">'+r+"<\/a><\/span>"}else for(i=r-4;i<=r;i++)t=i!=n?t+'<span class="spNumUnselect"><a onclick="OpenPage('+i+')">'+i+"<\/a><\/span>":t+'<span class="spNumSelect">'+i+"<\/span>";$('div[id^="idPages"]').addClass("dvPaginNoContent").html(t);$('div[id="idPages2"] a').click(function(){scrollTo(0,0)})}else t=t+'<span class="spNumSelect">0<\/span>',$('div[id^="idPages"]').addClass("dvPaginNoContent").html(t),$('div[id="idPages2"] a').click(function(){scrollTo(0,0)})}function OpenDivInfo(n){var i=$("#butInfo"+n.replace("divInfo","")),t=$("#"+n+"");t.css("top",i.offset().top-4);t.css("left",i.offset().left-(t.width()-i.width())+20);t.css("z-index",9999);t.show(300);$("html, body").animate({scrollTop:t.offset().top-200},300)}function CloseDivInfoMain(n){$("#"+n+"").hide(100)}function getMapPoiData(n){ctylocLat=0;ctylocLong=0;var t=[],i=[],r={Id:n};$.ajax({type:"POST",url:SiteName+"/Api/Hotels/POIHotels/",contentType:"application/json; charset=UTF-8",data:JSON.stringify(r),success:function(n){var r,u,f;objPOI=n;r=0;jQuery.each(objPOI,function(){t.push(Number(this.poI_Latitude));i.push(Number(this.poI_Longitude));r++});u=(Math.max.apply(Math,t)-Math.min.apply(Math,t))/2+Math.min.apply(Math,t);f=(Math.max.apply(Math,i)-Math.min.apply(Math,i))/2+Math.min.apply(Math,i);delete distLats;distLats=getDistanceFromLatLonInKm(Math.max.apply(Math,t),Math.max.apply(Math,i),Math.min.apply(Math,t),Math.min.apply(Math,i));delete ctyLatLong;ctyLatLong=Number(u)+"|"+Number(f);preBuildMap(n)},error:function(n){$("#dvGoogleMap").html(n.responseText)}})}function getDistanceFromLatLonInKm(n,t,i,r){var u=deg2rad(i-n),f=deg2rad(r-t),e=Math.sin(u/2)*Math.sin(u/2)+Math.cos(deg2rad(n))*Math.cos(deg2rad(i))*Math.sin(f/2)*Math.sin(f/2),o=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e));return 6371*o}function deg2rad(n){return n*(Math.PI/180)}function preBuildMap(n){var t=$("#dvShowMap"),u=$("#dvPoiLink"),r=u.offset(),i;i=r.top<=600?100:r.top-300;t.attr("style"," top:"+i+"px;");t.attr("class","dvShowMap");t.show();$("html,body").animate({scrollTop:i-30},2e3);buildMapPoi(n)}function buildMapPoi(){var i,r;map=null;var t=ctyLatLong.split("|"),u=t[0],f=t[1],e=new google.maps.LatLng(u,f),n=10;switch(!0){case distLats<50:n=11;break;case distLats>50&&distLats<150:n=10;break;case distLats>150:n=9}i={zoom:n,center:e,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},panControl:!0,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("dvGoogleMap"),i);r=0;jQuery.each(objPOI,function(){var i,f,u;r++;var e=this.poI_Latitude,o=this.poI_Longitude,s=new google.maps.Point(4,25),t=new google.maps.Marker({icon:"https://pictures.tripmasters.com/siteassets/d/MapMarker_Ball__Orange_40.gif",position:new google.maps.LatLng(e,o),map:map,draggable:!1,raiseOnDrag:!0,labelAnchor:s,labelInBackground:!1,labelStyle:{opacity:1},title:this.POI_Title,zIndex:8998}),n='<div class="dvBublleStyle">';this.POI_PictureURL!="none"&&(n=n+'<img src="'+this.poI_PictureURL+'" align="left"/>');n=n+"<div>"+this.poI_Title+"<\/div>";this.POI_Description!="none"&&(n=n+this.poI_Description);n=n+"<\/div>";i=new google.maps.InfoWindow({content:n,size:new google.maps.Size(40,40)});google.maps.event.addListener(t,"click",function(){closePoiInfoW(map,t,i)});infoPOIWindows.push(i);f=this.POI_Title;u=new google.maps.InfoWindow({content:f,size:new google.maps.Size(20,20)});google.maps.event.addListener(t,"mouseover",function(){u.open(map,t)});google.maps.event.addListener(t,"mouseout",function(){u.close(map,t)})})}function closePoiInfoW(n,t,i){for(var r=0;r<infoPOIWindows.length;r++)infoPOIWindows[r].close();i.open(n,t)}function getHotClosePoiData(n,t,i){for(var f,e,u,r=0;r<infoPOIWindows.length;r++)infoPOIWindows[r].getMap()&&(infoPOIWindows[r].setContent('<div style="height:auto; padding:10px 10px;" ><img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif"><br/>... loading hotels<\/div>'),u=infoPOIWindows[r]);for(r=0;r<markerHotels.length;r++)markerHotels[r].setMap(null);f=new google.maps.LatLng(t,i);e=15;map.setZoom(e);map.panTo(f);$.ajax({type:"POST",url:"/europe/WS_Library.asmx/getHotelClosePOI",contentType:"application/json; charset=utf-8",dataType:"json",data:'{plcID:"'+n+'", hLat:"'+t+'", hLong:"'+i+'"}',success:function(n){objHOT=eval("("+n.d+")");objHOT.length>0?(u.close(),buildHotelPoi(n)):u.setContent('<div style="height:auto; padding:10px 10px;" >No closer hotels found<\/div>')},error:function(n){alert(n.responseText)}})}function buildHotelPoi(){var n=0;jQuery.each(objHOT,function(){var u;n++;var f=this.PTY_Latitude,e=this.PTY_Longitude,r=this.SCD_CodeTitle.match(isNumber),o="hotel_"+r+"stars_GR.png",s=new google.maps.Point(-13,39),i=new google.maps.Marker({position:new google.maps.LatLng(f,e),map:map,draggable:!1,raiseOnDrag:!0,icon:"https://pictures.tripmasters.com/siteassets/d"+o,labelContent:'<div class="bubbleH">'+this.PDL_Title+"<\/div>",labelAnchor:s,labelInBackground:!1,labelStyle:{opacity:.75},title:this.PDL_Title,zIndex:8998}),t='<div class="dvHotBubble">';this.IMG_Path_URL!="none"&&(t=t+'<div class="dvimgHot"><img src="https://pictures.tripmasters.com'+this.IMG_Path_URL.toLowerCase()+'"/><\/div>');t=t+'<div class="dvaddHot"><span>'+this.PDL_Title+'<\/span><br/><img src="https://pictures.tripmasters.com/siteassets/d/Stars_'+r+'_Stars.gif"/><p>'+this.PTY_Address+"<\/p><\/div>";this.POI_Description!="none"&&(t=t+'<div class="dvdescHot">'+this.PTY_Description+"<\/div>");t=t+"<\/div>";u=new google.maps.InfoWindow({content:t,size:new google.maps.Size(40,40)});google.maps.event.addListener(i,"click",function(){u.open(map,i)});markerHotels.push(i)})}function windowCMS(n,t,i){var r,u,f,e=navigator.userAgent,s=document.domain,o="/cms/"+n+"?cms&wh=0&wf=0";r=screen.width?(screen.width-t)/2:0;u=screen.height?(screen.height-i)/2:0;f=e.indexOf("Firefox")>=0?"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,toolbar=yes":e.indexOf("Chrome")>=0?"height="+i+",width="+t+",top="+u+",left="+r+"":"height="+i+",width="+t+",top="+u+",left="+r+",scrollbars=yes,resizable,location=yes";window.open(o,"CMS_Window",f)}function popError(n,t){var i=$("#"+n+"").offset();$("#divError").html(t);$("#divError").show();$("#divError").offset({left:i.left-10,top:i.top-50});setTimeout("$('#divError').hide()",2e3)}function closeClick(n){$("#divError").hide();IsMobileDevice()&&$("#"+n+"").val("");$("#"+n+"").select()}var ctyID,infoPOIWindows=[],objPOI,map,ctylocLat,ctylocLong,objHotPOI;$(document).ready(function(){$("input:checkbox").each(function(){this.checked?$("#false"+this.id).addClass("falsechecked_1"):$("#false"+this.id).removeClass("falsechecked_1")});$(".falsecheck_1").click(function(){return $(this).hasClass("falsechecked_1")?$(this).removeClass("falsechecked_1"):$(this).addClass("falsechecked_1"),$(this.hash).trigger("click"),!1});var n,t;$('div[id^="Type"]').hover(function(){n=$(this).attr("id");t=$.trim($("#"+n).text());t.length>=28&&$("#falsedot"+n).text(t.substr(0,26)+"..");$(this).css({"background-color":"#E9EEF8","border-radius":"3px"});var i="'"+n+"'";$(this).append('<span style="position:relative; float:right; top:-21px; right:13px; color:#6C8BC6;text-decoration:underline;cursor:pointer;" onclick="setCheckboxOnly('+i+')"> only <\/span>')},function(){$(this).css("background-color","");$(this).find("span:last").remove();$("#falsedot"+n).text(t)});$('a[id^="falsedotType"]').click(function(){GetCitySSData()});$(".ResetFilter").click(function(){$('a[id^="falsedotType"]').removeClass().addClass("falsecheck_1").addClass("falsechecked_1");$('input[type="checkbox"][id^="dotType"]').prop("checked",!0);GetCitySSData()});$("#falseshowFav").click(function(){GetCitySSData()});$('input[type="radio"][name="orderValue"]').click(function(){GetCitySSData()});ctyID=$("#cityId").val();$("#dvPoiMap").length>0&&($("#dvPoiMap, #dvPoiLink").click(function(){getMapPoiData(ctyID)}),$(".dvmapClose").click(function(){$("#dvShowMap").hide()}));$('input:text[id^="tourName"]').click(function(){var n=navigator.userAgent.match(/iPad/i)!=null;(n=!0)&&(this.value="");this.focus();this.select()});$("#tourName").focusout(function(){$(this).val()==""&&$(this).val("Type word")});$("#tourName").keypress(function(n){if(n.keyCode==13){var t=$("#tourName").val();if(t==""||t=="Type word"){messg="<ol><li>Please insert an activity name!<\/li><\/ol><span><\/span>";popError("tourName",messg);return}GetCitySSData()}});$('input[type="button"][name="Go"]').click(function(){var n=$("#tourName").val();if(n==""||n=="Type word"){messg="<ol><li>Please insert an activity name!<\/li><\/ol><span><\/span>";popError("tourName",messg);return}GetCitySSData()});GetCitySSData()});ctylocLat=0;ctylocLong=0;