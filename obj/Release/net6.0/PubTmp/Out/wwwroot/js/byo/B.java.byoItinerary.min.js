function carSelected(n){var r=$(".dvEachContent").length,f,i,u,e,t;for(n.substr(n.length-2,1)=="S"?i="S":(f=n.replace(/[^0-9]/g,""),i=f),i==="S"?(i=1,r=Number(r)-1):i=Number(i)+1,u=$("#xdropoffCity"+f+"").val(),u==="E"?$("#dvcity_S").length===1?(u=$(".dvEachContent").length-1,r=Number(r)-1):u=r:"",e=0,t=i;t<=r;t++)t<u?($("#xrdselTransField"+t+"").val(""),$('p[id^="dvRadios'+t+"").attr("class","ptranspSelNoAct"),$("#dvCarSet"+t+"").is(":visible")===!0?$($("#dvCarSet"+t+"").hide()):""):"",t>=u?($("#xrdselTransField"+t+"").val($("#xradioTrans"+t+'[data-rank="1"]').data("field")),$('p[id^="dvRadios'+t+"").attr("class","ptranspSelAct"),$("#dvCarSet"+t+"").val()==="TBA"?($("#dvCarSet"+t+"").show(),t++):""):""}function openMask(){var n=$(document).height();$(".mask").css({height:n});$(".mask").fadeIn(1e3);$(".mask").fadeTo("slow",.8)}function highlightText(n,t){for(var f=$.trim(n).toLowerCase(),i=t.get(0).firstChild,e,u,r;(e=i.data.toLowerCase().indexOf(f))>=0;)u=i.splitText(e),i=u.splitText(f.length),r=document.createElement("span"),r.className="highlight",i.parentNode.insertBefore(r,i),r.appendChild(u)}function doitDeparture(n){$("#"+n+"").autocomplete({autoFocus:!0,source:depAirport,minLength:3,position:{my:"left top",at:"left bottom",collision:"flip"},response:function(n,t){if(t.content.length===0)return alert("No valid airport found"),!1},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("xtxt","xID")+"").val(i.item.id),n=="xtxtLeavingFrom"&&($("#xtxtReturningTo").val(i.item.value),$("#xIDReturningTo").val(i.item.id)),!1}}).click(function(){IsMobileDevice()?$("#"+n+"").val(""):$("#"+n+"").select()}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)}}function doAutoComple(n){$("#"+n).removeAttr("readonly");$("#"+n+"").autocomplete({autoFocus:!0,source:function(n,t){var i;n.term.length<4?i=new RegExp("^"+$.ui.autocomplete.escapeRegex(n.term),"i"):n.term.length>=4&&(i=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(n.term),"i"));t($.map(arrCty,function(n){if(i.test(n.value)||i.test(n.code))return n}))},minLength:3,position:{my:"left top",at:"left bottom",collision:"flip"},response:function(n,t){if(t.content.length===0)return alert("No valid Europe destination found"),!1},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("NA","ID")+"").val(i.item.id),$("#dvMove"+this.id.match(isNumber)).removeClass("spCityName").addClass("spCityNameOff"),$("#"+n+"").attr("disabled","disabled"),newCitySeq(),!1},close:function(t){if($("#"+t.target.id.replace("NA","ID")+"").val()=="-1"){var r=$(this).data("ui-autocomplete").menu.element[0].children[0],u=$(".ui-autocomplete"),f=u.val(),i=$(r).text();$("#"+this.id+"").val(i);$("#dvMove"+this.id.match(isNumber)).removeClass("spCityName").addClass("spCityNameOff");$.map(arrCty,function(n){$.each(n.label,function(){n.label==i&&$("#"+t.target.id.replace("NA","ID")+"").val(n.id)})})}$("#"+n).attr("readonly","readonly");$("#"+n+"").attr("disabled","disabled")}}).click(function(){$("#"+this.id+"").val()!="type city name here"&&$("#"+this.id+"").val("type city name here");$("#"+this.id.replace("NA","ID")+"").val("-1");$(this).focus();IsMobileDevice()?$("#"+n+"").val(""):$("#"+n+"").select()}).data("ui-autocomplete")._renderItem=function(n,t){var i=$("<span><\/span>").text(t.label);return highlightText(this.term,i),$("<li><\/li>").append(i).appendTo(n)}}function doitStay(n){$("#"+n+"").autocomplete({autoFocus:!0,source:stayLength,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("xOfNtsTxt","xselNoOfNts")+"").val(i.item.id),$("#xrdAWair").focus(),$(this).removeAttr("style"),!1}}).click(function(){$(this).val("");$(this).attr("style","border:1px solid #666;")}).focus(function(){$(this).keydown()})}function doitCar(n){var r=[],u,t;if(n.indexOf("Place")>0)r=carTake,carAutoComplete(n,r);else if(n.indexOf("Day")>0)r=carDay,carAutoComplete(n,r);else if(n.indexOf("City")>0&&n.match(isNumber)!=undefined)for(u=$("#carCities"+n.match(isNumber)+"").val().split("$$$"),i=0;i<=u.length-1;i++)t=u[i].split("|"),t[0]=="E"||t[0]=="S"?r.push({text:t[1]+'<font size="3">&raquo;<\/font> '+t[0],value:t[1]}):r.push({label:t[1]+". "+t[0],value:t[1]+". "+t[0],id:t[1]}),i==u.length-1&&carAutoComplete(n,r);else for(u=$("#carCitiesS").val().split("$$$"),i=0;i<=u.length-1;i++)t=u[i].split("|"),t[0]=="E"||t[0]=="S"?r.push({text:t[1]+'<font size="3">&raquo;<\/font> '+t[0],value:t[1]}):t[1]=="E"||t[1]=="S"?r.push({text:t[0],value:t[0]}):r.push({label:t[1]+". "+t[0],value:t[1]+". "+t[0],id:t[1]}),i==u.length-1&&carAutoComplete(n,r)}function carAutoComplete(n,t){$("#"+n+"").autocomplete({autoFocus:!0,source:t,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Txt","")+"").val(i.item.id),n.slice(-1).match(isNumber)?carDropOffX(i.item.id,n.match(isNumber)):carDropOffX(i.item.id,n.slice(-1)),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()});delete t}function doitPaxRoom(n){var t=[];switch(n){case"xiRoomsAndPaxText":t=paxRooms;$("#"+n+"").autocomplete({autoFocus:!0,source:t,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Text","")+"").val(i.item.id),xchangePaxByRoom(i.item.id),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("").select()}).focus(function(){$(this).keydown()});break;case"xiAdultsText":t=adultPax;$("#"+n+"").autocomplete({autoFocus:!0,source:adultPax,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Text","")+"").val(i.item.value),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()});break;case"xiChildrenText":t=childPax;$("#"+n+"").autocomplete({autoFocus:!0,source:childPax,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Text","")+"").val(i.item.value),$("#xrdAWair").focus(),xSelChildren(i.item.value,1,1),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()});break;default:n.indexOf("_iAdults")>-1?(t=adultPax,$("#"+n+"").autocomplete({autoFocus:!0,source:adultPax,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Text","")+"").val(i.item.value),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()})):n.indexOf("_iChildren")>-1&&(t=childPax,$("#"+n+"").autocomplete({autoFocus:!0,source:childPax,minLength:0,position:{collision:"flip"},select:function(t,i){return $("#"+n+"").val(i.item.value),$("#"+n.replace("Text","")+"").val(i.item.value),$("#xrdAWair").focus(),xSelChildren(i.item.value,n.match(isNumber),1),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()}))}delete n}function newDest(){$('input:text[id^="xOfNtsTxt"]').each(function(){doitStay(this.id)});$('input:text[id^="xpickup"]').each(function(){doitCar(this.id)});$('input:text[id^="xdropoff"]').each(function(){doitCar(this.id)})}function setUpDownMove(){$(".iconUp").click(function(){var i=$(this).attr("id"),r=Number(i)-Number(1),n=$("#xsCityNA"+i+""),u=$("#xsCityID"+i+""),t=$("#xsCityNA"+r+""),f=$("#xsCityID"+r+""),e=$(n).val(),o=$(u).val(),s=$(t).val(),h=$(f).val();$(n).animate({"margin-top":"-30px",opacity:"0"},300,function(){$(n).val(s);$(t).val(e);$(u).val(h);$(f).val(o)});$(t).animate({opacity:"0","margin-top":"30px"},300);$(n).animate({"margin-top":"0px",opacity:"1"},300);$(t).animate({opacity:"1","margin-top":"0px"},300,function(){newCitySeq()})});$(".iconDwn").click(function(){var i=$(this).attr("id"),r=Number(i)+Number(1),n=$("#xsCityNA"+i+""),u=$("#xsCityID"+i+""),t=$("#xsCityNA"+r+""),f=$("#xsCityID"+r+""),e=$(n).val(),o=$(u).val(),s=$(t).val(),h=$(f).val();$(n).animate({"margin-top":"30px",opacity:"0"},300,function(){$(n).val(s);$(t).val(e);$(u).val(h);$(f).val(o)});$(t).animate({opacity:"0","margin-top":"-30px"},300);$(n).animate({"margin-top":"0px",opacity:"1"},300);$(t).animate({opacity:"1","margin-top":"0px"},300,function(){newCitySeq()})});$(".iconTrsh").click(function(){$("#dvcity_"+this.id+"").remove();newCitySeq()});$(".iconEdit").click(function(){$("#dvMove"+this.id+"").removeClass("spCityNameOff").addClass("spCityName");$("#xsCityNA"+this.id+"").removeAttr("disabled");doAutoComple("xsCityNA"+this.id)})}function newCitySeq(){if(cityValidation($('input[id^="xsCityNA"]').length)!=!1){var n=[];$('input[id^="xsCityNA"]').each(function(){var t=this.id.match(/[\d\.]+/g),i;t!=null&&(i=t+"|"+this.value+"|"+$("#xsCityID"+t+"").val(),n.push(i))});fixdates=0;itineraryModifed("0","0",n.join("$$$"))}}function cityValidation(n){for(i=1;i<=n;i++){if(i>n)return!0;if($("#xsCityID"+i+"").val()==-1){var t="'xsCityNA"+i+"'",r='Please select a valid city!  <br> <a href="javascript:closeClick('+t+')">OK<\/a>';return popCalError("xsCityNA"+i,r),!1}}}function itineraryModifed(n,t,i){$("#dvWait").show();$("#dvCalContainerbyo").hide();var u={pkID:n,pkNA:t,itiSQ:i},r={};r.url=SiteName+"/BYOitinerary";r.type="POST";r.contentType="application/json; charset=utf-8";r.data=JSON.stringify(u);r.dataType="html";r.success=function(r){var u=$("<div>"+r+"<\/div>").find("#hasErr").text();if(u=="1"){alert("This itinerary city sequence cannot be modified at this moment!");prevSq==undefined?itineraryModifed(packID,packNA):itineraryModifed(n,t,prevSq);return}$("#dvCalContainerbyo").html(r);$(".spChange").click(function(){var n;this.id.match(isNumber)==null?(n="dvRadios"+this.id.slice(-1),$("#"+n+"").children(".spShowChk").removeClass("spShowChk").addClass("spShow"),$("#"+n+"").children(".spHide").removeClass("spHide").addClass("spShow"),$("#"+n+"").children(".spChange").toggle()):(n="dvRadios"+this.id.match(isNumber),$("#"+n+"").children(".spShowChk").removeClass("spShowChk").addClass("spShow"),$("#"+n+"").children(".spHide").removeClass("spHide").addClass("spShow"),$("#"+n+"").children(".spChange").toggle())});prevSq=i;setUpDownMove();getTraveldate();newDest();(backCook!=null||backCook!=undefined)&&buildFromCookie2();$("#dvWait").hide();$("#dvCalContainerbyo").show()};r.error=function(n){$("#dvCalContainerbyo").html(n.responseText)};$.ajax(r)}function relIntForm(n,t){Cookies.set("dateVAL","",{expires:-1});Cookies.set("TMEDpkbyoBack","",{expires:-1});window.location=n+"?relItin="+t}function listbox_move(n,t){var r=document.getElementById(n),i=r.selectedIndex,u,f,e;if(-1==i){alert("Please select an option to move.");return}(u=-1,u=t=="up"?-1:1,i+u<0||i+u>r.options.length-1)||(f=r.options[i].value,e=r.options[i].text,r.options[i].value=r.options[i+u].value,r.options[i].text=r.options[i+u].text,r.options[i+u].value=f,r.options[i+u].text=e,r.selectedIndex=i+u)}function listbox_moveacross(n,t){for(var f,r,u=document.getElementById(n),e=document.getElementById(t),i=0;i<u.options.length;i++)if(u.options[i].selected==!0){f=u.options[i];r=document.createElement("option");r.value=f.value;r.text=f.text;r.selected=!0;try{e.add(r,null);u.remove(i,null)}catch(o){e.add(r);u.remove(i)}i--}}function listbox_selectall(n,t){for(var r=document.getElementById(n),i=0;i<r.options.length;i++)r.options[i].selected=t}function qaddCity(n,t){var i,r,u;if(i="",t>12)return alert("For best results, no more than 12 cities is allowed. Thank."),!1;i="<!-- City "+t+" -->";i=i+'<div class="dvEachCity" id="dvcity_'+t+'">';i=i+'<div class="dvNumber"><span>'+t+"<\/span><\/div>";i=i+'<div class="dvAction"><img src="https://pictures.tripmasters.com/siteassets/d/spacer.gif" width="16" height="16" align="absmiddle"/>';i=i+"<\/div>";i=i+'<div class="dvContent">';i=i+'<input type="text" name="xsCityNA'+t+'" id="xsCityNA'+t+'" value="type city name here" style="position:absolute; overflow:hidden;" class="impTextFirst"/>';i=i+'<input name="xsCityID'+t+'" type="hidden" id="xsCityID'+t+'" value="-1"/>';i=i+"<\/div>";i=i+'<div class="dvClear"> <\/div>';i=i+"<\/div>";i=i+"<!-- End City "+t+" -->";r=$("#dvcity_"+n);$(i).insertAfter(r);u=Number(t)+1;totCity=t;$("#xtotCities").val(totCity);$("#inpCities").val(t);doAutoComple("xsCityNA"+t+"");$("#URLinpCities").attr("href","javascript:qaddCity("+t+", "+u+");")}function insertAfter(n,t){n.parentNode.insertBefore(t,n.nextSibling)}function qDelCty(n){$("#dvcity_"+n+"").remove();newCitySeq()}function rdonChangeX(n,t,i,r,u){var f,e;f=t;t=="S"&&(f="'"+t+"'");$("#xrdselTransField"+t+"").val(u);switch(n){case"C":$("#dvCarSet"+t).show();e=$("#xdropoffCity"+t+"").val();carDropOffX(e,t);radiosStyle(t);break;case"T":$("#dvCarSet"+t).hide();$("#troverNts"+t+r).show();ResetTrasportOptions(t);radiosStyle(t);break;case"O":$("#dvCarSet"+t).hide();ResetTrasportOptions(t);radiosStyle(t);break;case"A":case"W":case"G":$("#dvCarSet"+t).hide();ResetTrasportOptions(t);radiosStyle(t)}}function radiosStyle(n){var t="dvRadios"+n;$("#"+t+" input:radio").each(function(){this.checked&&$(this).parent().removeClass("spShow").addClass("spShowChk")});$("#"+t+"").children(".spShow").removeClass("spShow").addClass("spHide");$("#"+t+"").children(".spChange").toggle()}function ResetTrasportOptions(n){var t=!1;$('div[id^="dvcity_"]').each(function(){var f=$(this).attr("id"),e=f.split("_"),i=e[1],o=$('input[type="radio"][id^="xrdselTrans'+i+'"][value="C"]').prop("checked"),r,u;if(o){t=!1;return}$('div[id^="dvRadios'+i+'"]').length>0&&(r=$('div[id^="dvRadios'+i+'"]:checked').length,r==0&&t==!0&&($('div[id^="dvCarSet'+i+'"]').hide(),$("#dvRadios"+i+' input:radio[id^="xrdselTrans"]').length>0&&($("#dvRadios"+i+' input:radio[id^="xrdselTrans"]').each(function(){this.checked&&this.value=="T"&&$("#troverNts"+i+"Train").show()}),$("#troverNts"+i+"Train").show(),$('div[id^="dvRadios'+i+'"]').show(),u=$('input[type="radio"][id^="xrdselTrans'+i+'"]:checked').attr("data"),$("#xrdselTransField"+i).val(u))));n==i&&(t=!0)})}function carDropOffX(n,t){var u,i,r,n;(console.log("DropOffCity "+n+"/"+t),$.isNumeric(n)!=!1||n=="E")&&(u=!1,$('div[id^="dvcity_"]').each(function(){var r=$(this).attr("id"),f=r.split("_"),n=f[1],i;u&&($('div[id^="dvCarSet'+n+'"]').hide(),$('div[id^="dvRadios'+n+'"]').show(),$('div[id^="troverNts'+n+'"]').hide(),i=$('input[type="radio"][id^="xrdselTrans'+n+'"]:checked').attr("data"),$("#xrdselTransField"+n).val(i));t==n&&(u=!0)}),i=!1,$('div[id^="dvcity_"]').each(function(){var u=$(this).attr("id"),f=u.split("_"),r=f[1];r==n?i=!1:i&&($('div[id^="dvRadios'+r+'"]').hide(),$("#xrdselTransField"+r).val(""),$('div[id^="dvCarSet'+r+'"]').hide());r==t&&(i=!0)}),r=!1,$('div[id^="dvcity_"]').each(function(){var u=$(this).attr("id"),f=u.split("_"),t=f[1],i=$('input[type="radio"][id^="xrdselTrans'+t+'"]:checked').attr("data");r&&(n!=t?($('div[id^="dvRadios'+t+'"]').hide(),$("#xrdselTransField"+t).val(""),$('div[id^="dvCarSet'+t+'"]').hide(),i=""):(r=!1,n="",i=="TBA"&&t>=n&&$('div[id^="dvCarSet'+t+'"]').show()));i=="TBA"&&(r=!0,n=$("#xdropoffCity"+t).val())}))}function xSelChildren(n,t,i){rom>1&&(hwMCh=Number($("#xiChildren").val())+Number($("#xRoom2_iChildren").val())+Number($("#xRoom3_iChildren").val()));i==0?$("#spChAg").hide():i==1&&(n==0?hwMCh==0&&$("#spChAg").hide():$("#spChAg").show());switch(Number(t)){case 1:for(s=1;s<=4;s++)s<=n?$("#dvR1child"+s+"").show():($("#dvR1child"+s+"").hide(),$("#dvR1child"+s+"").val("")),$("#xiChild"+s+"").val("");break;case 2:case 3:for(s=1;s<=4;s++)s<=n?$("#dvR"+t+"child"+s+"").show():$("#dvR"+t+"child"+s+"").hide(),$("#xRoom"+t+"_iChild"+s+"").val("")}}function showDivRoom(n){for(n==0&&$("#dvPaxLabel").hide(),i=1;i<=3;i++)i<=n?($("#dvPaxLabel").show(),$("#dvRoom"+i+"").show(),i==1?$("#xiChildrenText").val()=="0"&&cleanValues(i):$("#xRoom"+i+"_iChildrenText").val()=="0"&&cleanValues(i)):($("#dvRoom"+i+"").hide(),xSelChildren(0,i,0),i==1?($("#xiChildren").val("0"),$("#xiChildrenText").val("0")):($("#xRoom"+i+"_iChildren").val("0"),$("#xRoom"+i+"_iChildrenText").val("0")))}function cleanValues(n){switch(n){case 1:xSelChildren(0,2,0);$("#xRoom2_iChildren").val("0");$("#xRoom2_iChildrenText").val("0");xSelChildren(0,3,0);$("#xRoom3_iChildren").val("0");$("#xRoom3_iChildrenText").val("0");break;case 2:xSelChildren(0,1,0);$("#xiChildren").val("0");$("#xiChildrenText").val("0");xSelChildren(0,3,0);$("#xRoom3_iChildren").val("0");$("#xRoom3_iChildrenText").val("0");break;case 3:xSelChildren(0,1,0);$("#xiChildren").val("0");$("#xiChildrenText").val("0");xSelChildren(0,2,0);$("#xRoom2_iChildren").val("0");$("#xRoom2_iChildrenText").val("0")}}function xchangePaxByRoom(n){if($(".paxRoomChAg").click(function(){$(this).select()}),n==-1)return popCalError("xiRoomsAndPax","Please select select a valid option!  <br> <a href=\"javascript:closeClick('xiRoomsAndPax')\">OK<\/a>"),!1;pax="";pax2="";pax3="";ropx=n.split("|");rom=ropx[0];pax=ropx[1];pax.indexOf("-")>0&&(paxMr=pax.split("-"),pax=paxMr[0],pax2=paxMr[1],paxMr[2]!=undefined&&(pax3=paxMr[2]));switch(rom){case"1":pax!="Other"?showDivRoom(0):showDivRoom(1);break;case"2":pax!="Other"?showDivRoom(0):showDivRoom(2);break;case"3":pax!="Other"?showDivRoom(0):showDivRoom(3)}}function submitToBook(){var y,p,l,r,u,f,t,n,e,a,v,o;if(totCity=$("#inpCities").val(),$("#dvError").css("display")=="block")return!1;if(y=$('input[id="xrdAWair"][value="True"]').prop("checked"),y==!0){if($("#xIDLeavingFrom").val()==-1)return n="'xtxtLeavingFrom'",r='Please select your departure city!  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("xtxtLeavingFrom",r),!1;if($("#xIDReturningTo").val()==-1)return n="'xtxtReturningTo'",r='Please select your departure city!  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("xtxtReturningTo",r),!1;if(p=$.trim($("#xCabinTxt").val()),p=="")return n="'xCabinTxt'",r='Please select a cabin type!  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("xCabinTxt",r),!1}if(l=$.trim($("#xtxtBYArriving").val()),l=="mm/dd/yyyy"||l=="")return n="'xtxtBYArriving'",r='Please select your departure date!  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("xtxtBYArriving",r),!1;for(i=1;i<=totCity;i++)if($("#xsCityID"+i+"").val()==-1)return n="'xsCityNA"+i+"'",r='Please select a valid city!  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("xsCityNA"+i,r),!1;var h=0,s=0,c=0;$("#xselRooms").val(rom);switch(rom){case"1":h=$("#xiAdults").val();s=$("#xiChildren").val();c=Number(h)+Number(s);break;case"2":h=Number($("#xiAdults").val())+Number($("#xRoom2_iAdults").val());s=Number($("#xiChildren").val())+Number($("#xRoom2_iChildren").val());c=Number(h)+Number(s);break;case"3":h=Number($("#xiAdults").val())+Number($("#xRoom2_iAdults").val())+Number($("#xRoom3_iAdults").val());s=Number($("#xiChildren").val())+Number($("#xRoom2_iChildren").val())+Number($("#xRoom3_iChildren").val());c=Number(h)+Number(s)}if(c>6)return n="'dvRoom1'",messg='Max guest allowed (adults + children) are 6 !  <br> <a href="javascript:closeClick('+n+')">OK<\/a>',popCalError("dvRoom1",messg),!1;if(s>0){var w=$("#xiChildren").val(),b=$("#xRoom2_iChildren").val(),k=$("#xRoom3_iChildren").val();if(w>0&&rom>=1)for(i=1;i<=w;i++)if(n="'xiChild"+i+"'",u=$("#xiChild"+i+"").val(),isNaN(u)||u==""||!isNaN(u)&&(u<2||u>11))return isNaN(u)||u==""?(messg='Please enter a valid age !<br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=""):u<2?(messg='All infants (2 and under) are considered as children age 2. <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=2):(messg='Child age is 11 or less! <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=11),popCalError("xiChild"+i,messg),$("#xiChild"+i+"").attr("class","paxRoomChAg").val(t).select(),!1;if(b>0&&rom>=2)for(i=1;i<=b;i++)if(n="'xRoom2_iChild"+i+"'",f=$("#xRoom2_iChild"+i+"").val(),isNaN(f)||f==""||!isNaN(f)&&(f<2||f>11))return isNaN(f)||f==""?(messg='Please enter a valid age !<br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=""):f<2?(messg='All infants (2 and under) are considered as children age 2. <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=2):(messg='Child age is 11 or less! <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=11),popCalError("xRoom2_iChild"+i,messg),$("#xRoom2_iChild"+i+"").attr("class","paxRoomChAg").val(t).select(),!1;if(k>0&&rom>=3)for(i=1;i<=k;i++)if(n="'xRoom3_iChild"+i+"'",e=$("#xRoom3_iChild"+i+"").val(),isNaN(e)||e==""||!isNaN(e)&&(e<2||e>11))return isNaN(e)||e==""?(messg='Please enter a valid age !<br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=""):e<2?(messg='All infants (2 and under) are considered as children age 2. <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=2):(messg='Child age is 11 or less! <br> <a href="javascript:closeClick('+n+')">OK<\/a>',t=11),popCalError("xRoom3_iChild"+i,messg),$("#xRoom3_iChild"+i+"").attr("class","paxRoomChAg").val(t).select(),!1}switch(rom){case"1":$("#xRoom2_iAdults").val([]);$("#xRoom2_iChildren").val([]);$("#xRoom3_iAdults").val([]);$("#xRoom3_iChildren").val([]);break;case"2":$("#xRoom3_iAdults").val([]);$("#xRoom3_iChildren").val([])}$("#xtotCities").val(totCity);a=$("#getNewItin").serialize();v="";v=JSON.stringify($("#getNewItin").serializeObject());Cookies.set("TMEDpkbyoBack",v,{expires:1});console.log("queryString");console.log(a);o={};o.url=SiteName+"/Calendar/T4BuildComponentList";o.type="POST";o.contentType="application/json";o.data=JSON.stringify(a);o.dataType="html";o.success=function(n){processResponseB(n)};o.error=function(n){$("#content").html(n.responseText);alert(n.responseText+" = error")};$.ajax(o)}function processResponseB(n){window.ActiveXObject?$("#content").append(n):document.implementation&&document.implementation.createDocument?$("#content").append(n):alert("Your browser cannot handle this script");var t=$("#formSub").val(),i=$("#pakID").val();$("#utm_campaign").val()==""?$("#utm_campaign").val(""+utmValue+""):"";t==1&&(Cookies.set("dateVAL","",{expires:-1}),document.getElementById("frmToBook").action="https://reservation.tripmasters.com/Tourpackage4/Itinerary/Create?"+i,document.getElementById("frmToBook").submit())}function Check_WAir(n){switch(n){case"False":$("#dvAllAirOpt").hide();break;case"True":$("#dvAllAirOpt").show()}}function getTraveldate(){if(fixdates==0){var t=new Date,i=new Date(t.getTime()+6048e5),n=2;IsMobileDevice()&&(n=1);$("#xtxtBYArriving").datepicker({changeMonth:!1,changeYear:!1,numberOfMonths:n,showButtonPanel:!0,format:"yyyy-mm-dd",hideIfNoPrevNext:!0,prevText:"",nextText:"",minDate:i,showOtherMonths:!1,maxDate:"+1Y"});cookDate=Cookies.get("dateVAL");cookDate!=null&&$("#xtxtBYArriving").val(cookDate).removeClass("impTextFirst");$("#xtxtBYArriving").change(function(){$(this).removeClass("impTextFirst");Cookies.set("dateVAL",this.value,{expires:1})})}else $("#xtxtBYArriving").click(function(){bbdates("xtxtBYArriving")})}function getBusinessDateObj(n){var t=new Date;t.setTime(t.getTime()-0);var r=t.getDay(),i=n,u=r+n;return u>=6&&(n-=6-r,i+=2,bookWeeks=Math.floor(n/5),i+=bookWeeks*2),t.setTime(t.getTime()+i*864e5),t}function bbdates(n){builFixDatediv(fixdates,n)}function openDates(n){objPOS=$("#"+n+"").offset();$("#dvFixDates").show();$("#dvFixDates").offset({left:objPOS.left,top:objPOS.top+22})}function builFixDatediv(n,t){var f,e,o="",r="",u=n,s;for(i=0;i<u.length;i++)dateFormat(u[i],"mm/dd/yyyy")>dateFormat(new Date,"mm/dd/yyyy")&&(o!=dateFormat(u[i],"mmm")&&(o=dateFormat(u[i],"mmm"),s=0,r=i==0?'<div style="padding:3px 1px;">':r+'<\/div><div style="padding:3px 1px;">',r=r+" "+o+" "+dateFormat(u[i],"yyyy")+": "),s==0?(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+'<span id="fxDates" onclick="postnwDate('+f+","+e+')">'+dateFormat(u[i],"dd")+"<\/span>"):(f="'"+dateFormat(u[i],"mm/dd/yyyy")+"'",e="'"+t+"'",r=r+', <span id="fxDates" onclick="postnwDate('+f+","+e+')">'+dateFormat(u[i],"dd")+"<\/span>"),s++);r=r+"<\/div>";$("#dvFixDates").html(r);openDates(t);setTimeout(function(){$("#dvFixDates").hide()},7e3)}function postnwDate(n,t){$("#"+t+"").val(n);$("#dvFixDates").hide()}function DisableSpecificDates(n){var i;if(fixdates!=0){var e=n.getMonth()+1,t=n.getDate(),o=n.getFullYear(),s=e+"/"+t+"/"+o;for(i=0;i<fixdates.length;i++)return $.inArray(s,fixdates)!=-1?[!0]:[!1]}else{if(blockdates!=0){for(t=0;t<blockdates.length;t++){var f=blockdates[t].split(","),r=f[0].split("-"),u=f[1].split("-"),h=new Date(r[2],r[0]-1,r[1]-Number(packNoNts)),c=new Date(u[2],u[0]-1,u[1]);if(n>=h&&n<=c)return[!1]}return[!0]}return[!0]}}function popCalError(n,t){var r=$("#"+n+"").position(),u,i;$("#dvErrMess").html('<img src="https://pictures.tripmasters.com/siteassets/d/Symbols-Warning-icon-32.gif" width="32" height="32" align="absmiddle" style="padding-top:5px;" /> '+t+"");u=r.left-5;i=r.top-82;$("#dvError").attr("style","position:absolute; display:none; z-index:9999; left:"+u+"px; top:"+i+"px; width:auto;");$("#dvError").fadeIn(100);scrollToTop(i-20)}function closeClick(n){$("#dvError").hide();IsMobileDevice()&&$("#"+n+"").val("");$("#"+n+"").select();$("#"+n+"").trigger("click")}function scrollToTop(n){$("body,html").animate({scrollTop:n},800)}function resetPage(){Cookies.set("dateVAL","",{expires:-1});Cookies.set("TMEDpkbyoBack","",{expires:-1});var n=document.URL.toLowerCase();window.location=n.replace("_pkbyo","_pk")}function imageSize(n,t){return n.match(img500)!=null||t=="M0"?(picW="290px",picMtp="0px",$(".selM").css("width","399px")):(picW="200px",picMtp="45px",$(".selM").css("width","399px")),[picW,picMtp]}function CarrouPicsBuild(n){for(CoPic=0,CoMap=0,i=0;i<n;i++)picClass=i==3?"picSel":"picNSel",objPics[i].picTYP=="P0"?(CoPic++,TthumPic=TthumPic+'<span><img id="Oipic'+CoPic+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/><\/span>'):objPics[i].picTYP=="M0"&&(CoMap++,TthumPic=TthumPic+'<span><img src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" id="OipicMap'+CoMap+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/>map<\/span>',hvBigMap=1),ini=0,fin=i;if(picTotal<6)var t=18*(6-picTotal);else t=0;$("#dvallTHU #prev").css({"padding-left":""+t+"px","background-position":""+t+"px 0"});$("#thumbs").html(TthumPic+'<br style="clear:both" / >');$("img.picSel").click(function(){changePic(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){changePic(this.id,this.src,this.title,this.alt)})}function moveCarr(n){var t=n.substr(n.length-1),i,l,u=[],h=[],f="",e="",c,a,v,y="",o;for(n.indexOf("next")>-1?(l="Nx",a="left",v="right"):n.indexOf("prev")>-1&&(l="Pv",a="right",v="left"),n.indexOf("S")>-1?(i="S",c=$("#SSfoo"+t+""),u=SSDispl,SSDispl=[],h=allCtySSPRO):n.indexOf("H")>-1&&(i="H",c=$("#Hotfoo"+t+""),u=HotDispl,HotDispl=[],h=allCtyHotPRO),s=0;s<u.length;s++)if(o=u[s].split("|"),o[0]==t){if(l=="Nx"?(f=Number(o[1])+3,e=Number(o[2])+3):l=="Pv"&&(f=Number(o[1])-3,e=Number(o[2])-3),e<=-1||f>h[t].length)return i=="S"?SSDispl=u:i=="H"&&(HotDispl=u),!1;for(i=="S"?SSDispl.push(t+"|"+f+"|"+e):i=="H"&&HotDispl.push(t+"|"+f+"|"+e),r=f;r<=e;r++)h[t][r]!=undefined&&(y=y+h[t][r])}else i=="S"?SSDispl.push(u[s]):i=="H"&&HotDispl.push(u[s]);c.hide("slide",{direction:a},200);c.html(y);c.show("slide",{direction:v},500)}function buildFromCookie1(){var n=JSON.parse(backCook),u=n.xrdAWair,f,e,h,c,p,o,t,s;for(console.log(u),$('input:radio[id="xrdAWair"][value="'+u+'"]').prop("checked",!0),Check_WAir(u,"xrdAWair"),u=="True"&&($("#xtxtLeavingFrom").val(n.xtxtLeavingFrom),$("#xIDLeavingFrom").val(n.xIDLeavingFrom),$("#xtxtReturningTo").val(n.xtxtReturningTo),$("#xIDReturningTo").val(n.xIDReturningTo),$("#xCabinTxt").val(n.xCabinTxt),$("#xCabin").val(n.xCabin),$("#xIDLeavingFrom").val()!=$("#xIDReturningTo").val()&&($("#divAirAdvance").hide(),$("#divReturnAir").removeClass("dvHide"))),f=n.xtotCities,$("#xtotCities").val(f),e="",i=1;i<=f;i++){var l=n["xsCityNA"+i+""],a=n["xsCityID"+i+""],v=n["xrdselTransField"+i+""],y=n["xrdselTrans"+i+""];e=i==1?i+"|"+l+"|"+a+"|"+v+"|"+y:e+"$$$"+i+"|"+l+"|"+a+"|"+v+"|"+y;i==f&&itineraryModifed("0","0",e)}if($("#xiRoomsAndPaxText").val(n.xiRoomsAndPaxText),h=n.xiRoomsAndPax,xchangePaxByRoom(h),h.indexOf("Other")>-1)for(c=n.xselRooms,$("#xselRooms").val(c),p=1,r=p;r<=c;r++)if(r==1){if(o=n.xiAdults,t=n.xiChildren,$("#xiAdults , #xiAdultsText").val(o),$("#xiChildren , #xiChildrenText").val(t),t>0)for(xSelChildren(t,r,1),s=1,ch=s;ch<=t;ch++)$("#xiChild"+ch+"").val(n["xiChild"+ch+""])}else if(o=n["xRoom"+r+"_iAdults"],t=n["xRoom"+r+"_iChildren"],$("#xRoom"+r+"_iAdults , #xRoom"+r+"_iAdultsText").val(o),$("#xRoom"+r+"_iChildren , #xRoom"+r+"_iChildrenText").val(t),t>0)for(xSelChildren(t,r,1),s=1,ch=s;ch<=t;ch++)$("#xRoom"+r+"_iChild"+ch+"").val(n["xRoom"+r+"_iChild"+ch+""])}function buildFromCookie2(){var t=JSON.parse(backCook),i,r;for($("#xtxtBYArriving").val(t.xtxtBYArriving),i=t.xtotCities,r=1,n=r;n<=i;n++)$("#xOfNtsTxt"+n+"").val(t["xOfNtsTxt"+n+""]),$("#xselNoOfNts"+n+"").val(t["xselNoOfNts"+n+""]),n==i?Cookies.set("TMEDpkbyoBack","",{expires:-1}):"",n==i&&(backCook=null)}function changePic(n,t,i,r){var u="https://pictures.tripmasters.com"+r.toLowerCase(),f,e;r=="none"&&(u=t);n.indexOf("O")==-1?($("#dvbk").hide(),$("#dvfr").hide(),$("#dvmediaPopUp").show(),$('img.picSel[id*="Kipic"]').attr("class","picNSel"),$('img.picSel[id*="Mipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),$("#dvFstPic").html('<img src="'+u+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'" />'),n.indexOf("M")>-1?($("#dvMV").hide(),f=/[0-9]+/,e=n.match(f),$("#Mipic"+e+"").attr("class","picSel")):($("#dvMV").show(),$("#dvPicNa").html(i))):($('img[id*="Oipic"]').attr("class","picNSel"),$("#"+n+"").attr("class","picSel"),n.indexOf("Map")>-1||u.match(img500)!=null?($("#dvshowPIC").html('<img src="'+u+'" id="'+n.replace("O","B")+'" alt="'+r+'" title="'+i+'" width="290" height="290" onclick="moreMediaB(this.id, this.src, this.title, this.alt); " class="clsCursor"/>'),$(".selM").css("width","399px")):($("#dvshowPIC").html('<img src="'+u+'" id="'+n.replace("O","B")+'"  alt="'+r+'" title="'+i+'" style="margin-top:45px;height:250px;width:250px;" onclick="moreMediaB(this.id, this.src, this.title, this.alt);" class="clsCursor"/>'),$(".selM").css("width","399px")))}function swichImg(n){var e,f,t,u,i,r;e=newPicTot;f=$('img.picSel[id*="K"]');t=f.attr("id");t=t.replace("ipic","");t.indexOf("O")>-1&&(t=t.replace("O",""));t.indexOf("K")>-1&&(t=t.replace("K",""));n=="F"&&(t==e?alert("No more photos"):(u=Number(t)+1,r=objImgs[t].picBIG,r==""&&(r=objImgs[u].picURL),i=$("#Kipic"+u+""),$("#dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")));n=="B"&&(t==1?alert("No more photos"):(u=Number(t)-1,r=objImgs[u-1].picBIG,r==""&&(r=objImgs[u-1].picURL),i=$("#Kipic"+u+""),$("#dvFstPic").html('<img src="https://pictures.tripmasters.com'+r.toLowerCase()+'" alt="'+i.attr("alt")+'" title="'+i.attr("title")+'"/>'),$("#dvPicNa").html(i.attr("title")),i.attr("class","picSel"),f.attr("class","picNSel")))}function sliceThumb(n,t,r){var e,u,f;if(TthumPic="",r=="prev"){if(t==picTotal-1?(e=Number(t-n),n=n-6,t=Number(t-e)-1):(n=n-6,t=t-6),n<0)return alert("No more images"),!1;for(u=n,f=n,i=n;i<=t;i++)picClass="picNSel",objPics[i].picTYP=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/><\/span>'):objPics[i].picTYP=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"right"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"left"},500);$("img.picSel").click(function(){changePic(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){changePic(this.id,this.src,this.title,this.alt)})}if(r=="next")if(t>picTotal&&(t=picTotal-1),n>=picTotal-1)alert("No more images");else{for(u=n-1,f=n-1,i=n;i<=t;i++)picClass="picNSel",objPics[i].picTYP=="P0"?(u++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11" ><img id="Oipic'+u+'" class="'+picClass+'" src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/><\/span>'):objPics[i].picTYP=="M0"&&(f++,TthumPic=TthumPic+'<span style="float:left;" class="Text_11"><img src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" id="OipicMap'+f+'" class="'+picClass+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/><br/>map<\/span>'),ini=n,fin=i;$("#thumbs").hide("slide",{direction:"left"},200);$("#thumbs").html(TthumPic);$("#thumbs").show("slide",{direction:"right"},500);$("img.picSel").click(function(){changePic(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){changePic(this.id,this.src,this.title,this.alt)})}}function scrollToTop(){$("body,html").animate({scrollTop:0},800)}function moreMedia(){var n,t;objPics.length>0&&(n=objPics[0].picBIG);n==undefined&&(n=objPics[0].picURL);t=objPics[0].picNA;$("#dvFstPic").html('<img src="https://pictures.tripmasters.com'+n.toLowerCase()+'" title="'+t+'" alt="'+n+'"/>');$("#dvPicNa").html(t);popUpImagesNav();openMask();$("#dvmediaPopUp").show();scrollToTop()}function moreMediaB(n,t,i,r){popUpImagesNav();openMask();$("#dvmediaPopUp").show();scrollToTop();changePic(n.replace("B","K"),t,i,r)}function popUpImagesNav(){var t;thumPic="";thumMap="";hvMap=0;var n=0,r=0,t="picNSel";for(i=0;i<Number(picTotal);i++)t=i==0?"picSel":"picNSel",objPics[i].picTYP=="P0"?(n++,thumPic=thumPic+'<img id="Kipic'+n+'" class="'+t+'" src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/>'):(objPics[i].picTYP=="M0"||objPics[i].picTYP=="M1")&&(r++,thumMap=thumMap+'<img src="https://pictures.tripmasters.com'+objPics[i].picURL.toLowerCase()+'" id="Mipic'+r+'" class="'+t+'" width="30" height="30" alt="'+objPics[i].picBIG+'" title="'+objPics[i].picNA+'"/>',hvMap=1,hvBigMap=1);newPicTot=n;$("#dvThuPic").html("Photos<br/>"+thumPic);hvMap==1?($("#dvThMp").show(),$("#dvThuMap").html("Map<br/>"+thumMap)):($("#dvThMp").hide(),$("#dvTabMap").hide());$("img.picSel").click(function(){changePic(this.id,this.src,this.title,this.alt)});$("img.picNSel").click(function(){changePic(this.id,this.src,this.title,this.alt)})}function moreMediaCLS(){$(".mask").hide();$("#dvmediaPopUp").hide()}function cityActCLS(){$(".mask").hide();$("#dvcityActions").hide()}function showRecomm(n){var u,t=ObjectPosition(document.getElementById(n)),f,i,r,e;f=t[0];i=t[1]-10;r=710;n.indexOf("picAccom")>-1&&(f=t[0]-400);n.indexOf("aMore")>-1&&(i=t[1]-30);n.indexOf("dvItinRel")>-1&&(i=t[1]-150);n.indexOf("samPriceaAll")>-1&&(i=t[1]-60);n.indexOf("dvTabView")>-1&&(i=t[1]-60,r=780);e=r/2;u="position:absolute; z-index:9999; width:"+r+"px; left:50%; margin-left:-"+e+"px; top:"+i+"px;";$("#divRecomended").attr("style",u);$("#divRecomended").fadeIn(2e3)}function closeDiv(){$("#divRecomended").hide()}function tabBgChange(n){$("#"+n+"").trigger("click")}function clkshowItin(n){var t=$("#dvFDinclu"+n+"");t.is(":visible")?(t.hide(),$("#dvItinDetail"+n).html("Itinerary details &#709;")):(t.show(),$("#dvItinDetail"+n).html("Itinerary details &#708;"))}function scrollToMorePop(n){var t;t=n;t=$("#"+t+"").offset();$("html,body").animate({scrollTop:t.top-Number(170)},2e3)}function dvHotMoreInf(n){closeOther();var t=$("#"+n+"").offset(),r=t.top+15,i=t.left-90,u=$(window).width();990-t.left<270&&(i=t.left-200);$("#"+n+"Info").attr("style","position:absolute; z-index:100; width:350px;left:"+i+"px; top:"+r+"px; border:1px solid #000066; padding:15px; background-color:#fff; overflow:visible; -moz-box-shadow: 0 0 30px 5px #999; -webkit-box-shadow: 0 0 30px 5px #999;");$("#"+n+"Info").show()}function dvHotMoreInfCL(n){$("#dvMore"+n+"Info").hide()}function closeOther(){$(".dvMorInf").each(function(){$(this).is(":visible")==!0&&$("#"+this.id+"").hide()});$("#divRecomended").each(function(){$(this).is(":visible")==!0&&$(this).hide()})}function clkhideIrin(n){$("#dvFDinclu"+n+"").hide()}function formatCurrency(n){var i,t;for(n=n.toString().replace(/\$|\,/g,""),isNaN(n)&&(n="0"),sign=n==(n=Math.abs(n)),n=Math.floor(n*100+.50000000001),cents=n%100,n=Math.floor(n/100).toString(),cents<10&&(cents="0"+cents),i=Math.floor(n.length),i=Number(i)-1,t=0;t<Math.floor(Number(i+t)/3);t++)n=n.substring(0,Number(n.length)-(4*t+3))+","+n.substring(Number(n.length)-(4*t+3));return(sign?"":"-")+"$"+n}function checkImg(n,t,i){var r=new Image;r.onload=function(){$("#"+n+"").html('<img src="'+t+'"/>')};r.onerror=function(){$("#"+n+"").html('<img src="'+i+'"/>')};r.src=t}function calreload(n){startDate="";histFilter=[];priceFilter=[];deflt=$(".spdepair").text();n===undefined?($(".spdepair").html(deflt),priceFilter=$.grep(priceGuide,function(n){return n.PLC_Title===deflt})):priceFilter=$.grep(priceGuide,function(t){return t.PLC_Title===n});var t=0;jQuery.each(priceFilter,function(){var i,n,r;t===0?(i=new Date,i=i.setDate(i.getDate()+45),startDate=i):"";n="$"+Math.round(this.RLD_PackagePrice)+"*";n=n+"    - ";n=this.RLD_Nights.toString().length===1?n+"    "+this.RLD_Nights+" nights":n+"  "+this.RLD_Nights+" nights";r={title:n,start:""+this.RLD_StartDate+"",className:"gui"+this.RLDID+""};histFilter.push(r);t++});$("#PriceGuideCalendar").guideCalendar("destroy");$("#PriceGuideCalendar").html('<div style="text-align:center; padding:50px;"><img src="https://pictures.tripmasters.com/siteassets/d/ajax-loader.gif"/><br/>loading ...<br/><\/div>');setTimeout(guideCal,1e3)}function guideCal(){$("#PriceGuideCalendar").html("");$("#PriceGuideCalendar").guideCalendar({header:{left:"prev",center:"title",right:"next"},defaultDate:startDate,weekMode:"liquid",editable:!0,eventLimit:!0,events:histFilter});clickAnchor()}function clickAnchor(){$(".apriceXXX").click(function(){var n=this.id;$(".dvPopUpOrangeTopR").is(":visible")==!0?$(".dvPopUpOrangeTopR").hide():"";$(".dvPopUpOrangeTopL").is(":visible")==!0?$(".dvPopUpOrangeTopL").hide():"";var r=$(document).height(),t=$("#inpFromNA").val(),i=$("#inpFromID").val();$("#BsDepCity").val(t);$("#sDepCity").val(t);$("#iDepCity").val(i);$("#BiDepCity").val(i);$("#InDate1").val(n);$("#BInDate1").val(n);$("#dvCalMask").css({width:"100%",height:r,background:"#666",position:"absolute",top:"0","z-index":"6000"});$("#dvCalMask").fadeTo("slow",.8);$("#dvThinCal").appendTo("#dvPopCalContent");$("#dvPopCal").attr("style","z-index:6100; display:block;");$("#dvPopCal").center();$(window).resize(function(){$("#dvPopCal").center()});$('[id^="gToday"]').css("position","fixed")});$("[class*='gui']").click(function(){var i=$(this).attr("class").match(isNumber),r=[],t=$(this).offset(),u=$(this).position(),n="";r=$.grep(priceGuide,function(n){return n.RLDID==Number(i)});$.each(r,function(){var f=new Date(this.RLD_TXMLTime),r=new Date(this.RLD_StartDate),e="'"+this.PLC_Title+"',"+this.PLCID+",'"+dateFormat(r.setDate(r.getDate()+1),"mm/dd/yyyy")+"'";n="<p><span><b>"+this.RLD_Nights+" Nights <\/b><\/span><b>from $"+Math.round(this.RLD_PackagePrice)+" w/air,  hotel &amp; air taxes*<\/b><\/p><p> <b>This sample price includes ALL air taxes &amp; fuel surcharges:<\/b> Priced on "+dateFormat(f.setDate(f.getDate()+1),"dddd, mmm dd, yyyy")+" for arrival on "+dateFormat(r.setDate(r.getDate()),"dddd, mmm dd, yyyy")+", departure from "+this.PLC_Title+".<\/p><p>This sample itinerary includes:<\/p>";u.left>600?($(".dvPopUpOrangeTopL").is(":visible")==!0?$(".dvPopUpOrangeTopL").hide():"",$("#dvPopUpGR").show(),$("#dvPopContentR").html(n),$("#dvPopUpGR").offset({left:t.left-245,top:t.top+34})):($(".dvPopUpOrangeTopR").is(":visible")==!0?$(".dvPopUpOrangeTopR").hide():"",$("#dvPopUpGL").show(),$("#dvPopContentL").html(n),$("#dvPopUpGL").offset({left:t.left+5,top:t.top+34}));$.ajax({type:"POST",url:"/europe/WS_Library.asmx/sqlItineraryContentFromPriceId",contentType:"application/json; charset=utf-8",dataType:"json",data:'{PriceId:"'+i+'"}',success:function(t){if(msg=eval("("+t.d+")"),msg!=""){var i=$.map(msg,function(n){return{id:n.Id,name:n.Name}});n=n+"<ul>"+i[0].name+"<\/ul>";u.left>600?$("#dvPopContentR").html(n):$("#dvPopContentL").html(n)}},error:function(n){$("#dvPopContentR").html(n.responseText)}})})})}function priceThinCal(n,t,i){$(".dvPopUpOrangeTopR").is(":visible")==!0?$(".dvPopUpOrangeTopR").hide():"";$(".dvPopUpOrangeTopL").is(":visible")==!0?$(".dvPopUpOrangeTopL").hide():"";var r=$(document).height();$("#dvCalMask").css({width:"100%",height:r,background:"#666",position:"absolute",top:"0","z-index":"6000"});$("#dvCalMask").fadeTo("slow",.8);$("#BsDepCity").val(n);$("#sDepCity").val(n);$("#iDepCity").val(t);$("#BiDepCity").val(t);$("#InDate1").val(i);$("#BInDate1").val(i);$("#dvThinCal").appendTo("#dvPopCalContent");$("#dvPopCal").attr("style","z-index:6100; display:block;");$("#dvPopCal").center();$(window).resize(function(){$("#dvPopCal").center()});$('[id^="gToday"]').css("position","fixed")}function hidePopUpInfo(n){return $("#"+n+"").hide(),n=="dvPopCal"?($("#dvCalMask").hide(),$("#dvThinCal").appendTo("#overviewCal"),$("#BsDepCity").val("type here"),$("#sDepCity").val("type here"),$("#iDepCity").val(-1),$("#BiDepCity").val(-1),$("#InDate1").val("mm/dd/yyyy"),$("#BInDate1").val("mm/dd/yyyy"),$('[id^="gToday"]').css("position","absolute"),document.getElementById("gToday:normal:agenda.js").contentWindow.fHideCal()):"",!1}function DropDown(n){this.dep=n;this.placeholder=this.dep.children("span");this.opts=this.dep.find("ul.dropdownList > li");this.val="";this.index=-1;this.initEvents()}function ShowHideMoreInfo(n){if(n.indexOf("pic")>-1){var i="div"+n.replace("pic",""),t="text"+n.replace("pic",""),u=n,e=$("#"+u+"").attr("src"),f=e.indexOf("Plus");f!=-1?(txtMorCls=$("#"+t+"").html(),$("#"+u+"").attr("src","https://pictures.tripmasters.com/siteassets/d/minus.jpg"),$("#"+t+"").html("close"),$("#"+i+"").show()):($("#"+u+"").attr("src","https://pictures.tripmasters.com/siteassets/d/Plus.jpg"),$("#"+t+"").html(txtMorCls),$("#"+i+"").hide())}else{var i="div"+n.replace("text",""),t="text"+n.replace("text",""),f=$("#"+t+"").html().indexOf("close"),r=n.replace("text","pic");f==-1?(txtMorCls=$("#"+t+"").html(),$("#"+r+"").length>0&&$("#"+r+"").attr("src","https://pictures.tripmasters.com/siteassets/d/minus.jpg"),$("#"+t+"").html("close"),$("#"+i+"").show()):($("#"+r+"").length>0&&$("#"+r+"").attr("src","https://pictures.tripmasters.com/siteassets/d/Plus.jpg"),$("#"+t+"").html(txtMorCls),$("#"+i+"").hide())}}var pakNTS,backCook,objPics,objImag,picTotal,CoPic=0,CoMap=0,newPicTot,depAirport=[],arrAirport=[],arrCty=[],citySelID,totCity,cookDate,newdvCnt,airCabin=[{label:"Coach",value:"Coach",id:"Y"},{label:"Premium Economy",value:"Premium Economy",id:"W"},{label:"Business",value:"Business",id:"C"},{label:"First Class",value:"First Class",id:"F"}],carTake=[{label:"Airport",value:"Airport",id:"A"}],carDay=[{label:"First Day",value:"First Day",id:"F"},{label:"Last Day",value:"Last Day",id:"L"}],stayLength=[],stayObj,adultObj,childPax,chilObj,prevSq,ropx,rom,pax,pax2,pax3,paxMr,hwMCh,arrAllSSCty,deflt;for(i=1;i<=14;i++)stayObj=i==1?{label:i+" nt",value:i+" night",id:i}:{label:i+" nts",value:i+" nights",id:i},stayLength.push(stayObj);var isNumber=/[0-9]+/g,paxRooms=[{id:"1|1",label:"1 room for 1 adult",value:"1 room for 1 adult"},{id:"1|2",label:"1 room for 2 adults",value:"1 room for 2 adults"},{id:"1|3",label:"1 room for 3 adults",value:"1 room for 3 adults"},{id:"1|4",label:"1 room for 4 adults",value:"1 room for 4 adults"},{id:"1|5",label:"1 room/suite for 5 adults",value:"1 room/suite for 5 adults"},{id:"1|6",label:"1 room/suite for 6 adults",value:"1 room/suite for 6 adults"},{id:"1|Other",label:"1 room with children or other options",value:"1 room with children or other options"},{id:"-1",label:"----------------------------------------------------",value:""},{id:"2|2-2",label:"2 rooms for (2 adults + 2 adults)",value:"2 rooms for (2 adults + 2 adults)"},{id:"2|3-3",label:"2 rooms for (3 adults + 3 adults)",value:"2 rooms for (3 adults + 3 adults)"},{id:"2|Other",label:"2 rooms with children or other options",value:"2 rooms with children or other options"},{id:"-1",label:"----------------------------------------------------",value:""},{id:"3|2-2-2",label:"3 rooms for (2 adults + 2 adults + 2 adults)",value:"3 rooms for (2 adults + 2 adults + 2 adults)"},{id:"3|Other",label:"3 rooms with children or other options",value:"3 rooms with children or other options"}],adultPax=[],ini,fin;for(a=1;a<=6;a++)adultObj={label:a,value:a},adultPax.push(adultObj);for(childPax=[],c=0;c<=2;c++)chilObj={label:c,value:c},childPax.push(chilObj);var windW,windH,vidD="",pics="",aPic="",thumPic="",OthumPic="",TthumPic="",thumMap="",OthumMap="",video="",activeLink=0,picThu="",shwMaps="",ctySSPRO=[],ctyHotPRO=[],allCtySSPRO=[],allCtyHotPRO=[],sIndex=11,offSet=10,isPreviousEventComplete=!0,isDataAvailable=!0,today=new Date,fixdates=[],blockdates=[];$.event.special.inputchange={setup:function(){var n=this,t;$.data(this,"timer",window.setInterval(function(){t=n.value;$.data(n,"cache")!=t&&($.data(n,"cache",t),$(n).trigger("inputchange"))},20))},teardown:function(){window.clearInterval($.data(this,"timer"))},add:function(){$.data(this,"cache",this.value)}};$(document).ready(function(){var n=getCookie("utmcampaign"),t;n!=null&&(t=n.split("="),$("#xutm_campaign").length!=0&&$("#xutm_campaign").val(jQuery.trim(t[1])));packID=$("#pakID").val();packNA=$("#pakNA").val();totCity=$("#inpCities").val();pakNTS=$("#pakNTS").val();fixdates=$("#fixDates").val().split(",");blockdates=$("#blockDates").val().split("|");$.ajax({type:"Get",url:SiteName+"/Api/Packages/DepCity",contentType:"application/json; charset=utf-8",dataType:"json",data:'{name:"%"}',success:function(n){var t=n;depAirport=$.map(t,function(n){return{label:n.plC_Title+" - "+n.plC_Code,value:n.plC_Title,id:n.plcid}});doitDeparture("xtxtLeavingFrom");doitDeparture("xtxtReturningTo")},error:function(){}});$("#aAirDiff").click(function(){$("#divAirAdvance").hide();$("#divReturnAir").removeClass("dvHide")});$("#xCabinTxt").autocomplete({autoFocus:!0,source:airCabin,minLength:0,position:{collision:"flip"},select:function(n,t){return $("#xCabinTxt").val(t.item.label),$("#xCabin").val(t.item.id),$("#xrdAWair").focus(),!1}}).click(function(){$(this).val("")}).focus(function(){$(this).keydown()});doitPaxRoom("xiRoomsAndPaxText");doitPaxRoom("xiAdultsText");doitPaxRoom("xiChildrenText");$('input:text[id^="xRoom"]').each(function(){(this.id.indexOf("_iAdults")>-1||this.id.indexOf("_iChildren")>-1)&&doitPaxRoom(this.id)});$.ajax({type:"Get",url:SiteName+"/Api/Packages/PriorCity",contentType:"application/json; charset=utf-8",dataType:"json",data:'{name:"%"}',success:function(n){var t=n;arrCty=$.map(t,function(n){return{label:n.ctyNA+" - "+n.couNA,value:n.ctyNA,id:n.ctyID}})},error:function(n){alert(n.responseText)}});$('input:radio[id^="xrdselTrans"]').click(function(){this.checked?$(this).parent().addClass("spBoldTxt"):$(this).parent().removeClass("spBoldTxt")});backCook=Cookies.get("TMEDpkbyoBack");backCook==null||backCook==undefined?itineraryModifed(packID,packNA):buildFromCookie1();$("#imgForw").click(function(){swichImg("F")});$("#imgBack").click(function(){swichImg("B")});$('span[id^="aboutOVR"]').each(function(){$(this).click(function(n){var t,i;n.preventDefault();t=$(this).attr("id").replace("aboutOVR","aboutDIV");i=$(this).attr("id").replace("aboutOVR","jxTrick");$("."+i+"").popupWindow({centerBrowser:1,height:600,width:750,resizable:1,scrollbars:1});openMask();var r=$(this).offset(),u=r.top+10,f=r.left-600;$("#"+t+"").attr("style","padding:5px; position:absolute; width:800px; margin-left:-400px; display:none; z-index:9998; left:50%; top:"+u+"px;");$("#"+t+"").fadeIn(2e3);scrollToMorePop(t)})});$('img[id^="aboutCls"]').click(function(){var n=$(this).attr("id").replace("aboutCls","aboutDIV");$("#"+n+"").hide();$(".mask").hide()});$('img[id^="aboutPL"]').each(function(){$(this).click(function(n){var t,i;n.preventDefault();t=$(this).attr("id").replace("aboutPL","aboutDIV");i=$(this).attr("id").replace("aboutPL","jxTrick");$("."+i+"").popupWindow({centerBrowser:1,height:600,width:750,resizable:1,scrollbars:1});openMask();var r=$(this).offset(),u=r.top+10,f=r.left-600;$("#"+t+"").attr("style","padding:5px; position:absolute; width:800px; margin-left:-400px; display:none; z-index:9998; left:50%; top:"+u+"px;");$("#"+t+"").fadeIn(2e3);scrollToMorePop(t)})});$(".jxCoInf").click(function(){var n=$(this).attr("href"),t=window.screenX+(window.outerWidth/2-550),i=window.screenY+(window.outerHeight/2-325);return window.open("/europe"+n,"new","height=200,width=800,left="+t+",top="+i+",scrollbars=yes").focus(),!1});console.log("sdfsdfsdfsdf ");$('input:text[id*="xdropoffCityTxt"]').change(function(){console.log("dfsdfsdfsd");carSelected($(this).id)})});rom="1";pax="2";var newDate=[],nwwDDD=[],endDates=[];arrAllSSCty=[];$.fn.serializeObject=function(){var n={},t=this.serializeArray();return $.each(t,function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};deflt="New York City (all Airports),  NY";DropDown.prototype={initEvents:function(){var n=this;n.dep.on("click",function(){return $(this).toggleClass("active"),!1});n.opts.on("click",function(){var t=$(this);n.val=t.text();n.index=t.index();$("#inpFromNA").val(n.val);$("#inpFromID").val(t.find("a").attr("lang"));n.placeholder.text(n.val);calreload(n.val)})},getValue:function(){return this.val},getIndex:function(){return this.index}};$(function(){var n=new DropDown($("#dep"));$(document).click(function(){$(".dropdownContainer").removeClass("active")})});